/*!
 * Markdown
 * Released under MIT license
 * Copyright (c) 2009-2010 Dominic Baggott
 * Copyright (c) 2009-2010 Ash Berlin
 * Copyright (c) 2011 Christoph Dorn <christoph@christophdorn.com> (http://www.christophdorn.com)
 * Version: 0.6.0-beta1
 * Date: 2013-10-29T19:04Z
 */
function CommentSorter(){}(function(e){function n(){return"Markdown.mk_block( "+uneval(this.toString())+", "+uneval(this.trailing)+", "+uneval(this.lineNumber)+" )"}function r(){var e=require("util");return"Markdown.mk_block( "+e.inspect(this.toString())+", "+e.inspect(this.trailing)+", "+e.inspect(this.lineNumber)+" )"}function u(e){return e.split("\n").length-1}function f(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function l(e){if(typeof e=="string")return f(e);var t=e.shift(),n={},r=[];e.length&&typeof e[0]=="object"&&!(e[0]instanceof Array)&&(n=e.shift());while(e.length)r.push(l(e.shift()));var i="";typeof n.src!="undefined"&&(i+=' src="'+f(n.src)+'"',delete n.src);for(var s in n)i+=" "+s+'="'+f(n[s])+'"';return t==="img"||t==="br"||t==="hr"?"<"+t+i+"/>":"<"+t+i+">"+r.join("")+"</"+t+">"}function c(e,t,n){var r;n=n||{};var i=e.slice(0);typeof n.preprocessTreeNode=="function"&&(i=n.preprocessTreeNode(i,t));var s=a(i);if(s){i[1]={};for(r in s)i[1][r]=s[r];s=i[1]}if(typeof i=="string")return i;switch(i[0]){case"header":i[0]="h"+i[1].level,delete i[1].level;break;case"bulletlist":i[0]="ul";break;case"numberlist":i[0]="ol";break;case"listitem":i[0]="li";break;case"para":i[0]="p";break;case"markdown":i[0]="html",s&&delete s.references;break;case"code_block":i[0]="pre",r=s?2:1;var o=["code"];o.push.apply(o,i.splice(r,i.length-r)),i[r]=o;break;case"inlinecode":i[0]="code";break;case"img":i[1].src=i[1].href,delete i[1].href;break;case"linebreak":i[0]="br";break;case"link":i[0]="a";break;case"link_ref":i[0]="a";var u=t[s.ref];if(!u)return s.original;delete s.ref,s.href=u.href,u.title&&(s.title=u.title),delete s.original;break;case"img_ref":i[0]="img";var u=t[s.ref];if(!u)return s.original;delete s.ref,s.src=u.href,u.title&&(s.title=u.title),delete s.original}r=1;if(s){for(var f in i[1]){r=2;break}r===1&&i.splice(r,1)}for(;r<i.length;++r)i[r]=c(i[r],t,n);return i}function h(e){var t=a(e)?2:1;while(t<e.length)typeof e[t]=="string"?t+1<e.length&&typeof e[t+1]=="string"?e[t]+=e.splice(t+1,1)[0]:++t:(h(e[t]),++t)}function y(e,t){function i(e){this.len_after=e,this.name="close_"+t}var n=e+"_state",r=e==="strong"?"em_state":"strong_state";return function(s){if(this[n][0]===t)return this[n].shift(),[s.length,new i(s.length-t.length)];var o=this[r].slice(),u=this[n].slice();this[n].unshift(t);var a=this.processInline(s.substr(t.length)),f=a[a.length-1],l=this[n].shift();if(f instanceof i){a.pop();var c=s.length-f.len_after;return[c,[e].concat(a)]}return this[r]=o,this[n]=u,[t.length,t]}}function b(){a(this.tree)||this.tree.splice(1,0,{});var e=a(this.tree);return e.references===undefined&&(e.references={}),e}function w(e,t){t[2]&&t[2][0]==="<"&&t[2][t[2].length-1]===">"&&(t[2]=t[2].substring(1,t[2].length-1));var n=e.references[t[1].toLowerCase()]={href:t[2]};t[4]!==undefined?n.title=t[4]:t[5]!==undefined&&(n.title=t[5])}function S(e){var t=e.split(""),n=[""],r=!1;while(t.length){var i=t.shift();switch(i){case" ":r?n[n.length-1]+=i:n.push("");break;case"'":case'"':r=!r;break;case"\\":i=t.shift();default:n[n.length-1]+=i}}return n}var t={};t.mk_block=function(e,t,i){arguments.length===1&&(t="\n\n");var s=new String(e);return s.trailing=t,s.inspect=r,s.toSource=n,i!==undefined&&(s.lineNumber=i),s};var i=t.isArray=Array.isArray||function(e){return Object.prototype.toString.call(e)==="[object Array]"};Array.prototype.forEach?t.forEach=function(t,n,r){return t.forEach(n,r)}:t.forEach=function(t,n,r){for(var i=0;i<t.length;i++)n.call(r||t,t[i],i,t)},t.isEmpty=function(t){for(var n in t)if(hasOwnProperty.call(t,n))return!1;return!0},t.extract_attr=function(t){return i(t)&&t.length>1&&typeof t[1]=="object"&&!i(t[1])?t[1]:undefined};var s=function(e){switch(typeof e){case"undefined":this.dialect=s.dialects.Gruber;break;case"object":this.dialect=e;break;default:if(!(e in s.dialects))throw new Error("Unknown Markdown dialect '"+String(e)+"'");this.dialect=s.dialects[e]}this.em_state=[],this.strong_state=[],this.debug_indent=""};s.dialects={};var o=s.mk_block=t.mk_block,i=t.isArray;s.parse=function(e,t){var n=new s(t);return n.toTree(e)},s.prototype.split_blocks=function(t){t=t.replace(/(\r\n|\n|\r)/g,"\n");var n=/([\s\S]+?)($|\n#|\n(?:\s*\n|$)+)/g,r=[],i,s=1;(i=/^(\s*\n)/.exec(t))!==null&&(s+=u(i[0]),n.lastIndex=i[0].length);while((i=n.exec(t))!==null)i[2]==="\n#"&&(i[2]="\n",n.lastIndex--),r.push(o(i[1],i[2],s)),s+=u(i[0]);return r},s.prototype.processBlock=function(t,n){var r=this.dialect.block,s=r.__order__;if("__call__"in r)return r.__call__.call(this,t,n);for(var o=0;o<s.length;o++){var u=r[s[o]].call(this,t,n);if(u)return(!i(u)||u.length>0&&!i(u[0]))&&this.debug(s[o],"didn't return a proper array"),u}return[]},s.prototype.processInline=function(t){return this.dialect.inline.__call__.call(this,String(t))},s.prototype.toTree=function(t,n){var r=t instanceof Array?t:this.split_blocks(t),i=this.tree;try{this.tree=n||this.tree||["markdown"];e:while(r.length){var s=this.processBlock(r.shift(),r);if(!s.length)continue e;this.tree.push.apply(this.tree,s)}return this.tree}finally{n&&(this.tree=i)}},s.prototype.debug=function(){var e=Array.prototype.slice.call(arguments);e.unshift(this.debug_indent),typeof print!="undefined"&&print.apply(print,e),typeof console!="undefined"&&typeof console.log!="undefined"&&console.log.apply(null,e)},s.prototype.loop_re_over_block=function(e,t,n){var r,i=t.valueOf();while(i.length&&(r=e.exec(i))!==null)i=i.substr(r[0].length),n.call(this,r);return i},s.buildBlockOrder=function(e){var t=[];for(var n in e){if(n==="__order__"||n==="__call__")continue;t.push(n)}e.__order__=t},s.buildInlinePatterns=function(e){var t=[];for(var n in e){if(n.match(/^__.*__$/))continue;var r=n.replace(/([\\.*+?|()\[\]{}])/g,"\\$1").replace(/\n/,"\\n");t.push(n.length===1?r:"(?:"+r+")")}t=t.join("|"),e.__patterns__=t;var i=e.__call__;e.__call__=function(e,n){return n!==undefined?i.call(this,e,n):i.call(this,e,t)}};var a=t.extract_attr;s.renderJsonML=function(e,t){t=t||{},t.root=t.root||!1;var n=[];if(t.root)n.push(l(e));else{e.shift(),e.length&&typeof e[0]=="object"&&!(e[0]instanceof Array)&&e.shift();while(e.length)n.push(l(e.shift()))}return n.join("\n\n")},s.toHTMLTree=function(t,n,r){typeof t=="string"&&(t=this.parse(t,n));var i=a(t),s={};i&&i.references&&(s=i.references);var o=c(t,s,r);return h(o),o},s.toHTML=function(t,n,r){var i=this.toHTMLTree(t,n,r);return this.renderJsonML(i)};var p={};p.inline_until_char=function(e,t){var n=0,r=[];for(;;){if(e.charAt(n)===t)return n++,[n,r];if(n>=e.length)return null;var i=this.dialect.inline.__oneElement__.call(this,e.substr(n));n+=i[0],r.push.apply(r,i.slice(1))}},p.subclassDialect=function(e){function t(){}function n(){}return t.prototype=e.block,n.prototype=e.inline,{block:new t,inline:new n}};var d=t.forEach,a=t.extract_attr,o=t.mk_block,v=t.isEmpty,m=p.inline_until_char,g={block:{atxHeader:function(t,n){var r=t.match(/^(#{1,6})\s*(.*?)\s*#*\s*(?:\n|$)/);if(!r)return undefined;var i=["header",{level:r[1].length}];return Array.prototype.push.apply(i,this.processInline(r[2])),r[0].length<t.length&&n.unshift(o(t.substr(r[0].length),t.trailing,t.lineNumber+2)),[i]},setextHeader:function(t,n){var r=t.match(/^(.*)\n([-=])\2\2+(?:\n|$)/);if(!r)return undefined;var i=r[2]==="="?1:2,s=["header",{level:i}].concat(this.processInline(r[1]));return r[0].length<t.length&&n.unshift(o(t.substr(r[0].length),t.trailing,t.lineNumber+2)),[s]},code:function(t,n){var r=[],i=/^(?: {0,3}\t| {4})(.*)\n?/;if(!t.match(i))return undefined;e:do{var s=this.loop_re_over_block(i,t.valueOf(),function(e){r.push(e[1])});if(s.length){n.unshift(o(s,t.trailing));break e}if(!n.length)break e;if(!n[0].match(i))break e;r.push(t.trailing.replace(/[^\n]/g,"").substring(2)),t=n.shift()}while(!0);return[["code_block",r.join("\n")]]},horizRule:function(t,n){var r=t.match(/^(?:([\s\S]*?)\n)?[ \t]*([-_*])(?:[ \t]*\2){2,}[ \t]*(?:\n([\s\S]*))?$/);if(!r)return undefined;var i=[["hr"]];if(r[1]){var s=o(r[1],"",t.lineNumber);i.unshift.apply(i,this.toTree(s,[]))}return r[3]&&n.unshift(o(r[3],t.trailing,t.lineNumber+1)),i},lists:function(){function i(t){return new RegExp("(?:^("+r+"{0,"+t+"} {0,3})("+e+")\\s+)|"+"(^"+r+"{0,"+(t-1)+"}[ ]{0,4})")}function s(e){return e.replace(/ {0,3}\t/g,"    ")}function u(e,t,n,r){if(t){e.push(["para"].concat(n));return}var i=e[e.length-1]instanceof Array&&e[e.length-1][0]==="para"?e[e.length-1]:e;r&&e.length>1&&n.unshift(r);for(var s=0;s<n.length;s++){var o=n[s],u=typeof o=="string";u&&i.length>1&&typeof i[i.length-1]=="string"?i[i.length-1]+=o:i.push(o)}}function a(e,t){var n=new RegExp("^("+r+"{"+e+"}.*?\\n?)*$"),i=new RegExp("^"+r+"{"+e+"}","gm"),s=[];while(t.length>0){if(!n.exec(t[0]))break;var u=t.shift(),a=u.replace(i,"");s.push(o(a,u.trailing,u.lineNumber))}return s}function f(e,t,n){var r=e.list,i=r[r.length-1];if(i[1]instanceof Array&&i[1][0]==="para")return;if(t+1===n.length)i.push(["para"].concat(i.splice(1,i.length-1)));else{var s=i.pop();i.push(["para"].concat(i.splice(1,i.length-1)),s)}}var e="[*+-]|\\d+\\.",t=/[*+-]/,n=new RegExp("^( {0,3})("+e+")[ 	]+"),r="(?: {0,3}\\t| {4})";return function(e,r){function l(e){var n=t.exec(e[2])?["bulletlist"]:["numberlist"];return c.push({list:n,indent:e[1]}),n}var o=e.match(n);if(!o)return undefined;var c=[],h=l(o),p,v=!1,m=[c[0].list],g;e:for(;;){var y=e.split(/(?=\n)/),b="",w="";for(var E=0;E<y.length;E++){w="";var S=y[E].replace(/^\n/,function(e){return w=e,""}),x=i(c.length);o=S.match(x);if(o[1]!==undefined){b.length&&(u(p,v,this.processInline(b),w),v=!1,b=""),o[1]=s(o[1]);var T=Math.floor(o[1].length/4)+1;if(T>c.length)h=l(o),p.push(h),p=h[1]=["listitem"];else{var N=!1;for(g=0;g<c.length;g++){if(c[g].indent!==o[1])continue;h=c[g].list,c.splice(g+1,c.length-(g+1)),N=!0;break}N||(T++,T<=c.length?(c.splice(T,c.length-T),h=c[T-1].list):(h=l(o),p.push(h))),p=["listitem"],h.push(p)}w=""}S.length>o[0].length&&(b+=w+S.substr(o[0].length))}b.length&&(u(p,v,this.processInline(b),w),p[p.length-1]==="\n"&&p.pop(),v=!1,b="");var C=a(c.length,r);C.length>0&&(d(c,f,this),p.push.apply(p,this.toTree(C,[])));var k=r[0]&&r[0].valueOf()||"";if(k.match(n)||k.match(/^ /)){e=r.shift();var L=this.dialect.block.horizRule(e,r);if(L){m.push.apply(m,L);break}c[c.length-1].indent===e.match(/^\s*/)[0]&&d(c,f,this),v=!0;continue e}break}return m}}(),blockquote:function(t,n){var r=/(^|\n) +(\>[\s\S]*)/.exec(t);if(r&&r[2]&&r[2].length){var i=t.replace(/(^|\n) +\>/,"$1>");return n.unshift(i),[]}if(!t.match(/^>/m))return undefined;var s=[];if(t[0]!==">"){var u=t.split(/\n/),f=[],l=t.lineNumber;while(u.length&&u[0][0]!==">")f.push(u.shift()),l++;var c=o(f.join("\n"),"\n",t.lineNumber);s.push.apply(s,this.processBlock(c,[])),t=o(u.join("\n"),t.trailing,l)}while(n.length&&n[0][0]===">"){var h=n.shift();t=o(t+t.trailing+h,h.trailing,t.lineNumber)}var p=t.replace(/^> ?/gm,""),d=this.tree,m=this.toTree(p,["blockquote"]),g=a(m);return g&&g.references&&(delete g.references,v(g)&&m.splice(1,1)),s.push(m),s},referenceDefn:function(t,n){var r=/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*)\3|\((.*?)\)))?\n?/;if(!t.match(r))return undefined;var i=b.call(this),s=this.loop_re_over_block(r,t,function(e){w(i,e)});return s.length&&n.unshift(o(s,t.trailing)),[]},para:function(t){return[["para"].concat(this.processInline(t))]}},inline:{__oneElement__:function(t,n,r){var i,s;n=n||this.dialect.inline.__patterns__;var o=new RegExp("([\\s\\S]*?)("+(n.source||n)+")");i=o.exec(t);if(!i)return[t.length,t];if(i[1])return[i[1].length,i[1]];var s;return i[2]in this.dialect.inline&&(s=this.dialect.inline[i[2]].call(this,t.substr(i.index),i,r||[])),s=s||[i[2].length,i[2]],s},__call__:function(t,n){function s(e){typeof e=="string"&&typeof r[r.length-1]=="string"?r[r.length-1]+=e:r.push(e)}var r=[],i;while(t.length>0)i=this.dialect.inline.__oneElement__.call(this,t,n,r),t=t.substr(i.shift()),d(i,s);return r},"]":function(){},"}":function(){},__escape__:/^\\[\\`\*_{}<>\[\]()#\+.!\-]/,"\\":function(t){return this.dialect.inline.__escape__.exec(t)?[2,t.charAt(1)]:[1,"\\"]},"![":function(t){var n=t.match(/^!\[(.*?)][ \t]*\(((?:https?:(?:\/{1,3}|[a-z0-9%])|www\d{0,3}[.])(?:[^\s()<>]+|\([^\s()<>]+\))+(?:\([^\s()<>]+\)|[^`!()\[\]{};:'".,<>?Â«Â»â€œâ€â€˜â€™\s]))\)([ \t])*(["'].*["'])?/)||t.match(/^!\[(.*?)\][ \t]*\([ \t]*([^")]*?)(?:[ \t]+(["'])(.*?)\3)?[ \t]*\)/);if(n){n[2]&&n[2][0]==="<"&&n[2][n[2].length-1]===">"&&(n[2]=n[2].substring(1,n[2].length-1)),n[2]=this.dialect.inline.__call__.call(this,n[2],/\\/)[0];var r={alt:n[1],href:n[2]||""};return n[4]!==undefined&&(r.title=n[4]),[n[0].length,["img",r]]}return n=t.match(/^!\[(.*?)\][ \t]*\[(.*?)\]/),n?[n[0].length,["img_ref",{alt:n[1],ref:n[2].toLowerCase(),original:n[0]}]]:[2,"!["]},"[":function x(e){var t=String(e),n=m.call(this,e.substr(1),"]");if(!n)return[1,"["];var r=1+n[0],i=n[1],x,s;e=e.substr(r);var o=e.match(/^\s*\([ \t]*([^"']*)(?:[ \t]+(["'])(.*?)\2)?[ \t]*\)/);if(o){var u=o[1].replace(/\s+$/,"");r+=o[0].length,u&&u[0]==="<"&&u[u.length-1]===">"&&(u=u.substring(1,u.length-1));if(!o[3]){var a=1;for(var f=0;f<u.length;f++)switch(u[f]){case"(":a++;break;case")":--a===0&&(r-=u.length-f,u=u.substring(0,f))}}return u=this.dialect.inline.__call__.call(this,u,/\\/)[0],s={href:u||""},o[3]!==undefined&&(s.title=o[3]),x=["link",s].concat(i),[r,x]}o=e.match(/^\s*\[(.*?)\]/);if(o)return r+=o[0].length,s={ref:(o[1]||String(i)).toLowerCase(),original:t.substr(0,r)},x=["link_ref",s].concat(i),[r,x];o=t.match(/^\s*\[(.*?)\]:\s*(\S+)(?:\s+(?:(['"])(.*?)\3|\((.*?)\)))?\n?/);if(o){var s=b.call(this);return w(s,o),[o[0].length]}if(i.length===1&&typeof i[0]=="string"){var l=i[0].toLowerCase().replace(/\s+/," ");return s={ref:l,original:t.substr(0,r)},x=["link_ref",s,i[0]],[r,x]}return[1,"["]},"<":function(t){var n;return(n=t.match(/^<(?:((https?|ftp|mailto):[^>]+)|(.*?@.*?\.[a-zA-Z]+))>/))!==null?n[3]?[n[0].length,["link",{href:"mailto:"+n[3]},n[3]]]:n[2]==="mailto"?[n[0].length,["link",{href:n[1]},n[1].substr("mailto:".length)]]:[n[0].length,["link",{href:n[1]},n[1]]]:[1,"<"]},"`":function(t){var n=t.match(/(`+)(([\s\S]*?)\1)/);return n&&n[2]?[n[1].length+n[2].length,["inlinecode",n[3]]]:[1,"`"]},"  \n":function(){return[3,["linebreak"]]}}};g.inline["**"]=y("strong","**"),g.inline.__=y("strong","__"),g.inline["*"]=y("em","*"),g.inline._=y("em","_"),s.dialects.Gruber=g,s.buildBlockOrder(s.dialects.Gruber.block),s.buildInlinePatterns(s.dialects.Gruber.inline);var E=p.subclassDialect(g),a=t.extract_attr,d=t.forEach;E.processMetaHash=function(t){var n=S(t),r={};for(var i=0;i<n.length;++i)if(/^#/.test(n[i]))r.id=n[i].substring(1);else if(/^\./.test(n[i]))r["class"]?r["class"]=r["class"]+n[i].replace(/./," "):r["class"]=n[i].substring(1);else if(/\=/.test(n[i])){var s=n[i].split(/\=/);r[s[0]]=s[1]}return r},E.block.document_meta=function(t){if(t.lineNumber>1)return undefined;if(!t.match(/^(?:\w+:.*\n)*\w+:.*$/))return undefined;a(this.tree)||this.tree.splice(1,0,{});var n=t.split(/\n/);for(var r in n){var i=n[r].match(/(\w+):\s*(.*)$/),s=i[1].toLowerCase(),o=i[2];this.tree[1][s]=o}return[]},E.block.block_meta=function(t){var n=t.match(/(^|\n) {0,3}\{:\s*((?:\\\}|[^\}])*)\s*\}$/);if(!n)return undefined;var r=this.dialect.processMetaHash(n[2]),i;if(n[1]===""){var s=this.tree[this.tree.length-1];i=a(s);if(typeof s=="string")return undefined;i||(i={},s.splice(1,0,i));for(var o in r)i[o]=r[o];return[]}var u=t.replace(/\n.*$/,""),f=this.processBlock(u,[]);i=a(f[0]),i||(i={},f[0].splice(1,0,i));for(var o in r)i[o]=r[o];return f},E.block.definition_list=function(t,n){var r=/^((?:[^\s:].*\n)+):\s+([\s\S]+)$/,i=["dl"],s,o;if(!(o=t.match(r)))return undefined;var u=[t];while(n.length&&r.exec(n[0]))u.push(n.shift());for(var a=0;a<u.length;++a){var o=u[a].match(r),f=o[1].replace(/\n$/,"").split(/\n/),l=o[2].split(/\n:\s+/);for(s=0;s<f.length;++s)i.push(["dt",f[s]]);for(s=0;s<l.length;++s)i.push(["dd"].concat(this.processInline(l[s].replace(/(\n)\s+/,"$1"))))}return[i]},E.block.table=function T(e){var t=function(e,t){t=t||"\\s",t.match(/^[\\|\[\]{}?*.+^$]$/)&&(t="\\"+t);var n=[],r=new RegExp("^((?:\\\\.|[^\\\\"+t+"])*)"+t+"(.*)"),i;while(i=e.match(r))n.push(i[1]),e=i[2];return n.push(e),n},n=/^ {0,3}\|(.+)\n {0,3}\|\s*([\-:]+[\-| :]*)\n((?:\s*\|.*(?:\n|$))*)(?=\n|$)/,r=/^ {0,3}(\S(?:\\.|[^\\|])*\|.*)\n {0,3}([\-:]+\s*\|[\-| :]*)\n((?:(?:\\.|[^\\|])*\|.*(?:\n|$))*)(?=\n|$)/,i,s;if(s=e.match(n))s[3]=s[3].replace(/^\s*\|/gm,"");else if(!(s=e.match(r)))return undefined;var T=["table",["thead",["tr"]],["tbody"]];s[2]=s[2].replace(/\|\s*$/,"").split("|");var o=[];d(s[2],function(e){e.match(/^\s*-+:\s*$/)?o.push({align:"right"}):e.match(/^\s*:-+\s*$/)?o.push({align:"left"}):e.match(/^\s*:-+:\s*$/)?o.push({align:"center"}):o.push({})}),s[1]=t(s[1].replace(/\|\s*$/,""),"|");for(i=0;i<s[1].length;i++)T[1][1].push(["th",o[i]||{}].concat(this.processInline(s[1][i].trim())));return d(s[3].replace(/\|\s*$/mg,"").split("\n"),function(e){var n=["tr"];e=t(e,"|");for(i=0;i<e.length;i++)n.push(["td",o[i]||{}].concat(this.processInline(e[i].trim())));T[2].push(n)},this),[T]},E.inline["{:"]=function(t,n,r){if(!r.length)return[2,"{:"];var i=r[r.length-1];if(typeof i=="string")return[2,"{:"];var s=t.match(/^\{:\s*((?:\\\}|[^\}])*)\s*\}/);if(!s)return[2,"{:"];var o=this.dialect.processMetaHash(s[1]),u=a(i);u||(u={},i.splice(1,0,u));for(var f in o)u[f]=o[f];return[s[0].length,""]},s.dialects.Maruku=E,s.dialects.Maruku.inline.__escape__=/^\\[\\`\*_{}\[\]()#\+.!\-|:]/,s.buildBlockOrder(s.dialects.Maruku.block),s.buildInlinePatterns(s.dialects.Maruku.inline),e.Markdown=s,e.parse=s.parse,e.toHTML=s.toHTML,e.toHTMLTree=s.toHTMLTree,e.renderJsonML=s.renderJsonML})(function(){return window.markdown={},window.markdown}()),function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define(t):e.Spinner=t()}(this,function(){"use strict";function r(e,t){var n=document.createElement(e||"div"),r;for(r in t)n[r]=t[r];return n}function i(e){for(var t=1,n=arguments.length;t<n;t++)e.appendChild(arguments[t]);return e}function o(e,r,i,o){var u=["opacity",r,~~(e*100),i,o].join("-"),a=.01+i/o*100,f=Math.max(1-(1-e)/r*(100-a),e),l=n.substring(0,n.indexOf("Animation")).toLowerCase(),c=l&&"-"+l+"-"||"";return t[u]||(s.insertRule("@"+c+"keyframes "+u+"{"+"0%{opacity:"+f+"}"+a+"%{opacity:"+e+"}"+(a+.01)+"%{opacity:1}"+(a+r)%100+"%{opacity:"+e+"}"+"100%{opacity:"+f+"}"+"}",s.cssRules.length),t[u]=1),u}function u(t,n){var r=t.style,i,s;if(r[n]!==undefined)return n;n=n.charAt(0).toUpperCase()+n.slice(1);for(s=0;s<e.length;s++){i=e[s]+n;if(r[i]!==undefined)return i}}function a(e,t){for(var n in t)e.style[u(e,n)||n]=t[n];return e}function f(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)e[r]===undefined&&(e[r]=n[r])}return e}function l(e){var t={x:e.offsetLeft,y:e.offsetTop};while(e=e.offsetParent)t.x+=e.offsetLeft,t.y+=e.offsetTop;return t}function h(e){if(typeof this=="undefined")return new h(e);this.opts=f(e||{},h.defaults,c)}function p(){function e(e,t){return r("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',t)}s.addRule(".spin-vml","behavior:url(#default#VML)"),h.prototype.lines=function(t,n){function o(){return a(e("group",{coordsize:s+" "+s,coordorigin:-r+" "+ -r}),{width:s,height:s})}function c(t,s,u){i(f,i(a(o(),{rotation:360/n.lines*t+"deg",left:~~s}),i(a(e("roundrect",{arcsize:n.corners}),{width:r,height:n.width,left:n.radius,top:-n.width>>1,filter:u}),e("fill",{color:n.color,opacity:n.opacity}),e("stroke",{opacity:0}))))}var r=n.length+n.width,s=2*r,u=-(n.width+n.length)*2+"px",f=a(o(),{position:"absolute",top:u,left:u}),l;if(n.shadow)for(l=1;l<=n.lines;l++)c(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)c(l);return i(t,f)},h.prototype.opacity=function(e,t,n,r){var i=e.firstChild;r=r.shadow&&r.lines||0,i&&t+r<i.childNodes.length&&(i=i.childNodes[t+r],i=i&&i.firstChild,i=i&&i.firstChild,i&&(i.opacity=n))}}var e=["webkit","Moz","ms","O"],t={},n,s=function(){var e=r("style",{type:"text/css"});return i(document.getElementsByTagName("head")[0],e),e.sheet||e.styleSheet}(),c={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"auto",left:"auto",position:"relative"};h.defaults={},f(h.prototype,{spin:function(e){this.stop();var t=this,i=t.opts,s=t.el=a(r(0,{className:i.className}),{position:i.position,width:0,zIndex:i.zIndex}),o=i.radius+i.length+i.width,u,f;e&&(e.insertBefore(s,e.firstChild||null),f=l(e),u=l(s),a(s,{left:(i.left=="auto"?f.x-u.x+(e.offsetWidth>>1):parseInt(i.left,10)+o)+"px",top:(i.top=="auto"?f.y-u.y+(e.offsetHeight>>1):parseInt(i.top,10)+o)+"px"})),s.setAttribute("role","progressbar"),t.lines(s,t.opts);if(!n){var c=0,h=(i.lines-1)*(1-i.direction)/2,p,d=i.fps,v=d/i.speed,m=(1-i.opacity)/(v*i.trail/100),g=v/i.lines;(function y(){c++;for(var e=0;e<i.lines;e++)p=Math.max(1-(c+(i.lines-e)*g)%v*m,i.opacity),t.opacity(s,e*i.direction+h,p,i);t.timeout=t.el&&setTimeout(y,~~(1e3/d))})()}return t},stop:function(){var e=this.el;return e&&(clearTimeout(this.timeout),e.parentNode&&e.parentNode.removeChild(e),this.el=undefined),this},lines:function(e,t){function l(e,n){return a(r(),{position:"absolute",width:t.length+t.width+"px",height:t.width+"px",background:e,boxShadow:n,transformOrigin:"left",transform:"rotate("+~~(360/t.lines*s+t.rotate)+"deg) translate("+t.radius+"px"+",0)",borderRadius:(t.corners*t.width>>1)+"px"})}var s=0,u=(t.lines-1)*(1-t.direction)/2,f;for(;s<t.lines;s++)f=a(r(),{position:"absolute",top:1+~(t.width/2)+"px",transform:t.hwaccel?"translate3d(0,0,0)":"",opacity:t.opacity,animation:n&&o(t.opacity,t.trail,u+s*t.direction,t.lines)+" "+1/t.speed+"s linear infinite"}),t.shadow&&i(f,a(l("#000","0 0 4px #000"),{top:"2px"})),i(e,i(f,l(t.color,"0 0 1px rgba(0,0,0,.1)")));return e},opacity:function(e,t,n){t<e.childNodes.length&&(e.childNodes[t].style.opacity=n)}});var d=a(r("group"),{behavior:"url(#default#VML)"});return!u(d,"transform")&&d.adj?p():n=u(d,"animation"),h}),function(e,t){typeof exports=="object"?module.exports=t():typeof define=="function"&&define.amd?define(["spin"],t):e.Ladda=t(e.Spinner)}(this,function(e){"use strict";function n(e){if(typeof e=="undefined"){console.warn("Ladda button target must be defined.");return}e.querySelector(".ladda-label")||(e.innerHTML='<span class="ladda-label">'+e.innerHTML+"</span>");var n=u(e),r=document.createElement("span");r.className="ladda-spinner",e.appendChild(r);var i,s={start:function(){return e.setAttribute("disabled",""),e.setAttribute("data-loading",""),clearTimeout(i),n.spin(r),this.setProgress(0),this},startAfter:function(e){return clearTimeout(i),i=setTimeout(function(){s.start()},e),this},stop:function(){return e.removeAttribute("disabled"),e.removeAttribute("data-loading"),clearTimeout(i),i=setTimeout(function(){n.stop()},1e3),this},toggle:function(){return this.isLoading()?this.stop():this.start(),this},setProgress:function(t){t=Math.max(Math.min(t,1),0);var n=e.querySelector(".ladda-progress");t===0&&n&&n.parentNode?n.parentNode.removeChild(n):(n||(n=document.createElement("div"),n.className="ladda-progress",e.appendChild(n)),n.style.width=(t||0)*e.offsetWidth+"px")},enable:function(){return this.stop(),this},disable:function(){return this.stop(),e.setAttribute("disabled",""),this},isLoading:function(){return e.hasAttribute("data-loading")}};return t.push(s),s}function r(e,t){while(e.parentNode&&e.tagName!==t)e=e.parentNode;return e}function i(e){var t=["input","textarea"],n=[];for(var r=0;r<t.length;r++){var i=e.getElementsByTagName(t[r]);for(var s=0;s<i.length;s++)i[s].hasAttribute("required")&&n.push(i[s])}return n}function s(e,t){t=t||{};var s=[];typeof e=="string"?s=a(document.querySelectorAll(e)):typeof e=="object"&&typeof e.nodeName=="string"&&(s=[e]);for(var o=0,u=s.length;o<u;o++)(function(){var e=s[o];if(typeof e.addEventListener=="function"){var u=n(e),a=-1;e.addEventListener("click",function(n){var s=!0,o=r(e,"FORM"),f=i(o);for(var l=0;l<f.length;l++)f[l].value.replace(/^\s+|\s+$/g,"")===""&&(s=!1);s&&(u.startAfter(1),typeof t.timeout=="number"&&(clearTimeout(a),a=setTimeout(u.stop,t.timeout)),typeof t.callback=="function"&&t.callback.apply(null,[u]))},!1)}})()}function o(){for(var e=0,n=t.length;e<n;e++)t[e].stop()}function u(t){var n=t.offsetHeight,r;n>32&&(n*=.8),t.hasAttribute("data-spinner-size")&&(n=parseInt(t.getAttribute("data-spinner-size"),10)),t.hasAttribute("data-spinner-color")&&(r=t.getAttribute("data-spinner-color"));var i=12,s=n*.2,o=s*.6,u=s<7?2:3;return new e({color:r||"#fff",lines:i,radius:s,length:o,width:u,zIndex:"auto",top:"auto",left:"auto",className:""})}function a(e){var t=[];for(var n=0;n<e.length;n++)t.push(e[n]);return t}var t=[];return{bind:s,create:n,stopAll:o}}),function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=self.Prism={util:{type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){var n=t.util.type(e);switch(n){case"Object":var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.util.clone(e[i]));return r;case"Array":return e.slice()}return e}},languages:{extend:function(e,n){var r=t.util.clone(t.languages[e]);for(var i in n)r[i]=n[i];return r},insertBefore:function(e,n,r,i){i=i||t.languages;var s=i[e],o={};for(var u in s)if(s.hasOwnProperty(u)){if(u==n)for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);o[u]=s[u]}return i[e]=o},DFS:function(e,n){for(var r in e)n.call(e,r,e[r]),t.util.type(e)==="Object"&&t.languages.DFS(e[r],n)}},highlightAll:function(e,n){var r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');for(var i=0,s;s=r[i++];)t.highlightElement(s,e===!0,n)},highlightElement:function(r,i,s){var o,u,a=r;while(a&&!e.test(a.className))a=a.parentNode;a&&(o=(a.className.match(e)||[,""])[1],u=t.languages[o]);if(!u)return;r.className=r.className.replace(e,"").replace(/\s+/g," ")+" language-"+o,a=r.parentNode,/pre/i.test(a.nodeName)&&(a.className=a.className.replace(e,"").replace(/\s+/g," ")+" language-"+o);var f=r.textContent;if(!f)return;f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ");var l={element:r,language:o,grammar:u,code:f};t.hooks.run("before-highlight",l);if(i&&self.Worker){var c=new Worker(t.filename);c.onmessage=function(e){l.highlightedCode=n.stringify(JSON.parse(e.data),o),t.hooks.run("before-insert",l),l.element.innerHTML=l.highlightedCode,s&&s.call(l.element),t.hooks.run("after-highlight",l)},c.postMessage(JSON.stringify({language:l.language,code:l.code}))}else l.highlightedCode=t.highlight(l.code,l.grammar,l.language),t.hooks.run("before-insert",l),l.element.innerHTML=l.highlightedCode,s&&s.call(r),t.hooks.run("after-highlight",l)},highlight:function(e,r,i){return n.stringify(t.tokenize(e,r),i)},tokenize:function(e,n,r){var i=t.Token,s=[e],o=n.rest;if(o){for(var u in o)n[u]=o[u];delete n.rest}e:for(var u in n){if(!n.hasOwnProperty(u)||!n[u])continue;var a=n[u],f=a.inside,l=!!a.lookbehind,c=0;a=a.pattern||a;for(var h=0;h<s.length;h++){var p=s[h];if(s.length>e.length)break e;if(p instanceof i)continue;a.lastIndex=0;var d=a.exec(p);if(d){l&&(c=d[1].length);var v=d.index-1+c,d=d[0].slice(c),m=d.length,g=v+m,y=p.slice(0,v+1),b=p.slice(g+1),w=[h,1];y&&w.push(y);var E=new i(u,f?t.tokenize(d,f):d);w.push(E),b&&w.push(b),Array.prototype.splice.apply(s,w)}}}return s},hooks:{all:{},add:function(e,n){var r=t.hooks.all;r[e]=r[e]||[],r[e].push(n)},run:function(e,n){var r=t.hooks.all[e];if(!r||!r.length)return;for(var i=0,s;s=r[i++];)s(n)}}},n=t.Token=function(e,t){this.type=e,this.content=t};n.stringify=function(e,r,i){if(typeof e=="string")return e;if(Object.prototype.toString.call(e)=="[object Array]")return e.map(function(t){return n.stringify(t,r,e)}).join("");var s={type:e.type,content:n.stringify(e.content,r,i),tag:"span",classes:["token",e.type],attributes:{},language:r,parent:i};s.type=="comment"&&(s.attributes.spellcheck="true"),t.hooks.run("wrap",s);var o="";for(var u in s.attributes)o+=u+'="'+(s.attributes[u]||"")+'"';return"<"+s.tag+' class="'+s.classes.join(" ")+'" '+o+">"+s.content+"</"+s.tag+">"};if(!self.document){self.addEventListener("message",function(e){var n=JSON.parse(e.data),r=n.language,i=n.code;self.postMessage(JSON.stringify(t.tokenize(i,t.languages[r]))),self.close()},!1);return}var r=document.getElementsByTagName("script");r=r[r.length-1],r&&(t.filename=r.src,document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll))}(),Prism.languages.markup={comment:/&lt;!--[\w\W]*?-->/g,prolog:/&lt;\?.+?\?>/,doctype:/&lt;!DOCTYPE.+?>/,cdata:/&lt;!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?>/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|>|"/g}},punctuation:/\/?>/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi},Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*{))/gi,inside:{punctuation:/[;:]/g}},url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\};]*(?=\s*\{)/g,property:/(\b|\B)[\w-]+(?=\s*:)/ig,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g},Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}}),Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|(^|[^:])\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,"class-name":{pattern:/((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/ig,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/g,"boolean":/\b(true|false)\b/g,"function":{pattern:/[a-z0-9_]+\(/ig,inside:{punctuation:/\(/}},number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,operator:/[-+]{1,2}|!|&lt;=?|>=?|={1,3}|(&amp;){1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g},Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|throw|catch|finally|null|break|continue)\b/g,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}}),Prism.languages.scss=Prism.languages.extend("css",{comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},atrule:/@[\w-]+(?=\s+(\(|\{|;))/gi,url:/([-a-z]+-)*url(?=\()/gi,selector:/([^@;\{\}\(\)]?([^@;\{\}\(\)]|&amp;|\#\{\$[-_\w]+\})+)(?=\s*\{(\}|\s|[^\}]+(:|\{)[^\}]+))/gm}),Prism.languages.insertBefore("scss","atrule",{keyword:/@(if|else if|else|for|each|while|import|extend|debug|warn|mixin|include|function|return)|(?=@for\s+\$[-_\w]+\s)+from/i}),Prism.languages.insertBefore("scss","property",{variable:/((\$[-_\w]+)|(#\{\$[-_\w]+\}))/i}),Prism.languages.insertBefore("scss","ignore",{placeholder:/%[-_\w]+/i,statement:/\B!(default|optional)\b/gi,"boolean":/\b(true|false)\b/g,"null":/\b(null)\b/g,operator:/\s+([-+]{1,2}|={1,2}|!=|\|?\||\?|\*|\/|\%)\s+/g}),function(e,t){function r(e,t,n){var r=e.children(),i=!1;e.empty();for(var s=0,u=r.length;s<u;s++){var a=r.eq(s);e.append(a),n&&e.append(n);if(o(e,t)){a.remove(),i=!0;break}n&&n.detach()}return i}function i(t,n,r,u,a){var f=!1,l="table, thead, tbody, tfoot, tr, col, colgroup, object, embed, param, ol, ul, dl, blockquote, select, optgroup, option, textarea, script, style",c="script";return t
.contents().detach().each(function(){var h=this,p=e(h);if(typeof h=="undefined"||h.nodeType==3&&e.trim(h.data).length==0)return!0;if(p.is(c))t.append(p);else{if(f)return!0;t.append(p),a&&t[t.is(l)?"after":"append"](a),o(r,u)&&(h.nodeType==3?f=s(p,n,r,u,a):f=i(p,n,r,u,a),f||(p.detach(),f=!0)),f||a&&a.detach()}}),f}function s(t,n,r,i,s){var a=t[0];if(!a)return!1;var c=l(a),p=c.indexOf(" ")!==-1?" ":"ã€€",d=i.wrap=="letter"?"":p,v=c.split(d),m=-1,g=-1,y=0,b=v.length-1;i.fallbackToLetter&&y==0&&b==0&&(d="",v=c.split(d),b=v.length-1);while(y<=b&&(y!=0||b!=0)){var w=Math.floor((y+b)/2);if(w==g)break;g=w,f(a,v.slice(0,g+1).join(d)+i.ellipsis),o(r,i)?(b=g,i.fallbackToLetter&&y==0&&b==0&&(d="",v=v[0].split(d),m=-1,g=-1,y=0,b=v.length-1)):(m=g,y=g)}if(m==-1||v.length==1&&v[0].length==0){var E=t.parent();t.detach();var S=s&&s.closest(E).length?s.length:0;E.contents().length>S?a=h(E.contents().eq(-1-S),n):(a=h(E,n,!0),S||E.detach()),a&&(c=u(l(a),i),f(a,c),S&&s&&e(a).parent().append(s))}else c=u(v.slice(0,m+1).join(d),i),f(a,c);return!0}function o(e,t){return e.innerHeight()>t.maxHeight}function u(t,n){while(e.inArray(t.slice(-1),n.lastCharacter.remove)>-1)t=t.slice(0,-1);return e.inArray(t.slice(-1),n.lastCharacter.noEllipsis)<0&&(t+=n.ellipsis),t}function a(e){return{width:e.innerWidth(),height:e.innerHeight()}}function f(e,t){e.innerText?e.innerText=t:e.nodeValue?e.nodeValue=t:e.textContent&&(e.textContent=t)}function l(e){return e.innerText?e.innerText:e.nodeValue?e.nodeValue:e.textContent?e.textContent:""}function c(e){do e=e.previousSibling;while(e&&e.nodeType!==1&&e.nodeType!==3);return e}function h(t,n,r){var i=t&&t[0],s;if(i){if(!r){if(i.nodeType===3)return i;if(e.trim(t.text()))return h(t.contents().last(),n)}s=c(i);while(!s){t=t.parent();if(t.is(n)||!t.length)return!1;s=c(t[0])}if(s)return h(e(s),n)}return!1}function p(t,n){return t?typeof t=="string"?(t=e(t,n),t.length?t:!1):t.jquery?t:!1:!1}function d(e){var t=e.innerHeight(),n=["paddingTop","paddingBottom"];for(var r=0,i=n.length;r<i;r++){var s=parseInt(e.css(n[r]),10);isNaN(s)&&(s=0),t-=s}return t}if(e.fn.dotdotdot)return;e.fn.dotdotdot=function(t){if(this.length==0)return e.fn.dotdotdot.debug('No element found for "'+this.selector+'".'),this;if(this.length>1)return this.each(function(){e(this).dotdotdot(t)});var s=this;s.data("dotdotdot")&&s.trigger("destroy.dot"),s.data("dotdotdot-style",s.attr("style")||""),s.css("word-wrap","break-word"),s.css("white-space")==="nowrap"&&s.css("white-space","normal"),s.bind_events=function(){return s.bind("update.dot",function(t,n){t.preventDefault(),t.stopPropagation(),f.maxHeight=typeof f.height=="number"?f.height:d(s),f.maxHeight+=f.tolerance;if(typeof n!="undefined"){if(typeof n=="string"||n instanceof HTMLElement)n=e("<div />").append(n).contents();n instanceof e&&(u=n)}v=s.wrapInner('<div class="dotdotdot" />').children(),v.contents().detach().end().append(u.clone(!0)).find("br").replaceWith("  <br />  ").end().css({height:"auto",width:"auto",border:"none",padding:0,margin:0});var a=!1,c=!1;return l.afterElement&&(a=l.afterElement.clone(!0),a.show(),l.afterElement.detach()),o(v,f)&&(f.wrap=="children"?c=r(v,f,a):c=i(v,s,v,f,a)),v.replaceWith(v.contents()),v=null,e.isFunction(f.callback)&&f.callback.call(s[0],c,u),l.isTruncated=c,c}).bind("isTruncated.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),typeof t=="function"&&t.call(s[0],l.isTruncated),l.isTruncated}).bind("originalContent.dot",function(e,t){return e.preventDefault(),e.stopPropagation(),typeof t=="function"&&t.call(s[0],u),u}).bind("destroy.dot",function(e){e.preventDefault(),e.stopPropagation(),s.unwatch().unbind_events().contents().detach().end().append(u).attr("style",s.data("dotdotdot-style")||"").data("dotdotdot",!1)}),s},s.unbind_events=function(){return s.unbind(".dot"),s},s.watch=function(){s.unwatch();if(f.watch=="window"){var t=e(window),n=t.width(),r=t.height();t.bind("resize.dot"+l.dotId,function(){if(n!=t.width()||r!=t.height()||!f.windowResizeFix)n=t.width(),r=t.height(),h&&clearInterval(h),h=setTimeout(function(){s.trigger("update.dot")},100)})}else c=a(s),h=setInterval(function(){if(s.is(":visible")){var e=a(s);if(c.width!=e.width||c.height!=e.height)s.trigger("update.dot"),c=e}},500);return s},s.unwatch=function(){return e(window).unbind("resize.dot"+l.dotId),h&&clearInterval(h),s};var u=s.contents(),f=e.extend(!0,{},e.fn.dotdotdot.defaults,t),l={},c={},h=null,v=null;return f.lastCharacter.remove instanceof Array||(f.lastCharacter.remove=e.fn.dotdotdot.defaultArrays.lastCharacter.remove),f.lastCharacter.noEllipsis instanceof Array||(f.lastCharacter.noEllipsis=e.fn.dotdotdot.defaultArrays.lastCharacter.noEllipsis),l.afterElement=p(f.after,s),l.isTruncated=!1,l.dotId=n++,s.data("dotdotdot",!0).bind_events().trigger("update.dot"),f.watch&&s.watch(),s},e.fn.dotdotdot.defaults={ellipsis:"... ",wrap:"word",fallbackToLetter:!0,lastCharacter:{},tolerance:0,callback:null,after:null,height:null,watch:!1,windowResizeFix:!0},e.fn.dotdotdot.defaultArrays={lastCharacter:{remove:[" ","ã€€",",",";",".","!","?"],noEllipsis:[]}},e.fn.dotdotdot.debug=function(e){};var n=1,v=e.fn.html;e.fn.html=function(n){return n!=t&&!e.isFunction(n)&&this.data("dotdotdot")?this.trigger("update",[n]):v.apply(this,arguments)};var m=e.fn.text;e.fn.text=function(n){return n!=t&&!e.isFunction(n)&&this.data("dotdotdot")?(n=e("<div />").text(n).html(),this.trigger("update",[n])):m.apply(this,arguments)}}(jQuery);var docCookies={getItem:function(e){return decodeURIComponent(document.cookie.replace(new RegExp("(?:(?:^|.*;)\\s*"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=\\s*([^;]*).*$)|^.*$"),"$1"))||null},setItem:function(e,t,n,r,i,s){if(!e||/^(?:expires|max\-age|path|domain|secure)$/i.test(e))return!1;var o="";if(n)switch(n.constructor){case Number:o=n===Infinity?"; expires=Fri, 31 Dec 9999 23:59:59 GMT":"; max-age="+n;break;case String:o="; expires="+n;break;case Date:o="; expires="+n.toUTCString()}return document.cookie=encodeURIComponent(e)+"="+encodeURIComponent(t)+o+(i?"; domain="+i:"")+(r?"; path="+r:"")+(s?"; secure":""),!0},removeItem:function(e,t,n){return!e||!this.hasItem(e)?!1:(document.cookie=encodeURIComponent(e)+"=; expires=Thu, 01 Jan 1970 00:00:00 GMT"+(n?"; domain="+n:"")+(t?"; path="+t:""),!0)},hasItem:function(e){return(new RegExp("(?:^|;\\s*)"+encodeURIComponent(e).replace(/[\-\.\+\*]/g,"\\$&")+"\\s*\\=")).test(document.cookie)},keys:function(){var e=document.cookie.replace(/((?:^|\s*;)[^\=]+)(?=;|$)|^\s*|\s*(?:\=[^;]*)?(?:\1|$)/g,"").split(/\s*(?:\=[^;]*)?;\s*/);for(var t=0;t<e.length;t++)e[t]=decodeURIComponent(e[t]);return e}};if(typeof Litmus=="undefined")var Litmus={};Litmus.Reader=function(){},Litmus.Reader.displayNewActivity=function(){$("article[data-discussion-id]").each(function(e){var t=$(this),n=t.data("discussion-id"),r=docCookies.getItem("discussion-"+n+"-read"),i=moment.utc(t.find("time").data("last-commented-at"));r!==null&&i>moment(parseInt(r))&&!t.find(".new-activity").length&&(t.find("a").addClass("new-activity"),t.find("h2 a").after($("<span/>").text("New Activity").addClass("new-activity")))})},Litmus.Reader.markRead=function(e){return docCookies.removeItem("discussion-"+e+"-read"),docCookies.setItem("discussion-"+e+"-read",(new Date).getTime())},$(function(){$("body").on("click",".toggle-dropper",function(e){e.preventDefault();var t=$(this),n=$(t.data("drop")),r=n.hasClass("active");r?(t.find(".ico").text("?"),n.fadeOut("fast",function(){$(this).removeClass("active")})):(t.find(".ico").text("`"),n.fadeIn("fast",function(){$(this).addClass("active")}),n.css({position:"absolute",left:t.position().left,top:t.position().top+t.height()+10}))})}),function(){jQuery(function(){var e,t,n,r,i,s,o,u;if(!(o=window.localStorage))return;if(!$("body.learning_center.new, body.learning_center.edit").length)return;return n=new CommunityEditor($("[data-behavior~=community-editor-article]"),{headings:!0}),new TextAreaLimiter($("#article_title"),$(".title-remaining-chars")),$('a[href="#render-markdown"]').click(function(e){var t,r;return e.preventDefault(),r=$("form.add_article, form.edit_article"),t=$("#markdown-preview"),t.load("/community/learning/preview",{article:{title:$("#article_title").val(),summary:$("#article_summary").val(),content:n.content()}})}),r=$(".community-wrapper form").attr("id"),u=$("#markdown-source"),s=function(){return i(u.val())},i=function(e){return o.setItem(r,e)},t=o.getItem(r),t&&t!==""&&u.val(t),e=setInterval(s,1e3),$("form.new_article, form.edit_article").submit(function(){return clearInterval(e),i("")})})}.call(this),function(){var e,t,n;jQuery(function(){if(!$("body.learning_center.index").length)return;return e(),n(),t(),$(window).on("resize",e)}),n=function(){return $("ol.article-cards > li section h3 > a").tooltip({delay:750})},e=function(){return $("ol.article-cards > li section").find("h3, p").dotdotdot({wrap:"word"})},t=function(){return $(".community-wrapper").on("click",".pager",function(t){var r,i,s,o;return t.preventDefault(),r=$(this),i=r.hasClass("ladda-button"),i&&(s=Ladda.create(r.get(0)),s.start()),o=r.data("url"),$.get(o,function(t){var o,u;u=$(t).find(".pager"),o=$(t).find(".article-grid"),$(".article-grid").append(o.html()),e(),n();if(i)return s.stop(),r.replaceWith(u)})})}}.call(this),function(){jQuery(function(){var e,t,n;if(!$("body.learning_center.show").length)return;return $(".wiki-toc > ul > li:first-child").addClass("active"),$("body").hasClass("logged-out")?(t=100,n=395):(t=110,n=300),e={offset:{top:n}},$(".wiki-toc > ul").addClass("nav").affix(e),$("body").scrollspy({target:".wiki-toc",offset:t}),$(".wiki-toc li > a").click(function(e){return e.preventDefault(),smoothScroll(this,300,t)}),$(".toggle-target").each(function(e,t){var n,r,i,s;return r=$(t),n=$(".action",r),i=$(r.data("target")),s=function(){var e;return e=r.data("state")||"visible",e==="hidden"?(i.show(),n.text("Hide"),r.data("state","visible")):(i.hide(),n.text("Show"),r.data("state","hidden"))},r.on("click",function(e){return e.preventDefault(),s()}),s()}),$(window).load(function(){return $("body").scrollspy("refresh")})})}.call(this),$(function(){$('.community-wrapper a[href="#preview"]').each(function(e,t){textarea=$(t).closest(".tab-wrapper").find(".markdown-source"),$(t).data("community-editor",new CommunityEditor(textarea))}),$(".community-wrapper").on("click",".tab-wrapper .nav-tabs a",function(e){e.preventDefault();var t=$(this).closest(".tab-wrapper"),n=t.find(".tab-content .tab-pane.active"),r=$(this).attr("href").replace("#","");if(n.attr("id")==r)return;t.find(".nav-tabs li.active").removeClass("active"),$(this).parent().addClass("active"),t.find(".tab-content .tab-pane.active").removeClass("active"),t.find(".tab-content .tab-pane#"+r).addClass("active")}),$(".community-wrapper").on("click",'a[href="#preview"]',function(e){e.preventDefault();var t=$(this).closest(".tab-wrapper"),n=t.find('input[id$="_title"]').val();t.find(".markdown-title").text(n),t.find(".markdown-preview").html(markdown.toHTML($(this).data("community-editor").content()))})}),$(function(){$(document).on("ajaxComplete",function(){typeof adjustHeight!="undefined"&&setTimeout(adjustHeight,300),highlightCode()}),displayAuthorElements(),$(document).on("ajaxComplete",displayAuthorElements)}),window.displayAuthorElements=function(){window.moderator?$("span[data-author-id]:hidden, .author-only[data-author-id]:hidden").show():$('span[data-author-id="'+window.currentIdentityId+'"]:hidden, .author-only[data-author-id="'+window.currentIdentityId+'"]:hidden').show()},window.smoothScroll=function(e,t,n){t=typeof t!="undefined"?t:300,n=typeof n!="undefiend"?n:0,position=$(e.hash).offset().top-n,$("html, body").animate({scrollTop:position},t,function(){window.location.hash=e.hash})},window.highlightCode=function(){$('.community-wrapper pre[class!=""] code[class*="language-"]').each(function(){Prism.highlightElement(this,!1,null)})},$(function(){$(".community-module").each(function(e,t){var n=$(t);n.css({cursor:"pointer"}),n.on("click",function(){var e=n.find(".module-summary a");window.location=e.attr("href")})})}),$(function(){$("#discussion_topic_id").length&&($("#discussion_topic_id option:first").prop("disabled",!0),$("#discussion_topic_id").on("change",function(){$(this).find("option:selected").val()===""?$(this).addClass("gray"):$(this).removeClass("gray")}),$("#discussion_topic_id").trigger("change")),$("#code_question_topic_id").length&&($("#code_question_topic_id option:first").prop("disabled",!0),$("#code_question_topic_id").on("change",function(){$(this).find("option:selected").val()===""?$(this).addClass("gray"):$(this).removeClass("gray")}),$("#code_question_topic_id").trigger("change")),$(".comment-btn").on("click",function(e){e.preventDefault(),smoothScroll(this,500)}),$("#new_discussion, #new_code_question").validate({errorPlacement:function(e,t){e.insertBefore(t)}}),new TextAreaLimiter($("#discussion_title"),$(".title-remaining-chars")),new TextAreaLimiter($("#code_question_title"),$(".title-remaining-chars")),$(".community-wrapper").on("submit","form",function(){var e=$(this).find(".ladda-button").get(0);if(typeof e!="undefined"){var t=Ladda.create(e);t.start()}}),$(".community-wrapper").on("click",".discussion-edit a.cancel",function(e){e.preventDefault();var t=this;$(this).closest(".discussion-edit").fadeOut("fast",function(){$(t).closest(".post-content").find(".discussion-content").fadeIn("fast"),$(this).remove()})});var e=function(e,t){$.each(e.upvoted,function(e,n){$("#"+t+"-"+n+" .voting:first .up").addClass("active"),$("#"+t+"-"+n+" .voting:first .sup").addClass("upvoted")}),$.each(e.downvoted,function(e,n){$("#"+t+"-"+n+" .voting:first .down").addClass("active"),$("#"+t+"-"+n+" .voting:first .sup").addClass("downvoted")})};window.commentVotes!==undefined&&e(window.commentVotes,"comment"),window.discussionVotes!==undefined&&e(window.discussionVotes,"discussion"),$("#discussion-sorter, #topic-selector").on("change",function(){var e=$(this).find("option:selected").data("url");e!==undefined&&(window.location.href=e)}),$(".community-body").on("click",".pager",function(e){e.preventDefault();var t=$(this).hasClass("ladda-button");if(t){var n=Ladda.create($(this).get(0));n.start()}$.ajax({dataType:"html",url:$(this).data("url")}).done(function(e){t&&n.stop(),e.indexOf("blank-slate")==-1&&$(".community-body .community-wrapper").append(e),e.indexOf("pager")!=-1?$(".pager").not(".pager:last").parent().remove():$(".pager").parent().remove()})}),$(".comment-sorter").on("change",function(){switch($(this).val()){case"votes":CommentSorter.highestVoted();break;case"recent":CommentSorter.mostRecent();break;case"oldest":CommentSorter.oldestFirst()}})}),$(function(){$("body.community").on("click",".voting .up, .voting .down",function(e){e.preventDefault();var t=$(this).data("url");$.post(t+".js",{authenticity_token:$('meta[name="csrf-token"]').attr("content")})}),$('*[data-hidden="true"]').each(function(e,t){t=$(t),(!window.moderator||t.data("identity-id")!=window.currentIdentityId.toString())&&t.hide()})}),CommentSorter._sort=function(e){var t=$(".comments-container > .comment:not(.nested)");t.detach().sort(e),$(".comments-container:not(.answer-container)").html(t),t.hide().fadeIn()},CommentSorter.mostRecent=function(){CommentSorter._sort(function(e,t){var n=$(e),r=$(t),i=moment(n.find("time").attr("datetime")).valueOf(),s=moment(r.find("time").attr("datetime")).valueOf();return n.hasClass("answer-flag")&&!r.hasClass("answer-flag")?-1:!n.hasClass("answer-flag")&&r.hasClass("answer-flag")?1:i>s?-1:i<s?1:0})},CommentSorter.highestVoted=function(){CommentSorter._sort(function(e,t){var n=$(e),r=$(t),i=parseInt(n.find(".voting:first .sup").text()),s=parseInt(r.find(".voting:first .sup").text());return n.hasClass("answer-flag")&&!r.hasClass("answer-flag")?-1:!n.hasClass("answer-flag")&&r.hasClass("answer-flag")?1:i>s?-1:i<s?1:0})},CommentSorter.oldestFirst=function(){CommentSorter._sort(function(e,t){var n=$(e),r=$(t),i=moment(n.find("time").attr("datetime")).valueOf(),s=moment(r.find("time").attr("datetime")).valueOf();return n.hasClass("answer-flag")&&!r.hasClass("answer-flag")?-1:!n.hasClass("answer-flag")&&r.hasClass("answer-flag")?1:i>s?1:i<s?-1:0})},$(function(){$(".comments-container").on("submit",".comment-reply-form",function(){var e=$("<div />").addClass("comment-posting");$(this).after(e),(new Spinner({lines:11,width:3})).spin(e.get(0))}),$("body.community").on("ajax:complete",".new_comment",function(e,t){if(t.status===200&&t.readyState===4){var n=$(e.currentTarget);n.find("textarea").val(""),n.hasClass("nested_comment_form")&&n.closest(".comment-reply").slideUp("fast",function(){$(this).find(".comment-posting").remove()})}else $(this).find(".comment-posting").remove();Ladda.stopAll()}),$(".comments-container").on("click",".comment-report",function(e){e.preventDefault();var t=$("#report-modal"),n=$(this).closest(".comment-header").next(".comment-content").clone(),r=$(this).closest(".comment-body").data("comment-id");n.find("a.reply").remove(),t.find(".report-comment-content").html(n.html()),t.find("#comment_id").val(r),t.modal("show")}),$("#report-modal #report-confirm").on("click",function(e){e.preventDefault(),$("#report-form").submit(),$("#report-modal").modal("hide")}),$(".comments-container").on("click",".reply",function(e){e.preventDefault();var t=$(this).parents(".comment-body").find(".comment-content"),n=t.next(".comment-reply"),r=n.get(0)!==undefined;if(!r){var i=$(this).parents(".comment").data("comment-id"),s=$("#comment-reply-boilerplate").clone();t.after(s.hide()),s.find("#comment_parent_id").val(i),validateCommentForm(s.find(".comment-reply-form")),n=s}$(this).hide(),n.slideDown("fast")}),$(".comments-container").on("click",".comment-reply-footer .cancel",function(e){e.preventDefault();var t=$(this).parents(".comment-body").find(".comment-content"),n=t.next(".comment-reply");t.find(".reply").show(),n.slideUp("fast")}),$(".comments-container").on("click",".cancel",function(e){e.preventDefault();var t=$(this).parents(".comment-body"),n=t.find(".comment-content"),r=t.find(".comment-edit");r.fadeOut(function(){n.fadeIn()})}),window.validateCommentForm=function(e){$(e).validate({rules:{"comment[content]":{required:!0,minlength:5}},errorPlacement:function(e,t){e.insertBefore(t)}})},$("form.new_comment, .comment-reply-form").each(function(){validateCommentForm(this)})});var Litmus=Litmus||{};Litmus.ContextualComments=function(e,t,n){typeof n=="undefined"&&(n="p,ol,ul"),n=n.split(",");for(var r=0;r<n.length;r++)n[r]="article "+n[r]+":not(:empty)";this.allowedElements=n.join(","),this.$container=$(e),this.init(t)},Litmus.ContextualComments.prototype.init=function(e){typeof e=="undefined"&&(comments=$());var t=this;this.$container.find(this.allowedElements).not("#contributors-list").each(function(e,n){var r=$(n),i=n.tagName.toLowerCase(),s=$("article > "+i,t.$container),o=i+"#"+s.index(r);r.attr("data-context",o),r.css("position","relative"),r.append($("<aside/>").attr("data-context",o).addClass("contextual-comment-icon").html('v<span class="count">+</span>')),t._initBox(o)}),this.$container.on("click",".contextual-comment-icon",function(){t.toggleCommentBox($(this).data("context"))}),this.$container.on("click",".context-comment a.cancel",function(e){e.preventDefault();var t=$(this).closest("form");t.closest(".context-comment").removeClass("edit"),t.closest(".context-comment").find(".context-comment-container").show(),t.remove()});for(var n=0;n<=e.length-1;n++)this.addComment(e[n])},Litmus.ContextualComments.prototype._initBox=function(e){var t=this.$container.find('aside[data-context="'+e+'"]'),n=$("<section/>").addClass("contextual-comment-container").attr("data-context",e).html('<ul class="comments"></ul>'),r=$(".article-comments form").clone();r.append('<input type="hidden" name="comment[context]" value="'+e+'" />'),n.append(r),t.after(n)},Litmus.ContextualComments.prototype.addComment=function(e){var t=$(e);context=t.data("context"),$count=this.$container.find('.contextual-comment-icon[data-context="'+context+'"] .count'),$container=this.$container.find('section[data-context="'+context+'"] ul');if($container.length>0){var n=parseInt($count.text());n!=n?$count.text("1"):(n++,$count.text(n.toString())),$container.append(t)}},Litmus.ContextualComments.prototype.toggleCommentBox=function(e){var t=this.$container.find('section[data-context="'+e+'"],'+'.contextual-comment-icon[data-context="'+e+'"]');$(t.get(0)).hasClass("active")?t.removeClass("active"):(t.addClass("active"),this.$container.find("section[data-context], .contextual-comment-icon[data-context]").not(t).removeClass("active"),t.find("textarea").focus())},function(){function t(t){this.tokens=[],this.tokens.links={},this.options=t||f.defaults,this.rules=e.normal,this.options.gfm&&(this.options.tables?this.rules=e.tables:this.rules=e.gfm)}function r(e,t){this.options=t||f.defaults,this.links=e,this.rules=n.normal;if(!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=n.breaks:this.rules=n.gfm:this.options.pedantic&&(this.rules=n.pedantic)}function i(e){this.tokens=[],this.token=null,this.options=e||f.defaults}function s(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function o(e,t){return e=e.source,t=t||"",function n(r,i){return r?(i=i.source||i,i=i.replace(/(^|[^\[])\^/g,"$1"),e=e.replace(r,i),n):new RegExp(e,t)}}function u(){}function a(e){var t=1,n,r;for(;t<arguments.length;t++){n=arguments[t];for(r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}function f(e,n,r){if(r||typeof n=="function"){r||(r=n,n=null),n=a({},f.defaults,n||{});var o=n.highlight,u,l,c=0;try{u=t.lex(e,n)}catch(h){return r(h)}l=u.length;var p=function(){var e,t;try{e=i.parse(u,n)}catch(s){t=s}return n.highlight=o,t?r(t):r(null,e)};if(!o||o.length<3)return p();delete n.highlight;if(!l)return p();for(;c<u.length;c++)(function(e){return e.type!=="code"?--l||p():o(e.text,e.lang,function(t,n){if(n==null||n===e.text)return--l||p();e.text=n,e.escaped=!0,--l||p()})})(u[c]);return}try{return n&&(n=a({},f.defaults,n)),i.parse(t.lex(e,n),n)}catch(h){h.message+="\nPlease report this to https://github.com/chjj/marked.";if((n||f.defaults).silent)return"<p>An error occured:</p><pre>"+s(h.message+"",!0)+"</pre>";throw h}}var e={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:u,hr:/^( *[-*_]){3,} *(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:u,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,blockquote:/^( *>[^\n]+(\n[^\n]+)*\n*)+/,list:/^( *)(bull) [\s\S]+?(?:hr|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment|closed|closing) *(?:\n{2,}|\s*$)/,def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +["(]([^\n]+)[")])? *(?:\n+|$)/,table:u,paragraph:/^((?:[^\n]+\n?(?!hr|heading|lheading|blockquote|tag|def))+)\n*/,text:/^[^\n]+/};e.bullet=/(?:[*+-]|\d+\.)/,e.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,e.item=o(e.item,"gm")(/bull/g,e.bullet)(),e.list=o(e.list)(/bull/g,e.bullet)("hr",/\n+(?=(?: *[-*_]){3,} *(?:\n+|$))/)(),e._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:/|@)\\b",e.html=o(e.html)("comment",/<!--[\s\S]*?-->/)("closed",/<(tag)[\s\S]+?<\/\1>/)("closing",/<tag(?:"[^"]*"|'[^']*'|[^'">])*?>/)(/tag/g,e._tag)(),e.paragraph=o(e.paragraph)("hr",e.hr)("heading",e.heading)("lheading",e.lheading)("blockquote",e.blockquote)("tag","<"+e._tag)("def",e.def)(),e.normal=a({},e),e.gfm=a({},e.normal,{fences:/^ *(`{3,}|~{3,}) *(\S+)? *\n([\s\S]+?)\s*\1 *(?:\n+|$)/,paragraph:/^/}),e.gfm.paragraph=o(e.paragraph)("(?!","(?!"+e.gfm.fences.source.replace("\\1","\\2")+"|"+e.list.source.replace("\\1","\\3")+"|")(),e.tables=a({},e.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),t.rules=e,t.lex=function(e,n){var r=new t(n);return r.lex(e)},t.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},t.prototype.token=function(t,n){var t=t.replace(/^ +$/gm,""),r,i,s,o,u,a,f,l,c;while(t){if(s=this.rules.newline.exec(t))t=t.substring(s[0].length),s[0].length>1&&this.tokens.push({type:"space"});if(s=this.rules.code.exec(t)){t=t.substring(s[0].length),s=s[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?s:s.replace(/\n+$/,"")});continue}if(s=this.rules.fences.exec(t)){t=t.substring(s[0].length),this.tokens.push({type:"code",lang:s[2],text:s[3]});continue}if(s=this.rules.heading.exec(t)){t=t.substring(s[0].length),this.tokens.push({type:"heading",depth:s[1].length,text:s[2]});continue}if(n&&(s=this.rules.nptable.exec(t))){t=t.substring(s[0].length),a={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/\n$/,"").split("\n")};for(l=0;l<a.align.length;l++)/^ *-+: *$/.test(a.align[l])?a.align[l]="right":/^ *:-+: *$/.test(a.align[l])?a.align[l]="center":/^ *:-+ *$/.test(a.align[l])?a.align[l]="left":a.align[l]=null;for(l=0;l<a.cells.length;l++)a.cells[l]=a.cells[l].split(/ *\| */);this.tokens.push(a);continue}if(s=this.rules.lheading.exec(t)){t=t.substring(s[0].length),this.tokens.push({type:"heading",depth:s[2]==="="?1:2,text:s[1]});continue}if(s=this.rules.hr.exec(t)){t=t.substring(s[0].length),this.tokens.push({type:"hr"});continue}if(s=this.rules.blockquote.exec(t)){t=t.substring(s[0].length),this.tokens.push({type:"blockquote_start"}),s=s[0].replace(/^ *> ?/gm,""),this.token(s,n),this.tokens.push({type:"blockquote_end"});continue}if(s=this.rules.list.exec(t)){t=t.substring(s[0].length),o=s[2],this.tokens.push({type:"list_start",ordered:o.length>1}),s=s[0].match(this.rules.item),r=!1,c=s.length,l=0;for(;l<c;l++)a=s[l],f=a.length,a=a.replace(/^ *([*+-]|\d+\.) +/,""),~a.indexOf("\n ")&&(f-=a.length,a=this.options.pedantic?a.replace(/^ {1,4}/gm,""):a.replace(new RegExp("^ {1,"+f+"}","gm"),"")),this.options.smartLists&&l!==c-1&&(u=e.bullet.exec(s[l+1])[0],o!==u&&!(o.length>1&&u.length>1)&&(t=s.slice(l+1).join("\n")+t,l=c-1)),i=r||/\n\n(?!\s*$)/.test(a),l!==c-1&&(r=a.charAt(a.length-1)==="\n",i||(i=r)),this.tokens.push({type:i?"loose_item_start":"list_item_start"}),this.token(a,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"});continue}if(s=this.rules.html.exec(t)){t=t.substring(s[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:s[1]==="pre"||s[1]==="script"||s[1]==="style",text:s[0]});continue}if(n&&(s=this.rules.def.exec(t))){t=t.substring(s[0].length),this.tokens.links[s[1].toLowerCase()]={href:s[2],title:s[3]};continue}if(n&&(s=this.rules.table.exec(t))){t=t.substring(s[0].length),a={type:"table",header:s[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:s[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:s[3].replace(/(?: *\| *)?\n$/,"").split("\n")};for(l=0;l<a.align.length;l++)/^ *-+: *$/.test(a.align[l])?a.align[l]="right":/^ *:-+: *$/.test(a.align[l])?a.align[l]="center":/^ *:-+ *$/.test(a.align[l])?a.align[l]="left":a.align[l]=null;for(l=0;l<a.cells.length;l++)a.cells[l]=a.cells[l].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(a);continue}if(n&&(s=this.rules.paragraph.exec(t))){t=t.substring(s[0].length),this.tokens.push({type:"paragraph",text:s[1].charAt(s[1].length-1)==="\n"?s[1].slice(0,-1):s[1]});continue}if(s=this.rules.text.exec(t)){t=t.substring(s[0].length),this.tokens.push({type:"text",text:s[0]});continue}if(t)throw new Error("Infinite loop on byte: "+t.charCodeAt(0))}return this.tokens};var n={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<([^ >]+(@|:\/)[^ >]+)>/,url:u,tag:/^<!--[\s\S]*?-->|^<\/?\w+(?:"[^"]*"|'[^']*'|[^'">])*?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\]]*\]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^\b_((?:__|[\s\S])+?)_\b|^\*((?:\*\*|[\s\S])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`])\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:u,text:/^[\s\S]+?(?=[\\<!\[_*`]| {2,}\n|$)/};n._inside=/(?:\[[^\]]*\]|[^\[\]]|\](?=[^\[]*\]))*/,n._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,n.link=o(n.link)("inside",n._inside)("href",n._href)(),n.reflink=o(n.reflink)("inside",n._inside)(),n.normal=a({},n),n.pedantic=a({},n.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),n.gfm=a({},n.normal,{escape:o(n.escape)("])","~|])")(),url:/^(https?:\/\/[^\s<]+[^<.,:;"')\]\s])/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:o(n.text)("]|","~]|")("|","|https?://|")()}),n.breaks=a({},n.gfm,{br:o(n.br)("{2,}","*")(),text:o(n.gfm.text)("{2,}","*")()}),r.rules=n,r.output=function(e,t,n){var i=new r(t,n);return i.output(e)},r.prototype.output=function(e){var t="",n,r,i,o;while(e){if(o=this.rules.escape.exec(e)){e=e.substring(o[0].length),t+=o[1];continue}if(o=this.rules.autolink.exec(e)){e=e.substring(o[0].length),o[2]==="@"?(r=o[1].charAt(6)===":"?this.mangle(o[1].substring(7)):this.mangle(o[1]),i=this.mangle("mailto:")+r):(r=s(o[1]),i=r),t+='<a href="'+i+'">'+r+"</a>";continue}if(o=this.rules.url.exec(e)){e=e.substring(o[0].length),r=s(o[1]),i=r,t+='<a href="'+i+'">'+r+"</a>";continue}if(o=this.rules.tag.exec(e)){e=e.substring(o[0].length),t+=this.options.sanitize?s(o[0]):o[0];continue}if(o=this.rules.link.exec(e)){e=e.substring(o[0].length),t+=this.outputLink(o,{href:o[2],title:o[3]});continue}if((o=this.rules.reflink.exec(e))||(o=this.rules.nolink.exec(e))){e=e.substring(o[0].length),n=(o[2]||o[1]).replace(/\s+/g," "),n=this.links[n.toLowerCase()];if(!n||!n.href){t+=o[0].charAt(0),e=o[0].substring(1)+e;continue}t+=this.outputLink(o,n);continue}if(o=this.rules.strong.exec(e)){e=e.substring(o[0].length),t+="<strong>"+this.output(o[2]||o[1])+"</strong>";continue}if(o=this.rules.em.exec(e)){e=e.substring(o[0].length),t+="<em>"+this.output(o[2]||o[1])+"</em>";continue}if(o=this.rules.code.exec(e)){e=e.substring(o[0].length),t+="<code>"+s(o[2],!0)+"</code>";continue}if(o=this.rules.br.exec(e)){e=e.substring(o[0].length),t+="<br>";continue}if(o=this.rules.del.exec(e)){e=e.substring(o[0].length),t+="<del>"+this.output(o[1])+"</del>";continue}if(o=this.rules.text.exec(e)){e=e.substring(o[0].length),t+=s(this.smartypants(o[0]));continue}if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0))}return t},r.prototype.outputLink=function(e,t){return e[0].charAt(0)!=="!"?'<a href="'+s(t.href)+'"'+(t.title?' title="'+s(t.title)+'"':"")+">"+this.output(e[1])+"</a>":'<img src="'+s(t.href)+'" alt="'+s(e[1])+'"'+(t.title?' title="'+s(t.title)+'"':"")+">"},r.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/--/g,"â€”").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1â€˜").replace(/'/g,"â€™").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1â€œ").replace(/"/g,"â€").replace(/\.{3}/g,"â€¦"):e},r.prototype.mangle=function(e){var t="",n=e.length,r=0,i;for(;r<n;r++)i=e.charCodeAt(r),Math.random()>.5&&(i="x"+i.toString(16)),t+="&#"+i+";";return t},i.parse=function(e,t){var n=new i(t);return n.parse(e)},i.prototype.parse=function(e){this.inline=new r(e.links,this.options),this.tokens=e.reverse();var t="";while(this.next())t+=this.tok();return t},i.prototype.next=function(){return this.token=this.tokens.pop()},i.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},i.prototype.parseText=function(){var e=this.token.text;while(this.peek().type==="text")e+="\n"+this.next().text;return this.inline.output(e)},i.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return"<hr>\n";case"heading":return"<h"+this.token.depth+' id="'+this.token.text.toLowerCase().replace(/[^\w]+/g,"-")+'">'+this.inline.output(this.token.text)+"</h"+this.token.depth+">\n";case"code":if(this.options.highlight){var e=this.options.highlight(this.token.text,this.token.lang);e!=null&&e!==this.token.text&&(this.token.escaped=!0,this.token.text=e)}return this.token.escaped||(this.token.text=s(this.token.text,!0)),"<pre><code"+(this.token.lang?' class="'+this.options.langPrefix+this.token.lang+'"':"")+">"+this.token.text+"</code></pre>\n";case"table":var t="",n,r,i,o,u;t+="<thead>\n<tr>\n";for(r=0;r<this.token.header.length;r++)n=this.inline.output(this.token.header[r]),t+="<th",this.token.align[r]&&(t+=' style="text-align:'+this.token.align[r]+'"'),t+=">"+n+"</th>\n";t+="</tr>\n</thead>\n",t+="<tbody>\n";for(r=0;r<this.token.cells.length;r++){i=this.token.cells[r],t+="<tr>\n";for(u=0;u<i.length;u++)o=this.inline.output(i[u]),t+="<td",this
.token.align[u]&&(t+=' style="text-align:'+this.token.align[u]+'"'),t+=">"+o+"</td>\n";t+="</tr>\n"}return t+="</tbody>\n","<table>\n"+t+"</table>\n";case"blockquote_start":var t="";while(this.next().type!=="blockquote_end")t+=this.tok();return"<blockquote>\n"+t+"</blockquote>\n";case"list_start":var a=this.token.ordered?"ol":"ul",t="";while(this.next().type!=="list_end")t+=this.tok();return"<"+a+">\n"+t+"</"+a+">\n";case"list_item_start":var t="";while(this.next().type!=="list_item_end")t+=this.token.type==="text"?this.parseText():this.tok();return"<li>"+t+"</li>\n";case"loose_item_start":var t="";while(this.next().type!=="list_item_end")t+=this.tok();return"<li>"+t+"</li>\n";case"html":return!this.token.pre&&!this.options.pedantic?this.inline.output(this.token.text):this.token.text;case"paragraph":return"<p>"+this.inline.output(this.token.text)+"</p>\n";case"text":return"<p>"+this.parseText()+"</p>\n"}},u.exec=u,f.options=f.setOptions=function(e){return a(f.defaults,e),f},f.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1},f.Parser=i,f.parser=i.parse,f.Lexer=t,f.lexer=t.lex,f.InlineLexer=r,f.inlineLexer=r.output,f.parse=f,typeof exports=="object"?module.exports=f:typeof define=="function"&&define.amd?define(function(){return f}):this.marked=f}.call(function(){return this||(typeof window!="undefined"?window:global)}()),function(e){function i(e){return n?e=e.replace("Ctrl","Cmd"):e=e.replace("Cmd","Ctrl"),e}function s(e,t){t=t||{};var s=document.createElement("a"),o=t.shortcut||r[e];return o&&(o=i(o),s.title=o,s.title=s.title.replace("Cmd","âŒ˜"),n&&(s.title=s.title.replace("Alt","âŒ¥"))),s.className=t.className||"icon-"+e,s}function o(){return el=document.createElement("i"),el.className="separator",el.innerHTML="|",el}function u(e,t){t=t||e.getCursor("start");var n=e.getTokenAt(t);if(!n.type)return{};var r=n.type.split(" "),i={},s,o;for(var u=0;u<r.length;u++)s=r[u],s==="strong"?i.bold=!0:s==="variable-2"?(o=e.getLine(t.line),/^\s*\d+\.\s/.test(o)?i["ordered-list"]=!0:i["unordered-list"]=!0):s==="atom"?i.quote=!0:s==="em"&&(i.italic=!0);return i}function a(e){var t=e.codemirror.getWrapperElement(),n=document,r=n.fullScreen||n.mozFullScreen||n.webkitFullScreen,i=function(){t.requestFullScreen?t.requestFullScreen():t.mozRequestFullScreen?t.mozRequestFullScreen():t.webkitRequestFullScreen&&t.webkitRequestFullScreen(Element.ALLOW_KEYBOARD_INPUT)},s=function(){n.cancelFullScreen?n.cancelFullScreen():n.mozCancelFullScreen?n.mozCancelFullScreen():n.webkitCancelFullScreen&&n.webkitCancelFullScreen()};r?s&&s():i()}function f(e){var t=e.codemirror,n=u(t),r,i="**",s="**",o=t.getCursor("start"),a=t.getCursor("end");n.bold?(r=t.getLine(o.line),i=r.slice(0,o.ch),s=r.slice(o.ch),i=i.replace(/^(.*)?(\*|\_){2}(\S+.*)?$/,"$1$3"),s=s.replace(/^(.*\S+)?(\*|\_){2}(\s+.*)?$/,"$1$3"),o.ch-=2,a.ch-=2,t.setLine(o.line,i+s)):(r=t.getSelection(),t.replaceSelection(i+r+s),o.ch+=2,a.ch+=2),t.setSelection(o,a),t.focus()}function l(e){var t=e.codemirror,n=u(t),r,i="*",s="*",o=t.getCursor("start"),a=t.getCursor("end");n.italic?(r=t.getLine(o.line),i=r.slice(0,o.ch),s=r.slice(o.ch),i=i.replace(/^(.*)?(\*|\_)(\S+.*)?$/,"$1$3"),s=s.replace(/^(.*\S+)?(\*|\_)(\s+.*)?$/,"$1$3"),o.ch-=1,a.ch-=1,t.setLine(o.line,i+s)):(r=t.getSelection(),t.replaceSelection(i+r+s),o.ch+=1,a.ch+=1),t.setSelection(o,a),t.focus()}function c(e){var t=e.codemirror;w(t,"quote")}function h(e){var t=e.codemirror;w(t,"unordered-list")}function p(e){var t=e.codemirror;w(t,"ordered-list")}function d(e){var t=e.codemirror,n=u(t);b(t,n.link,"[","](http://)")}function v(e){var t=e.codemirror,n=u(t);b(t,n.image,"![","](http://)")}function m(e){var t=e.codemirror;t.undo(),t.focus()}function g(e){var t=e.codemirror;t.redo(),t.focus()}function y(e){var t=e.toolbar.preview,n=e.constructor.markdown,r=e.codemirror,i=r.getWrapperElement(),s=i.lastChild;/editor-preview/.test(s.className)||(s=document.createElement("div"),s.className="editor-preview",i.appendChild(s)),/editor-preview-active/.test(s.className)?(s.className=s.className.replace(/\s*editor-preview-active\s*/g,""),t.className=t.className.replace(/\s*active\s*/g,"")):(setTimeout(function(){s.className+=" editor-preview-active"},1),t.className+=" active");var o=r.getValue();s.innerHTML=n(o)}function b(e,t,n,r){var i,s=e.getCursor("start"),o=e.getCursor("end");t?(i=e.getLine(s.line),n=i.slice(0,s.ch),r=i.slice(s.ch),e.setLine(s.line,n+r)):(i=e.getSelection(),e.replaceSelection(n+i+r),s.ch+=n.length,o.ch+=n.length),e.setSelection(s,o),e.focus()}function w(e,t){var n=u(e),r=e.getCursor("start"),i=e.getCursor("end"),s={quote:/^(\s*)\>\s+/,"unordered-list":/^(\s*)(\*|\-|\+)\s+/,"ordered-list":/^(\s*)\d+\.\s+/},o={quote:"> ","unordered-list":"* ","ordered-list":"1. "};for(var a=r.line;a<=i.line;a++)(function(r){var i=e.getLine(r);n[t]?i=i.replace(s[t],"$1"):i=o[t]+i,e.setLine(r,i)})(a);e.focus()}function E(e){var t=/[a-zA-Z0-9_\u0392-\u03c9]+|[\u4E00-\u9FFF\u3400-\u4dbf\uf900-\ufaff\u3040-\u309f\uac00-\ud7af]+/g,n=e.match(t),r=0;if(n===null)return r;for(var i=0;i<n.length;i++)n[i].charCodeAt(0)>=19968?r+=n[i].length:r+=1;return r}function x(e){e=e||{},e.element&&(this.element=e.element),e.toolbar=e.toolbar||x.toolbar,e.hasOwnProperty("status")||(e.status=["lines","words","cursor"]),this.options=e,this.element&&this.render()}var t=function(){"use strict";function S(e,n){if(!(this instanceof S))return new S(e,n);this.options=n=n||{};for(var r in Qn)!n.hasOwnProperty(r)&&Qn.hasOwnProperty(r)&&(n[r]=Qn[r]);P(n);var i=typeof n.value=="string"?0:n.value.first,s=this.display=x(e,i);s.wrapper.CodeMirror=this,M(this),n.autofocus&&!d&&jt(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,draggingText:!1,highlight:new Vi},A(this),n.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");var o=n.value;typeof o=="string"&&(o=new ri(n.value,n.mode)),At(this,ui)(this,o),t&&setTimeout(ns(Bt,this,!0),20),It(this);var u;try{u=document.activeElement==s.input}catch(a){}u||n.autofocus&&!d?setTimeout(ns(fn,this),20):ln(this),At(this,function(){for(var e in Kn)Kn.propertyIsEnumerable(e)&&Kn[e](this,n[e],Yn);for(var t=0;t<nr.length;++t)nr[t](this)})()}function x(e,t){var r={},s=r.input=us("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none; font-size: 4px;");return i?s.style.width="1000px":s.setAttribute("wrap","off"),p&&(s.style.border="1px solid black"),s.setAttribute("autocorrect","off"),s.setAttribute("autocapitalize","off"),s.setAttribute("spellcheck","false"),r.inputDiv=us("div",[s],null,"overflow: hidden; position: relative; width: 3px; height: 0px;"),r.scrollbarH=us("div",[us("div",null,null,"height: 1px")],"CodeMirror-hscrollbar"),r.scrollbarV=us("div",[us("div",null,null,"width: 1px")],"CodeMirror-vscrollbar"),r.scrollbarFiller=us("div",null,"CodeMirror-scrollbar-filler"),r.gutterFiller=us("div",null,"CodeMirror-gutter-filler"),r.lineDiv=us("div",null,"CodeMirror-code"),r.selectionDiv=us("div",null,null,"position: relative; z-index: 1"),r.cursor=us("div","Â ","CodeMirror-cursor"),r.otherCursor=us("div","Â ","CodeMirror-cursor CodeMirror-secondarycursor"),r.measure=us("div",null,"CodeMirror-measure"),r.lineSpace=us("div",[r.measure,r.selectionDiv,r.lineDiv,r.cursor,r.otherCursor],null,"position: relative; outline: none"),r.mover=us("div",[us("div",[r.lineSpace],"CodeMirror-lines")],null,"position: relative"),r.sizer=us("div",[r.mover],"CodeMirror-sizer"),r.heightForcer=us("div",null,null,"position: absolute; height: "+Wi+"px; width: 1px;"),r.gutters=us("div",null,"CodeMirror-gutters"),r.lineGutter=null,r.scroller=us("div",[r.sizer,r.heightForcer,r.gutters],"CodeMirror-scroll"),r.scroller.setAttribute("tabIndex","-1"),r.wrapper=us("div",[r.inputDiv,r.scrollbarH,r.scrollbarV,r.scrollbarFiller,r.gutterFiller,r.scroller],"CodeMirror"),n&&(r.gutters.style.zIndex=-1,r.scroller.style.paddingRight=0),e.appendChild?e.appendChild(r.wrapper):e(r.wrapper),p&&(s.style.width="0px"),i||(r.scroller.draggable=!0),f?(r.inputDiv.style.height="1px",r.inputDiv.style.position="absolute"):n&&(r.scrollbarH.style.minWidth=r.scrollbarV.style.minWidth="18px"),r.viewOffset=r.lastSizeC=0,r.showingFrom=r.showingTo=t,r.lineNumWidth=r.lineNumInnerWidth=r.lineNumChars=null,r.prevInput="",r.alignWidgets=!1,r.pollingFast=!1,r.poll=new Vi,r.cachedCharWidth=r.cachedTextHeight=null,r.measureLineCache=[],r.measureLineCachePos=0,r.inaccurateSelection=!1,r.maxLine=null,r.maxLineLength=0,r.maxLineChanged=!1,r.wheelDX=r.wheelDY=r.wheelStartX=r.wheelStartY=null,r}function T(e){e.doc.mode=S.getMode(e.options,e.doc.modeOption),e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.frontier=e.doc.first,et(e,100),e.state.modeGen++,e.curOp&&_t(e)}function N(e){e.options.lineWrapping?(e.display.wrapper.className+=" CodeMirror-wrap",e.display.sizer.style.minWidth=""):(e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-wrap",""),D(e)),k(e),_t(e),pt(e),setTimeout(function(){H(e)},100)}function C(e){var t=Tt(e.display),n=e.options.lineWrapping,r=n&&Math.max(5,e.display.scroller.clientWidth/Nt(e.display)-3);return function(i){return Ar(e.doc,i)?0:n?(Math.ceil(i.text.length/r)||1)*t:t}}function k(e){var t=e.doc,n=C(e);t.iter(function(e){var t=n(e);t!=e.height&&ci(e,t)})}function L(e){var t=ur[e.options.keyMap],n=t.style;e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(n?" cm-keymap-"+n:""),e.state.disableInput=t.disableInput}function A(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),pt(e)}function O(e){M(e),_t(e),setTimeout(function(){j(e)},20)}function M(e){var t=e.display.gutters,n=e.options.gutters;as(t);for(var r=0;r<n.length;++r){var i=n[r],s=t.appendChild(us("div",null,"CodeMirror-gutter "+i));i=="CodeMirror-linenumbers"&&(e.display.lineGutter=s,s.style.width=(e.display.lineNumWidth||1)+"px")}t.style.display=r?"":"none"}function _(e,t){if(t.height==0)return 0;var n=t.text.length,r,i=t;while(r=Cr(i)){var s=r.find();i=ai(e,s.from.line),n+=s.from.ch-s.to.ch}i=t;while(r=kr(i)){var s=r.find();n-=i.text.length-s.from.ch,i=ai(e,s.to.line),n+=i.text.length-s.to.ch}return n}function D(e){var t=e.display,n=e.doc;t.maxLine=ai(n,n.first),t.maxLineLength=_(n,t.maxLine),t.maxLineChanged=!0,n.iter(function(e){var r=_(n,e);r>t.maxLineLength&&(t.maxLineLength=r,t.maxLine=e)})}function P(e){var t=!1;for(var n=0;n<e.gutters.length;++n)e.gutters[n]=="CodeMirror-linenumbers"&&(e.lineNumbers?t=!0:e.gutters.splice(n--,1));!t&&e.lineNumbers&&e.gutters.push("CodeMirror-linenumbers")}function H(e){var t=e.display,n=e.doc.height,r=n+st(t);t.sizer.style.minHeight=t.heightForcer.style.top=r+"px",t.gutters.style.height=Math.max(r,t.scroller.clientHeight-Wi)+"px";var i=Math.max(r,t.scroller.scrollHeight),s=t.scroller.scrollWidth>t.scroller.clientWidth+1,o=i>t.scroller.clientHeight+1;o?(t.scrollbarV.style.display="block",t.scrollbarV.style.bottom=s?vs(t.measure)+"px":"0",t.scrollbarV.firstChild.style.height=i-t.scroller.clientHeight+t.scrollbarV.clientHeight+"px"):t.scrollbarV.style.display="",s?(t.scrollbarH.style.display="block",t.scrollbarH.style.right=o?vs(t.measure)+"px":"0",t.scrollbarH.firstChild.style.width=t.scroller.scrollWidth-t.scroller.clientWidth+t.scrollbarH.clientWidth+"px"):t.scrollbarH.style.display="",s&&o?(t.scrollbarFiller.style.display="block",t.scrollbarFiller.style.height=t.scrollbarFiller.style.width=vs(t.measure)+"px"):t.scrollbarFiller.style.display="",s&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(t.gutterFiller.style.display="block",t.gutterFiller.style.height=vs(t.measure)+"px",t.gutterFiller.style.width=t.gutters.offsetWidth+"px"):t.gutterFiller.style.display="",l&&vs(t.measure)===0&&(t.scrollbarV.style.minWidth=t.scrollbarH.style.minHeight=c?"18px":"12px")}function B(e,t,n){var r=e.scroller.scrollTop,i=e.wrapper.clientHeight;typeof n=="number"?r=n:n&&(r=n.top,i=n.bottom-n.top),r=Math.floor(r-it(e));var s=Math.ceil(r+i);return{from:pi(t,r),to:pi(t,s)}}function j(e){var t=e.display;if(!t.alignWidgets&&(!t.gutters.firstChild||!e.options.fixedGutter))return;var n=q(t)-t.scroller.scrollLeft+e.doc.scrollLeft,r=t.gutters.offsetWidth,i=n+"px";for(var s=t.lineDiv.firstChild;s;s=s.nextSibling)if(s.alignable)for(var o=0,u=s.alignable;o<u.length;++o)u[o].style.left=i;e.options.fixedGutter&&(t.gutters.style.left=n+r+"px")}function F(e){if(!e.options.lineNumbers)return!1;var t=e.doc,n=I(e.options,t.first+t.size-1),r=e.display;if(n.length!=r.lineNumChars){var i=r.measure.appendChild(us("div",[us("div",n)],"CodeMirror-linenumber CodeMirror-gutter-elt")),s=i.firstChild.offsetWidth,o=i.offsetWidth-s;return r.lineGutter.style.width="",r.lineNumInnerWidth=Math.max(s,r.lineGutter.offsetWidth-o),r.lineNumWidth=r.lineNumInnerWidth+o,r.lineNumChars=r.lineNumInnerWidth?n.length:-1,r.lineGutter.style.width=r.lineNumWidth+"px",!0}return!1}function I(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function q(e){return cs(e.scroller).left-cs(e.sizer).left}function R(e,t,n,r){var i=e.display.showingFrom,s=e.display.showingTo,o,u=B(e.display,e.doc,n);for(;;){if(!U(e,t,u,r))break;r=!1,o=!0,Q(e),H(e),n&&(n=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,typeof n=="number"?n:n.top)),u=B(e.display,e.doc,n);if(u.from>=e.display.showingFrom&&u.to<=e.display.showingTo)break;t=[]}return o&&(Ii(e,"update",e),(e.display.showingFrom!=i||e.display.showingTo!=s)&&Ii(e,"viewportChange",e,e.display.showingFrom,e.display.showingTo)),o}function U(e,t,n,r){var i=e.display,s=e.doc;if(!i.wrapper.clientWidth){i.showingFrom=i.showingTo=s.first,i.viewOffset=0;return}if(!r&&t.length==0&&n.from>i.showingFrom&&n.to<i.showingTo)return;F(e)&&(t=[{from:s.first,to:s.first+s.size}]);var o=i.sizer.style.marginLeft=i.gutters.offsetWidth+"px";i.scrollbarH.style.left=e.options.fixedGutter?o:"0";var u=Infinity;if(e.options.lineNumbers)for(var a=0;a<t.length;++a)if(t[a].diff){u=t[a].from;break}var f=s.first+s.size,l=Math.max(n.from-e.options.viewportMargin,s.first),c=Math.min(f,n.to+e.options.viewportMargin);i.showingFrom<l&&l-i.showingFrom<20&&(l=Math.max(s.first,i.showingFrom)),i.showingTo>c&&i.showingTo-c<20&&(c=Math.min(f,i.showingTo));if(E){l=hi(Lr(s,ai(s,l)));while(c<f&&Ar(s,ai(s,c)))++c}var h=[{from:Math.max(i.showingFrom,s.first),to:Math.min(i.showingTo,f)}];h[0].from>=h[0].to?h=[]:h=X(h,t);if(E)for(var a=0;a<h.length;++a){var p=h[a],d;while(d=kr(ai(s,p.to-1))){var v=d.find().from.line;if(!(v>p.from)){h.splice(a--,1);break}p.to=v}}var m=0;for(var a=0;a<h.length;++a){var p=h[a];p.from<l&&(p.from=l),p.to>c&&(p.to=c),p.from>=p.to?h.splice(a--,1):m+=p.to-p.from}if(!r&&m==c-l&&l==i.showingFrom&&c==i.showingTo){W(e);return}h.sort(function(e,t){return e.from-t.from});try{var g=document.activeElement}catch(y){}m<(c-l)*.7&&(i.lineDiv.style.display="none"),$(e,l,c,h,u),i.lineDiv.style.display="",g&&document.activeElement!=g&&g.offsetHeight&&g.focus();var b=l!=i.showingFrom||c!=i.showingTo||i.lastSizeC!=i.wrapper.clientHeight;return b&&(i.lastSizeC=i.wrapper.clientHeight,et(e,400)),i.showingFrom=l,i.showingTo=c,z(e),W(e),!0}function z(e){var t=e.display,r=t.lineDiv.offsetTop;for(var i=t.lineDiv.firstChild,s;i;i=i.nextSibling)if(i.lineObj){if(n){var o=i.offsetTop+i.offsetHeight;s=o-r,r=o}else{var u=cs(i);s=u.bottom-u.top}var a=i.lineObj.height-s;s<2&&(s=Tt(t));if(a>.001||a<-0.001){ci(i.lineObj,s);var f=i.lineObj.widgets;if(f)for(var l=0;l<f.length;++l)f[l].height=f[l].node.offsetHeight}}}function W(e){var t=e.display.viewOffset=di(e,ai(e.doc,e.display.showingFrom));e.display.mover.style.top=t+"px"}function X(e,t){for(var n=0,r=t.length||0;n<r;++n){var i=t[n],s=[],o=i.diff||0;for(var u=0,a=e.length;u<a;++u){var f=e[u];i.to<=f.from&&i.diff?s.push({from:f.from+o,to:f.to+o}):i.to<=f.from||i.from>=f.to?s.push(f):(i.from>f.from&&s.push({from:f.from,to:i.from}),i.to<f.to&&s.push({from:i.to+o,to:f.to+o}))}e=s}return e}function V(e){var t=e.display,n={},r={};for(var i=t.gutters.firstChild,s=0;i;i=i.nextSibling,++s)n[e.options.gutters[s]]=i.offsetLeft,r[e.options.gutters[s]]=i.offsetWidth;return{fixedPos:q(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:n,gutterWidth:r,wrapperWidth:t.wrapper.clientWidth}}function $(e,t,n,r,s){function c(t){var n=t.nextSibling;return i&&v&&e.display.currentWheelTarget==t?(t.style.display="none",t.lineObj=null):t.parentNode.removeChild(t),n}var o=V(e),u=e.display,a=e.options.lineNumbers;!r.length&&(!i||!e.display.currentWheelTarget)&&as(u.lineDiv);var f=u.lineDiv,l=f.firstChild,h=r.shift(),p=t;e.doc.iter(t,n,function(t){h&&h.to==p&&(h=r.shift());if(Ar(e.doc,t)){t.height!=0&&ci(t,0);if(t.widgets&&l.previousSibling)for(var n=0;n<t.widgets.length;++n){var i=t.widgets[n];if(i.showIfHidden){var u=l.previousSibling;if(/pre/i.test(u.nodeName)){var d=us("div",null,null,"position: relative");u.parentNode.replaceChild(d,u),d.appendChild(u),u=d}var v=u.appendChild(us("div",[i.node],"CodeMirror-linewidget"));i.handleMouseEvents||(v.ignoreEvents=!0),K(i,v,u,o)}}}else if(h&&h.from<=p&&h.to>p){while(l.lineObj!=t)l=c(l);a&&s<=p&&l.lineNumber&&ls(l.lineNumber,I(e.options,p)),l=l.nextSibling}else{if(t.widgets)for(var m=0,g=l,y;g&&m<20;++m,g=g.nextSibling)if(g.lineObj==t&&/div/i.test(g.nodeName)){y=g;break}var b=J(e,t,p,o,y);if(b!=y)f.insertBefore(b,l);else{while(l!=y)l=c(l);l=l.nextSibling}b.lineObj=t}++p});while(l)l=c(l)}function J(e,t,r,i,s){var o=Vr(e,t),u=t.gutterMarkers,a=e.display,f;if(!e.options.lineNumbers&&!u&&!t.bgClass&&!t.wrapClass&&!t.widgets)return o;if(s){s.alignable=null;var l=!0,c=0,h=null;for(var p=s.firstChild,d;p;p=d){d=p.nextSibling;if(!/\bCodeMirror-linewidget\b/.test(p.className))s.removeChild(p);else{for(var v=0;v<t.widgets.length;++v){var m=t.widgets[v];if(m.node==p.firstChild){!m.above&&!h&&(h=p),K(m,p,s,i),++c;break}}if(v==t.widgets.length){l=!1;break}}}s.insertBefore(o,h),l&&c==t.widgets.length&&(f=s,s.className=t.wrapClass||"")}f||(f=us("div",null,t.wrapClass,"position: relative"),f.appendChild(o)),t.bgClass&&f.insertBefore(us("div",null,t.bgClass+" CodeMirror-linebackground"),f.firstChild);if(e.options.lineNumbers||u){var g=f.insertBefore(us("div",null,null,"position: absolute; left: "+(e.options.fixedGutter?i.fixedPos:-i.gutterTotalWidth)+"px"),f.firstChild);e.options.fixedGutter&&(f.alignable||(f.alignable=[])).push(g),e.options.lineNumbers&&(!u||!u["CodeMirror-linenumbers"])&&(f.lineNumber=g.appendChild(us("div",I(e.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+i.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+a.lineNumInnerWidth+"px")));if(u)for(var y=0;y<e.options.gutters.length;++y){var b=e.options.gutters[y],w=u.hasOwnProperty(b)&&u[b];w&&g.appendChild(us("div",[w],"CodeMirror-gutter-elt","left: "+i.gutterLeft[b]+"px; width: "+i.gutterWidth[b]+"px"))}}n&&(f.style.zIndex=2);if(t.widgets&&f!=s)for(var v=0,E=t.widgets;v<E.length;++v){var m=E[v],S=us("div",[m.node],"CodeMirror-linewidget");m.handleMouseEvents||(S.ignoreEvents=!0),K(m,S,f,i),m.above?f.insertBefore(S,e.options.lineNumbers&&t.height!=0?g:o):f.appendChild(S),Ii(m,"redraw")}return f}function K(e,t,n,r){if(e.noHScroll){(n.alignable||(n.alignable=[])).push(t);var i=r.wrapperWidth;t.style.left=r.fixedPos+"px",e.coverGutter||(i-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px"),t.style.width=i+"px"}e.coverGutter&&(t.style.zIndex=5,t.style.position="relative",e.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function Q(e){var t=e.display,n=Nn(e.doc.sel.from,e.doc.sel.to);n||e.options.showCursorWhenSelecting?G(e):t.cursor.style.display=t.otherCursor.style.display="none",n?t.selectionDiv.style.display="none":Y(e);if(e.options.moveInputWithCursor){var r=bt(e,e.doc.sel.head,"div"),i=cs(t.wrapper),s=cs(t.lineDiv);t.inputDiv.style.top=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+s.top-i.top))+"px",t.inputDiv.style.left=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+s.left-i.left))+"px"}}function G(e){var t=e.display,n=bt(e,e.doc.sel.head,"div");t.cursor.style.left=n.left+"px",t.cursor.style.top=n.top+"px",t.cursor.style.height=Math.max(0,n.bottom-n.top)*e.options.cursorHeight+"px",t.cursor.style.display="",n.other?(t.otherCursor.style.display="",t.otherCursor.style.left=n.other.left+"px",t.otherCursor.style.top=n.other.top+"px",t.otherCursor.style.height=(n.other.bottom-n.other.top)*.85+"px"):t.otherCursor.style.display="none"}function Y(e){function u(e,t,n,r){t<0&&(t=0),i.appendChild(us("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px; top: "+t+"px; width: "+(n==null?s-e:n)+"px; height: "+(r-t)+"px"))}function a(t,r,i){function h(n,r){return yt(e,Tn(t,n),"div",a,r)}var a=ai(n,t),f=a.text.length,l,c;return Ss(vi(a),r||0,i==null?f:i,function(e,t,n){var a=h(e,"left"),p,d,v;if(e==t)p=a,d=v=a.left;else{p=h(t-1,"right");if(n=="rtl"){var m=a;a=p,p=m}d=a.left,v=p.right}r==null&&e==0&&(d=o),p.top-a.top>3&&(u(d,a.top,null,a.bottom),d=o,a.bottom<p.top&&u(d,a.bottom,null,p.top)),i==null&&t==f&&(v=s);if(!l||a.top<l.top||a.top==l.top&&a.left<l.left)l=a;if(!c||p.bottom>c.bottom||p.bottom==c.bottom&&p.right>c.right)c=p;d<o+1&&(d=o),u(d,p.top,v-d,p.bottom)}),{start:l,end:c}}var t=e.display,n=e.doc,r=e.doc.sel,i=document.createDocumentFragment(),s=t.lineSpace.offsetWidth,o=ot(e.display);if(r.from.line==r.to.line)a(r.from.line,r.from.ch,r.to.ch);else{var f=ai(n,r.from.line),l=ai(n,r.to.line),c=Lr(n,f)==Lr(n,l),h=a(r.from.line,r.from.ch,c?f.text.length:null).end,p=a(r.to.line,c?0:null,r.to.ch).start;c&&(h.top<p.top-2?(u(h.right,h.top,null,h.bottom),u(o,p.top,p.left,p.bottom)):u(h.right,h.top,p.left-h.right,h.bottom)),h.bottom<p.top&&u(o,h.bottom,null,p.top)}fs(t.selectionDiv,i),t.selectionDiv.style.display=""}function Z(e){if(!e.state.focused)return;var t=e.display;clearInterval(t.blinker);var n=!0;t.cursor.style.visibility=t.otherCursor.style.visibility="",t.blinker=setInterval(function(){t.cursor.style.visibility=t.otherCursor.style.visibility=(n=!n)?"":"hidden"},e.options.cursorBlinkRate)}function et(e,t){e.doc.mode.startState&&e.doc.frontier<e.display.showingTo&&e.state.highlight.set(t,ns(tt,e))}function tt(e){var t=e.doc;t.frontier<t.first&&(t.frontier=t.first);if(t.frontier>=e.display.showingTo)return;var n=+(new Date)+e.options.workTime,r=ir(t.mode,rt(e,t.frontier)),i=[],s;t.iter(t.frontier,Math.min(t.first+t.size,e.display.showingTo+500),function(o){if(t.frontier>=e.display.showingFrom){var u=o.styles;o.styles=Rr(e,o,r);var a=!u||u.length!=o.styles.length;for(var f=0;!a&&f<u.length;++f)a=u[f]!=o.styles[f];a&&(s&&s.end==t.frontier?s.end++:i.push(s={start:t.frontier,end:t.frontier+1})),o.stateAfter=ir(t.mode,r)}else zr(e,o,r),o.stateAfter=t.frontier%5==0?ir(t.mode,r):null;++t.frontier;if(+(new Date)>n)return et(e,e.options.workDelay),!0}),i.length&&At(e,function(){for(var e=0;e<i.length;++e)_t(this,i[e].start,i[e].end)})()}function nt(e,t,n){var r,i,s=e.doc;for(var o=t,u=t-100;o>u;--o){if(o<=s.first)return s.first;var a=ai(s,o-1);if(a.stateAfter&&(!n||o<=s.frontier))return o;var f=$i(a.text,null,e.options.tabSize);if(i==null||r>f)i=o-1,r=f}return i}function rt(e,t,n){var r=e.doc,i=e.display;if(!r.mode.startState)return!0;var s=nt(e,t,n),o=s>r.first&&ai(r,s-1).stateAfter;return o?o=ir(r.mode,o):o=sr(r.mode),r.iter(s,t,function(n){zr(e,n,o);var u=s==t-1||s%5==0||s>=i.showingFrom&&s<i.showingTo;n.stateAfter=u?ir(r.mode,o):null,++s}),o}function it(e){return e.lineSpace.offsetTop}function st(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function ot(e){var t=fs(e.measure,us("pre",null,null,"text-align: left")).appendChild(us("span","x"));return t.offsetLeft}function ut(e,t,n,r,i){var s=-1;r=r||lt(e,t);for(var o=n;;o+=s){var u=r[o];if(u)break;s<0&&o==0&&(s=1)}return i=o>n?"left":o<n?"right":i,i=="left"&&u.leftSide?u=u.leftSide:i=="right"&&u.rightSide&&(u=u.rightSide),{left:o<n?u.right:u.left,right:o>n?u.left:u.right,top:u.top,bottom:u.bottom}}function at(e,t){var n=e.display.measureLineCache;for(var r=0;r<n.length;++r){var i=n[r];if(i.text==t.text&&i.markedSpans==t.markedSpans&&e.display.scroller.clientWidth==i.width&&i.classes==t.textClass+"|"+t.bgClass+"|"+t.wrapClass)return i}}function ft(e,t){var n=at(e,t);n&&(n.text=n.measure=n.markedSpans=null)}function lt(e,t){var n=at(e,t);if(n)return n.measure;var r=ct(e,t),i=e.display.measureLineCache,s={text:t.text,width:e.display.scroller.clientWidth,markedSpans:t.markedSpans,measure:r,classes:t.textClass+"|"+t.bgClass+"|"+t.wrapClass};return i.length==16?i[++e.display.measureLineCachePos%16]=s:i.push(s),r}function ct(e,i){function b(e){var t=e.top-v.top,n=e.bottom-v.top;n>y&&(n=y),t<0&&(t=0);for(var r=m.length-2;r>=0;r-=2){var i=m[r],s=m[r+1];if(i>n||s<t)continue;if(i<=t&&s>=n||t<=i&&n>=s||Math.min(n,s)-Math.max(t,i)>=n-t>>1){m[r]=Math.min(t,i),m[r+1]=Math.max(n,s);break}}return r<0&&(r=m.length,m.push(t,n)),{left:e.left-v.left,right:e.right-v.left,top:r,bottom:null}}function w(e){e.bottom=m[e.top+1],e.top=m[e.top]}var s=e.display,o=ts(i.text.length),u=Vr(e,i,o,!0);if(t&&!n&&!e.options.lineWrapping&&u.childNodes.length>100){var a=document.createDocumentFragment(),f=10,l=u.childNodes.length;for(var c=0,h=Math.ceil(l/f);c<h;++c){var p=us("div",null,null,"display: inline-block");for(var d=0;d<f&&l;++d)p.appendChild(u.firstChild),--l;a.appendChild(p)}u.appendChild(a)}fs(s.measure,u);var v=cs(s.lineDiv),m=[],g=ts(i.text.length),y=u.offsetHeight;r&&s.measure.first!=u&&fs(s.measure,u);for(var c=0,E;c<o.length;++c)if(E=o[c]){var S=E,x=null;if(/\bCodeMirror-widget\b/.test(E.className)&&E.getClientRects){E.firstChild.nodeType==1&&(S=E.firstChild);var T=S.getClientRects();T.length>1&&(x=g[c]=b(T[0]),x.rightSide=b(T[T.length-1]))}x||(x=g[c]=b(cs(S))),E.measureRight&&(x.right=cs(E.measureRight).left),E.leftSide&&(x.leftSide=b(cs(E.leftSide)))}for(var c=0,E;c<g.length;++c)if(E=g[c])w(E),E.leftSide&&w(E.leftSide),E.rightSide&&w(E.rightSide);return g}function ht(e,t){var n=!1;if(t.markedSpans)for(var r=0;r<t.markedSpans;++r){var i=t.markedSpans[r];i.collapsed&&(i.to==null||i.to==t.text.length)&&(n=!0)}var s=!n&&at(e,t);if(s)return ut(e,t,t.text.length,s.measure,"right").right;var o=Vr(e,t,null,!0),u=o.appendChild(gs(e.display.measure));return fs(e.display.measure,o),cs(u).right-cs(e.display.lineDiv).left}function pt(e){e.display.measureLineCache.length=e.display.measureLineCachePos=0,e.display.cachedCharWidth=e.display.cachedTextHeight=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function dt(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function vt(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function mt(e,t,n,r){if(t.widgets)for(var i=0;i<t.widgets.length;++i)if(t.widgets[i].above){var s=Hr(t.widgets[i]);n.top+=s,n.bottom+=s}if(r=="line")return n;r||(r="local");var o=di(e,t);r=="local"?o+=it(e.display):o-=e.display.viewOffset;if(r=="page"||r=="window"){var u=cs(e.display.lineSpace);o+=u.top+(r=="window"?0:vt());var a=u.left+(r=="window"?0:dt());n.left+=a,n.right+=a}return n.top+=o,n.bottom+=o,n}function gt(e,t,n){if(n=="div")return t;var r=t.left,i=t.top;if(n=="page")r-=dt(),i-=vt();else if(n=="local"||!n){var s=cs(e.display.sizer);r+=s.left,i+=s.top}var o=cs(e.display.lineSpace);return{left:r-o.left,top:i-o.top}}function yt(e,t,n,r,i){return r||(r=ai(e.doc,t.line)),mt(e,r,ut(e,r,t.ch,null,i),n)}function bt(e,t,n,r,i){function s(t,s){var o=ut(e,r,t,i,s?"right":"left");return s?o.left=o.right:o.right=o.left,mt(e,r,o,n)}function o(e,t){var n=u[t],r=n.level%2;return e==xs(n)&&t&&n.level<u[t-1].level?(n=u[--t],e=Ts(n)-(n.level%2?0:1),r=!0):e==Ts(n)&&t<u.length-1&&n.level<u[t+1].level&&(n=u[++t],e=xs(n)-n.level%2,r=!1),r&&e==n.to&&e>n.from?s(e-1):s(e,r)}r=r||ai(e.doc,t.line),i||(i=lt(e,r));var u=vi(r),a=t.ch;if(!u)return s(a);var f=Ms(u,a),l=o(a,f);return Os!=null&&(l.other=o(a,Os)),l}function wt(e,t,n,r){var i=new Tn(e,t);return i.xRel=r,n&&(i.outside=!0),i}function Et(e,t,n){var r=e.doc;n+=e.display.viewOffset;if(n<0)return wt(r.first,0,!0,-1);var i=pi(r,n),s=r.first+r.size-1;if(i>s)return wt(r.first+r.size-1,ai(r,s).text.length,!0,1);t<0&&(t=0);for(;;){var o=ai(r,i),u=St(e,o,i,t,n),a=kr(o),f=a&&a.find();if(!a||!(u.ch>f.from.ch||u.ch==f.from.ch&&u.xRel>0))return u;i=f.to.line}}function St(e,t,n,r,i){function f(r){var i=bt(e,Tn(n,r),"line",t,a);return o=!0,s>i.bottom?i.left-u:s<i.top?i.left+u:(o=!1,i.left)}var s=i-di(e,t),o=!1,u=2*e.display.wrapper.clientWidth,a=lt(e,t),l=vi(t),c=t.text.length,h=Ns(t),p=Cs(t),d=f(h),v=o,m=f(p),g=o;if(r>m)return wt(n,p,g,1);for(;;){if(l?p==h||p==Ds(t,h,1):p-h<=1){var y=r<d||r-d<=m-r?h:p,b=r-(y==h?d:m);while(os.test(t.text.charAt(y)))++y;var w=wt(n,y,y==h?v:g,b<0?-1:b?1:0);return w}var E=Math.ceil(c/2),S=h+E;if(l){S=h;for(var x=0;x<E;++x)S=Ds(t,S,1)}var T=f(S);if(T>r){p=S,m=T;if(g=o)m+=1e3;c=E}else h=S,d=T,v=o,c-=E}}function Tt(e){if(e.cachedTextHeight!=null)return e.cachedTextHeight;if(xt==null){xt=us("pre");for(var t=0;t<49;++t)xt.appendChild(document.createTextNode("x")),xt.appendChild(us("br"));xt.appendChild(document.createTextNode("x"))}fs(e.measure,xt);var n=xt.offsetHeight/50;return n>3&&(e.cachedTextHeight=n),as(e.measure),n||1}function Nt(e){if(e.cachedCharWidth!=null)return e.cachedCharWidth;var t=us("span","x"),n=us("pre",[t]);fs(e.measure,n);var r=t.offsetWidth;return r>2&&(e.cachedCharWidth=r),r||10}function kt(e){e.curOp={changes:[],forceUpdate:!1,updateInput:null,userSelChange:null,textChanged:null,selectionChanged:!1,cursorActivity:!1,updateMaxLine:!1,updateScrollPos:!1,id:++Ct},Fi++||(ji=[])}function Lt(e){var t=e.curOp,n=e.doc,r=e.display;e.curOp=null,t.updateMaxLine&&D(e);if(r.maxLineChanged&&!e.options.lineWrapping&&r.maxLine){var i=ht(e,r.maxLine);r.sizer.style.minWidth=Math.max(0,i+3+Wi)+"px",r.maxLineChanged=!1;var s=Math.max(0,r.sizer.offsetLeft+r.sizer.offsetWidth-r.scroller.clientWidth);s<n.scrollLeft&&!t.updateScrollPos&&Qt(e,Math.min(r.scroller.scrollLeft,s),!0)}var o,u;if(t.updateScrollPos)o=t.updateScrollPos;else if(t.selectionChanged&&r.scroller.clientHeight){var a=bt(e,n.sel.head);o=qn(e,a.left,a.top,a.left,a.bottom)}if(t.changes.length||t.forceUpdate||o&&o.scrollTop!=null)u=R(e,t.changes,o&&o.scrollTop,t.forceUpdate),e.display.scroller.offsetHeight&&(e.doc.scrollTop=e.display.scroller.scrollTop);!u&&t.selectionChanged&&Q(e),t.updateScrollPos?(r.scroller.scrollTop=r.scrollbarV.scrollTop=n.scrollTop=o.scrollTop,r.scroller.scrollLeft=r.scrollbarH.scrollLeft=n.scrollLeft=o.scrollLeft,j(e),t.scrollToPos&&Fn(e,An(e.doc,t.scrollToPos),t.scrollToPosMargin)):o&&jn(e),t.selectionChanged&&Z(e),e.state.focused&&t.updateInput&&Bt(e,t.userSelChange);var f=t.maybeHiddenMarkers,l=t.maybeUnhiddenMarkers;if(f)for(var c=0;c<f.length;++c)f[c].lines.length||Bi(f[c],"hide");if(l)for(var c=0;c<l.length;++c)l[c].lines.length&&Bi(l[c],"unhide");var h;--Fi||(h=ji,ji=null),t.textChanged&&Bi(e,"change",e,t.textChanged),t.cursorActivity&&Bi(e,"cursorActivity",e);if(h)for(var c=0;c<h.length;++c)h[c]()}function At(e,t){return function(){var n=e||this,r=!n.curOp;r&&kt(n);try{var i=t.apply(n,arguments)}finally{r&&Lt(n)}return i}}function Ot(e){return function(){var t=this.cm&&!this.cm.curOp,n;t&&kt(this.cm);try{n=e.apply(this,arguments)}finally{t&&Lt(this.cm)}return n}}function Mt(e,t){var n=!e.curOp,r;n&&kt(e);try{r=t()}finally{n&&Lt(e)}return r}function _t(e,t,n,r){t==null&&(t=e.doc.first),n==null&&(n=e.doc.first+e.doc.size),e.curOp.changes.push({from:t,to:n,diff:r})}function Dt(e){if(e.display.pollingFast)return;e.display.poll.set(e.options.pollInterval,function(){Ht(e),e.state.focused&&Dt(e)})}function Pt(e){function n(){var r=Ht(e);!r&&!t?(t=!0,e.display.poll.set(60,n)):(e.display.pollingFast=!1,Dt(e))}var t=!1;e.display.pollingFast=!0,e.display.poll.set(20,n)}function Ht(e){var n=e.display.input,i=e.display.prevInput,s=e.doc,o=s.sel;if(!e.state.focused||bs(n)||Ft(e)||e.state.disableInput)return!1;var u=n.value;if(u==i&&Nn(o.from,o.to))return!1;if(t&&!r&&e.display.inputHasSelection===u)return Bt(e,!0),!1;var a=!e.curOp;a&&kt(e),o.shift=!1;var f=0,l=Math.min(i.length,u.length);while(f<l&&i.charCodeAt(f)==u.charCodeAt(f))++f;var c=o.from,h=o.to;f<i.length?c=Tn(c.line,c.ch-(i.length-f)):e.state.overwrite&&Nn(c,h)&&!e.state.pasteIncoming&&(h=Tn(h.line,Math.min(ai(s,h.line).text.length,h.ch+(u.length-f))));var p=e.curOp.updateInput,d={from:c,to:h,text:ys(u.slice(f)),origin:e.state.pasteIncoming?"paste":"+input"};return gn(e.doc,d,"end"),e.curOp.updateInput=p,Ii(e,"inputRead",e,d),u.length>1e3||u.indexOf("\n")>-1?n.value=e.display.prevInput="":e.display.prevInput=u,a&&Lt(e),e.state.pasteIncoming=!1,!0}function Bt(e,n){var i,s,o=e.doc;if(!
Nn(o.sel.from,o.sel.to)){e.display.prevInput="",i=ws&&(o.sel.to.line-o.sel.from.line>100||(s=e.getSelection()).length>1e3);var u=i?"-":s||e.getSelection();e.display.input.value=u,e.state.focused&&Gi(e.display.input),t&&!r&&(e.display.inputHasSelection=u)}else n&&(e.display.prevInput=e.display.input.value="",t&&!r&&(e.display.inputHasSelection=null));e.display.inaccurateSelection=i}function jt(e){e.options.readOnly!="nocursor"&&(!d||document.activeElement!=e.display.input)&&e.display.input.focus()}function Ft(e){return e.options.readOnly||e.doc.cantEdit}function It(e){function r(){e.state.focused&&setTimeout(ns(jt,e),0)}function s(){i==null&&(i=setTimeout(function(){i=null,n.cachedCharWidth=n.cachedTextHeight=ds=null,pt(e),Mt(e,ns(_t,e))},100))}function o(){for(var e=n.wrapper.parentNode;e&&e!=document.body;e=e.parentNode);e?setTimeout(o,5e3):Hi(window,"resize",s)}function u(t){if(qi(e,t)||e.options.onDragEvent&&e.options.onDragEvent(e,ki(t)))return;Mi(t)}function a(){n.inaccurateSelection&&(n.prevInput="",n.inaccurateSelection=!1,n.input.value=e.getSelection(),Gi(n.input))}var n=e.display;Pi(n.scroller,"mousedown",At(e,Wt)),t?Pi(n.scroller,"dblclick",At(e,function(t){if(qi(e,t))return;var n=Rt(e,t);if(!n||Xt(e,t)||qt(e.display,t))return;Li(t);var r=$n(ai(e.doc,n.line).text,n);_n(e.doc,r.from,r.to)})):Pi(n.scroller,"dblclick",function(t){qi(e,t)||Li(t)}),Pi(n.lineSpace,"selectstart",function(e){qt(n,e)||Li(e)}),b||Pi(n.scroller,"contextmenu",function(t){hn(e,t)}),Pi(n.scroller,"scroll",function(){n.scroller.clientHeight&&(Kt(e,n.scroller.scrollTop),Qt(e,n.scroller.scrollLeft,!0),Bi(e,"scroll",e))}),Pi(n.scrollbarV,"scroll",function(){n.scroller.clientHeight&&Kt(e,n.scrollbarV.scrollTop)}),Pi(n.scrollbarH,"scroll",function(){n.scroller.clientHeight&&Qt(e,n.scrollbarH.scrollLeft)}),Pi(n.scroller,"mousewheel",function(t){Zt(e,t)}),Pi(n.scroller,"DOMMouseScroll",function(t){Zt(e,t)}),Pi(n.scrollbarH,"mousedown",r),Pi(n.scrollbarV,"mousedown",r),Pi(n.wrapper,"scroll",function(){n.wrapper.scrollTop=n.wrapper.scrollLeft=0});var i;Pi(window,"resize",s),setTimeout(o,5e3),Pi(n.input,"keyup",At(e,function(t){if(qi(e,t)||e.options.onKeyEvent&&e.options.onKeyEvent(e,ki(t)))return;t.keyCode==16&&(e.doc.sel.shift=!1)})),Pi(n.input,"input",ns(Pt,e)),Pi(n.input,"keydown",At(e,un)),Pi(n.input,"keypress",At(e,an)),Pi(n.input,"focus",ns(fn,e)),Pi(n.input,"blur",ns(ln,e)),e.options.dragDrop&&(Pi(n.scroller,"dragstart",function(t){Jt(e,t)}),Pi(n.scroller,"dragenter",u),Pi(n.scroller,"dragover",u),Pi(n.scroller,"drop",At(e,$t))),Pi(n.scroller,"paste",function(t){if(qt(n,t))return;jt(e),Pt(e)}),Pi(n.input,"paste",function(){e.state.pasteIncoming=!0,Pt(e)}),Pi(n.input,"cut",a),Pi(n.input,"copy",a),f&&Pi(n.sizer,"mouseup",function(){document.activeElement==n.input&&n.input.blur(),jt(e)})}function qt(e,t){for(var n=_i(t);n!=e.wrapper;n=n.parentNode)if(!n||n.ignoreEvents||n.parentNode==e.sizer&&n!=e.mover)return!0}function Rt(e,t,n){var r=e.display;if(!n){var i=_i(t);if(i==r.scrollbarH||i==r.scrollbarH.firstChild||i==r.scrollbarV||i==r.scrollbarV.firstChild||i==r.scrollbarFiller||i==r.gutterFiller)return null}var s,o,u=cs(r.lineSpace);try{s=t.clientX,o=t.clientY}catch(t){return null}return Et(e,s-u.left,o-u.top)}function Wt(e){function m(e){if(Nn(v,e))return;v=e;if(f=="single"){_n(n.doc,An(s,u),e);return}p=An(s,p),d=An(s,d);if(f=="double"){var t=$n(ai(s,e.line).text,e);Cn(e,p)?_n(n.doc,t.from,d):_n(n.doc,p,t.to)}else f=="triple"&&(Cn(e,p)?_n(n.doc,d,An(s,Tn(e.line,0))):_n(n.doc,p,An(s,Tn(e.line+1,0))))}function w(e){var t=++y,i=Rt(n,e,!0);if(!i)return;if(!Nn(i,c)){n.state.focused||fn(n),c=i,m(i);var o=B(r,s);(i.line>=o.to||i.line<o.from)&&setTimeout(At(n,function(){y==t&&w(e)}),150)}else{var u=e.clientY<g.top?-20:e.clientY>g.bottom?20:0;u&&setTimeout(At(n,function(){if(y!=t)return;r.scroller.scrollTop+=u,w(e)}),50)}}function E(e){y=Infinity,Li(e),jt(n),Hi(document,"mousemove",S),Hi(document,"mouseup",x)}if(qi(this,e))return;var n=this,r=n.display,s=n.doc,o=s.sel;o.shift=e.shiftKey;if(qt(r,e)){i||(r.scroller.draggable=!1,setTimeout(function(){r.scroller.draggable=!0},100));return}if(Xt(n,e))return;var u=Rt(n,e);switch(Di(e)){case 3:b&&hn.call(n,n,e);return;case 2:u&&_n(n.doc,u),setTimeout(ns(jt,n),20),Li(e);return}if(!u){_i(e)==r.scroller&&Li(e);return}n.state.focused||fn(n);var a=+(new Date),f="single";if(zt&&zt.time>a-400&&Nn(zt.pos,u))f="triple",Li(e),setTimeout(ns(jt,n),20),Jn(n,u.line);else if(Ut&&Ut.time>a-400&&Nn(Ut.pos,u)){f="double",zt={time:a,pos:u},Li(e);var l=$n(ai(s,u.line).text,u);_n(n.doc,l.from,l.to)}else Ut={time:a,pos:u};var c=u;if(n.options.dragDrop&&hs&&!Ft(n)&&!Nn(o.from,o.to)&&!Cn(u,o.from)&&!Cn(o.to,u)&&f=="single"){var h=At(n,function(t){i&&(r.scroller.draggable=!1),n.state.draggingText=!1,Hi(document,"mouseup",h),Hi(r.scroller,"drop",h),Math.abs(e.clientX-t.clientX)+Math.abs(e.clientY-t.clientY)<10&&(Li(t),_n(n.doc,u),jt(n))});i&&(r.scroller.draggable=!0),n.state.draggingText=h,r.scroller.dragDrop&&r.scroller.dragDrop(),Pi(document,"mouseup",h),Pi(r.scroller,"drop",h);return}Li(e),f=="single"&&_n(n.doc,An(s,u));var p=o.from,d=o.to,v=u,g=cs(r.wrapper),y=0,S=At(n,function(e){!t&&!Di(e)?E(e):w(e)}),x=At(n,E);Pi(document,"mousemove",S),Pi(document,"mouseup",x)}function Xt(e,t){var n=e.display;try{var r=t.clientX,i=t.clientY}catch(t){return!1}if(r>=Math.floor(cs(n.gutters).right))return!1;Li(t);if(!Ui(e,"gutterClick"))return!0;var s=cs(n.lineDiv);if(i>s.bottom)return!0;i-=s.top-n.viewOffset;for(var o=0;o<e.options.gutters.length;++o){var u=n.gutters.childNodes[o];if(u&&cs(u).right>=r){var a=pi(e.doc,i),f=e.options.gutters[o];Ii(e,"gutterClick",e,a,f,t);break}}return!0}function $t(e){var n=this;if(qi(n,e)||qt(n.display,e)||n.options.onDragEvent&&n.options.onDragEvent(n,ki(e)))return;Li(e),t&&(Vt=+(new Date));var r=Rt(n,e,!0),i=e.dataTransfer.files;if(!r||Ft(n))return;if(i&&i.length&&window.FileReader&&window.File){var s=i.length,o=Array(s),u=0,a=function(e,t){var i=new FileReader;i.onload=function(){o[t]=i.result,++u==s&&(r=An(n.doc,r),gn(n.doc,{from:r,to:r,text:ys(o.join("\n")),origin:"paste"},"around"))},i.readAsText(e)};for(var f=0;f<s;++f)a(i[f],f)}else{if(n.state.draggingText&&!Cn(r,n.doc.sel.from)&&!Cn(n.doc.sel.to,r)){n.state.draggingText(e),setTimeout(ns(jt,n),20);return}try{var o=e.dataTransfer.getData("Text");if(o){var l=n.doc.sel.from,c=n.doc.sel.to;Pn(n.doc,r,r),n.state.draggingText&&xn(n.doc,"",l,c,"paste"),n.replaceSelection(o,null,"paste"),jt(n),fn(n)}}catch(e){}}}function Jt(e,n){if(t&&(!e.state.draggingText||+(new Date)-Vt<100)){Mi(n);return}if(qi(e,n)||qt(e.display,n))return;var r=e.getSelection();n.dataTransfer.setData("Text",r);if(n.dataTransfer.setDragImage&&!a){var i=us("img",null,null,"position: fixed; left: 0; top: 0;");u&&(i.width=i.height=1,e.display.wrapper.appendChild(i),i._top=i.offsetTop),n.dataTransfer.setDragImage(i,0,0),u&&i.parentNode.removeChild(i)}}function Kt(t,n){if(Math.abs(t.doc.scrollTop-n)<2)return;t.doc.scrollTop=n,e||R(t,[],n),t.display.scroller.scrollTop!=n&&(t.display.scroller.scrollTop=n),t.display.scrollbarV.scrollTop!=n&&(t.display.scrollbarV.scrollTop=n),e&&R(t,[]),et(t,100)}function Qt(e,t,n){if(n?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)return;t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),e.doc.scrollLeft=t,j(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbarH.scrollLeft!=t&&(e.display.scrollbarH.scrollLeft=t)}function Zt(t,n){var r=n.wheelDeltaX,s=n.wheelDeltaY;r==null&&n.detail&&n.axis==n.HORIZONTAL_AXIS&&(r=n.detail),s==null&&n.detail&&n.axis==n.VERTICAL_AXIS?s=n.detail:s==null&&(s=n.wheelDelta);var o=t.display,a=o.scroller;if(!(r&&a.scrollWidth>a.clientWidth||s&&a.scrollHeight>a.clientHeight))return;if(s&&v&&i)for(var f=n.target;f!=a;f=f.parentNode)if(f.lineObj){t.display.currentWheelTarget=f;break}if(r&&!e&&!u&&Yt!=null){s&&Kt(t,Math.max(0,Math.min(a.scrollTop+s*Yt,a.scrollHeight-a.clientHeight))),Qt(t,Math.max(0,Math.min(a.scrollLeft+r*Yt,a.scrollWidth-a.clientWidth))),Li(n),o.wheelStartX=null;return}if(s&&Yt!=null){var l=s*Yt,c=t.doc.scrollTop,h=c+o.wrapper.clientHeight;l<0?c=Math.max(0,c+l-50):h=Math.min(t.doc.height,h+l+50),R(t,[],{top:c,bottom:h})}Gt<20&&(o.wheelStartX==null?(o.wheelStartX=a.scrollLeft,o.wheelStartY=a.scrollTop,o.wheelDX=r,o.wheelDY=s,setTimeout(function(){if(o.wheelStartX==null)return;var e=a.scrollLeft-o.wheelStartX,t=a.scrollTop-o.wheelStartY,n=t&&o.wheelDY&&t/o.wheelDY||e&&o.wheelDX&&e/o.wheelDX;o.wheelStartX=o.wheelStartY=null;if(!n)return;Yt=(Yt*Gt+n)/(Gt+1),++Gt},200)):(o.wheelDX+=r,o.wheelDY+=s))}function en(e,t,n){if(typeof t=="string"){t=or[t];if(!t)return!1}e.display.pollingFast&&Ht(e)&&(e.display.pollingFast=!1);var r=e.doc,i=r.sel.shift,s=!1;try{Ft(e)&&(e.state.suppressEdits=!0),n&&(r.sel.shift=!1),s=t(e)!=Xi}finally{r.sel.shift=i,e.state.suppressEdits=!1}return s}function tn(e){var t=e.state.keyMaps.slice(0);return e.options.extraKeys&&t.push(e.options.extraKeys),t.push(e.options.keyMap),t}function rn(e,t){var n=ar(e.options.keyMap),i=n.auto;clearTimeout(nn),i&&!lr(t)&&(nn=setTimeout(function(){ar(e.options.keyMap)==n&&(e.options.keyMap=i.call?i.call(null,e):i,L(e))},50));var s=cr(t,!0),o=!1;if(!s)return!1;var u=tn(e);return t.shiftKey?o=fr("Shift-"+s,u,function(t){return en(e,t,!0)})||fr(s,u,function(t){if(typeof t=="string"?/^go[A-Z]/.test(t):t.motion)return en(e,t)}):o=fr(s,u,function(t){return en(e,t)}),o&&(Li(t),Z(e),r&&(t.oldKeyCode=t.keyCode,t.keyCode=0),Ii(e,"keyHandled",e,s,t)),o}function sn(e,t,n){var r=fr("'"+n+"'",tn(e),function(t){return en(e,t,!0)});return r&&(Li(t),Z(e),Ii(e,"keyHandled",e,"'"+n+"'",t)),r}function un(e){var n=this;n.state.focused||fn(n),t&&e.keyCode==27&&(e.returnValue=!1);if(qi(n,e)||n.options.onKeyEvent&&n.options.onKeyEvent(n,ki(e)))return;var r=e.keyCode;n.doc.sel.shift=r==16||e.shiftKey;var i=rn(n,e);u&&(on=i?r:null,!i&&r==88&&!ws&&(v?e.metaKey:e.ctrlKey)&&n.replaceSelection(""))}function an(e){var n=this;if(qi(n,e)||n.options.onKeyEvent&&n.options.onKeyEvent(n,ki(e)))return;var i=e.keyCode,s=e.charCode;if(u&&i==on){on=null,Li(e);return}if((u&&(!e.which||e.which<10)||f)&&rn(n,e))return;var o=String.fromCharCode(s==null?i:s);this.options.electricChars&&this.doc.mode.electricChars&&this.options.smartIndent&&!Ft(this)&&this.doc.mode.electricChars.indexOf(o)>-1&&setTimeout(At(n,function(){zn(n,n.doc.sel.to.line,"smart")}),75);if(sn(n,e,o))return;t&&!r&&(n.display.inputHasSelection=null),Pt(n)}function fn(e){if(e.options.readOnly=="nocursor")return;e.state.focused||(Bi(e,"focus",e),e.state.focused=!0,e.display.wrapper.className.search(/\bCodeMirror-focused\b/)==-1&&(e.display.wrapper.className+=" CodeMirror-focused"),Bt(e,!0)),Dt(e),Z(e)}function ln(e){e.state.focused&&(Bi(e,"blur",e),e.state.focused=!1,e.display.wrapper.className=e.display.wrapper.className.replace(" CodeMirror-focused","")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.doc.sel.shift=!1)},150)}function hn(e,n){function l(){if(i.input.selectionStart!=null){var e=i.input.value=" "+(Nn(s.from,s.to)?"":i.input.value);i.prevInput=" ",i.input.selectionStart=1,i.input.selectionEnd=e.length}}function c(){i.inputDiv.style.position="relative",i.input.style.cssText=f,r&&(i.scrollbarV.scrollTop=i.scroller.scrollTop=a),Dt(e);if(i.input.selectionStart!=null){(!t||r)&&l(),clearTimeout(cn);var n=0,s=function(){i.prevInput==" "&&i.input.selectionStart==0?At(e,or.selectAll)(e):n++<10?cn=setTimeout(s,500):Bt(e)};cn=setTimeout(s,200)}}if(qi(e,n,"contextmenu"))return;var i=e.display,s=e.doc.sel;if(qt(i,n))return;var o=Rt(e,n),a=i.scroller.scrollTop;if(!o||u)return;(Nn(s.from,s.to)||Cn(o,s.from)||!Cn(o,s.to))&&At(e,Pn)(e.doc,o,o);var f=i.input.style.cssText;i.inputDiv.style.position="absolute",i.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(n.clientY-5)+"px; left: "+(n.clientX-5)+"px; z-index: 1000; background: white; outline: none;"+"border-width: 0; outline: none; overflow: hidden; opacity: .05; -ms-opacity: .05; filter: alpha(opacity=5);",jt(e),Bt(e,!0),Nn(s.from,s.to)&&(i.input.value=i.prevInput=" "),t&&!r&&l();if(b){Mi(n);var h=function(){Hi(window,"mouseup",h),setTimeout(c,20)};Pi(window,"mouseup",h)}else setTimeout(c,50)}function dn(e,t,n){if(!Cn(t.from,n))return An(e,n);var r=t.text.length-1-(t.to.line-t.from.line);if(n.line>t.to.line+r){var i=n.line-r,s=e.first+e.size-1;return i>s?Tn(s,ai(e,s).text.length):On(n,ai(e,i).text.length)}if(n.line==t.to.line+r)return On(n,Qi(t.text).length+(t.text.length==1?t.from.ch:0)+ai(e,t.to.line).text.length-t.to.ch);var o=n.line-t.from.line;return On(n,t.text[o].length+(o?0:t.from.ch))}function vn(e,t,n){if(n&&typeof n=="object")return{anchor:dn(e,t,n.anchor),head:dn(e,t,n.head)};if(n=="start")return{anchor:t.from,head:t.from};var r=pn(t);if(n=="around")return{anchor:t.from,head:r};if(n=="end")return{anchor:r,head:r};var i=function(e){if(Cn(e,t.from))return e;if(!Cn(t.to,e))return r;var n=e.line+t.text.length-(t.to.line-t.from.line)-1,i=e.ch;return e.line==t.to.line&&(i+=r.ch-t.to.ch),Tn(n,i)};return{anchor:i(e.sel.anchor),head:i(e.sel.head)}}function mn(e,t,n){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){this.canceled=!0}};return n&&(r.update=function(t,n,r,i){t&&(this.from=An(e,t)),n&&(this.to=An(e,n)),r&&(this.text=r),i!==undefined&&(this.origin=i)}),Bi(e,"beforeChange",e,r),e.cm&&Bi(e.cm,"beforeChange",e.cm,r),r.canceled?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function gn(e,t,n,r){if(e.cm){if(!e.cm.curOp)return At(e.cm,gn)(e,t,n,r);if(e.cm.state.suppressEdits)return}if(Ui(e,"beforeChange")||e.cm&&Ui(e.cm,"beforeChange")){t=mn(e,t,!0);if(!t)return}var i=w&&!r&&Tr(e,t.from,t.to);if(i){for(var s=i.length-1;s>=1;--s)yn(e,{from:i[s].from,to:i[s].to,text:[""]});i.length&&yn(e,{from:i[0].from,to:i[0].to,text:t.text},n)}else yn(e,t,n)}function yn(e,t,n){var r=vn(e,t,n);bi(e,t,r,e.cm?e.cm.curOp.id:NaN),En(e,t,r,Sr(e,t));var i=[];oi(e,function(e,n){!n&&Yi(i,e.history)==-1&&(Ni(e.history,t),i.push(e.history)),En(e,t,null,Sr(e,t))})}function bn(e,t){if(e.cm&&e.cm.state.suppressEdits)return;var n=e.history,r=(t=="undo"?n.done:n.undone).pop();if(!r)return;var i={changes:[],anchorBefore:r.anchorAfter,headBefore:r.headAfter,anchorAfter:r.anchorBefore,headAfter:r.headBefore,generation:n.generation};(t=="undo"?n.undone:n.done).push(i),n.generation=r.generation||++n.maxGeneration;var s=Ui(e,"beforeChange")||e.cm&&Ui(e.cm,"beforeChange");for(var o=r.changes.length-1;o>=0;--o){var u=r.changes[o];u.origin=t;if(s&&!mn(e,u,!1)){(t=="undo"?n.done:n.undone).length=0;return}i.changes.push(yi(e,u));var a=o?vn(e,u,null):{anchor:r.anchorBefore,head:r.headBefore};En(e,u,a,xr(e,u));var f=[];oi(e,function(e,t){!t&&Yi(f,e.history)==-1&&(Ni(e.history,u),f.push(e.history)),En(e,u,null,xr(e,u))})}}function wn(e,t){function n(e){return Tn(e.line+t,e.ch)}e.first+=t,e.cm&&_t(e.cm,e.first,e.first,t),e.sel.head=n(e.sel.head),e.sel.anchor=n(e.sel.anchor),e.sel.from=n(e.sel.from),e.sel.to=n(e.sel.to)}function En(e,t,n,r){if(e.cm&&!e.cm.curOp)return At(e.cm,En)(e,t,n,r);if(t.to.line<e.first){wn(e,t.text.length-1-(t.to.line-t.from.line));return}if(t.from.line>e.lastLine())return;if(t.from.line<e.first){var i=t.text.length-1-(e.first-t.from.line);wn(e,i),t={from:Tn(e.first,0),to:Tn(t.to.line+i,t.to.ch),text:[Qi(t.text)],origin:t.origin}}var s=e.lastLine();t.to.line>s&&(t={from:t.from,to:Tn(s,ai(e,s).text.length),text:[t.text[0]],origin:t.origin}),t.removed=fi(e,t.from,t.to),n||(n=vn(e,t,null)),e.cm?Sn(e.cm,t,r,n):Zr(e,t,r,n)}function Sn(e,t,n,r){var i=e.doc,s=e.display,o=t.from,u=t.to,a=!1,f=o.line;e.options.lineWrapping||(f=hi(Lr(i,ai(i,o.line))),i.iter(f,u.line+1,function(e){if(e==s.maxLine)return a=!0,!0})),!Cn(i.sel.head,t.from)&&!Cn(t.to,i.sel.head)&&(e.curOp.cursorActivity=!0),Zr(i,t,n,r,C(e)),e.options.lineWrapping||(i.iter(f,o.line+t.text.length,function(e){var t=_(i,e);t>s.maxLineLength&&(s.maxLine=e,s.maxLineLength=t,s.maxLineChanged=!0,a=!1)}),a&&(e.curOp.updateMaxLine=!0)),i.frontier=Math.min(i.frontier,o.line),et(e,400);var l=t.text.length-(u.line-o.line)-1;_t(e,o.line,u.line+1,l);if(Ui(e,"change")){var c={from:o,to:u,text:t.text,removed:t.removed,origin:t.origin};if(e.curOp.textChanged){for(var h=e.curOp.textChanged;h.next;h=h.next);h.next=c}else e.curOp.textChanged=c}}function xn(e,t,n,r,i){r||(r=n);if(Cn(r,n)){var s=r;r=n,n=s}typeof t=="string"&&(t=ys(t)),gn(e,{from:n,to:r,text:t,origin:i},null)}function Tn(e,t){if(!(this instanceof Tn))return new Tn(e,t);this.line=e,this.ch=t}function Nn(e,t){return e.line==t.line&&e.ch==t.ch}function Cn(e,t){return e.line<t.line||e.line==t.line&&e.ch<t.ch}function kn(e){return Tn(e.line,e.ch)}function Ln(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function An(e,t){if(t.line<e.first)return Tn(e.first,0);var n=e.first+e.size-1;return t.line>n?Tn(n,ai(e,n).text.length):On(t,ai(e,t.line).text.length)}function On(e,t){var n=e.ch;return n==null||n>t?Tn(e.line,t):n<0?Tn(e.line,0):e}function Mn(e,t){return t>=e.first&&t<e.first+e.size}function _n(e,t,n,r){if(e.sel.shift||e.sel.extend){var i=e.sel.anchor;if(n){var s=Cn(t,i);s!=Cn(n,i)?(i=t,t=n):s!=Cn(t,n)&&(t=n)}Pn(e,i,t,r)}else Pn(e,t,n||t,r);e.cm&&(e.cm.curOp.userSelChange=!0)}function Dn(e,t,n){var r={anchor:t,head:n};return Bi(e,"beforeSelectionChange",e,r),e.cm&&Bi(e.cm,"beforeSelectionChange",e.cm,r),r.anchor=An(e,r.anchor),r.head=An(e,r.head),r}function Pn(e,t,n,r,i){if(!i&&Ui(e,"beforeSelectionChange")||e.cm&&Ui(e.cm,"beforeSelectionChange")){var s=Dn(e,t,n);n=s.head,t=s.anchor}var o=e.sel;o.goalColumn=null;if(i||!Nn(t,o.anchor))t=Bn(e,t,r,i!="push");if(i||!Nn(n,o.head))n=Bn(e,n,r,i!="push");if(Nn(o.anchor,t)&&Nn(o.head,n))return;o.anchor=t,o.head=n;var u=Cn(n,t);o.from=u?n:t,o.to=u?t:n,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=e.cm.curOp.cursorActivity=!0),Ii(e,"cursorActivity",e)}function Hn(e){Pn(e.doc,e.doc.sel.from,e.doc.sel.to,null,"push")}function Bn(e,t,n,r){var i=!1,s=t,o=n||1;e.cantEdit=!1;e:for(;;){var u=ai(e,s.line);if(u.markedSpans)for(var a=0;a<u.markedSpans.length;++a){var f=u.markedSpans[a],l=f.marker;if((f.from==null||(l.inclusiveLeft?f.from<=s.ch:f.from<s.ch))&&(f.to==null||(l.inclusiveRight?f.to>=s.ch:f.to>s.ch))){if(r){Bi(l,"beforeCursorEnter");if(l.explicitlyCleared){if(!u.markedSpans)break;--a;continue}}if(!l.atomic)continue;var c=l.find()[o<0?"from":"to"];if(Nn(c,s)){c.ch+=o,c.ch<0?c.line>e.first?c=An(e,Tn(c.line-1)):c=null:c.ch>u.text.length&&(c.line<e.first+e.size-1?c=Tn(c.line+1,0):c=null);if(!c){if(i)return r?(e.cantEdit=!0,Tn(e.first,0)):Bn(e,t,n,!0);i=!0,c=t,o=-o}}s=c;continue e}}return s}}function jn(e){var t=Fn(e,e.doc.sel.head,e.options.cursorScrollMargin);if(!e.state.focused)return;var n=e.display,r=cs(n.sizer),i=null;t.top+r.top<0?i=!0:t.bottom+r.top>(window.innerHeight||document.documentElement.clientHeight)&&(i=!1);if(i!=null&&!h){var s=n.cursor.style.display=="none";s&&(n.cursor.style.display="",n.cursor.style.left=t.left+"px",n.cursor.style.top=t.top-n.viewOffset+"px"),n.cursor.scrollIntoView(i),s&&(n.cursor.style.display="none")}}function Fn(e,t,n){n==null&&(n=0);for(;;){var r=!1,i=bt(e,t),s=qn(e,i.left,i.top-n,i.left,i.bottom+n),o=e.doc.scrollTop,u=e.doc.scrollLeft;s.scrollTop!=null&&(Kt(e,s.scrollTop),Math.abs(e.doc.scrollTop-o)>1&&(r=!0)),s.scrollLeft!=null&&(Qt(e,s.scrollLeft),Math.abs(e.doc.scrollLeft-u)>1&&(r=!0));if(!r)return i}}function In(e,t,n,r,i){var s=qn(e,t,n,r,i);s.scrollTop!=null&&Kt(e,s.scrollTop),s.scrollLeft!=null&&Qt(e,s.scrollLeft)}function qn(e,t,n,r,i){var s=e.display,o=Tt(e.display);n<0&&(n=0);var u=s.scroller.clientHeight-Wi,a=s.scroller.scrollTop,f={},l=e.doc.height+st(s),c=n<o,h=i>l-o;if(n<a)f.scrollTop=c?0:n;else if(i>a+u){var p=Math.min(n,(h?l:i)-u);p!=a&&(f.scrollTop=p)}var d=s.scroller.clientWidth-Wi,v=s.scroller.scrollLeft;t+=s.gutters.offsetWidth,r+=s.gutters.offsetWidth;var m=s.gutters.offsetWidth,g=t<m+10;return t<v+m||g?(g&&(t=0),f.scrollLeft=Math.max(0,t-10-m)):r>d+v-3&&(f.scrollLeft=r+10-d),f}function Rn(e,t,n){e.curOp.updateScrollPos={scrollLeft:t==null?e.doc.scrollLeft:t,scrollTop:n==null?e.doc.scrollTop:n}}function Un(e,t,n){var r=e.curOp.updateScrollPos||(e.curOp.updateScrollPos={scrollLeft:e.doc.scrollLeft,scrollTop:e.doc.scrollTop}),i=e.display.scroller;r.scrollTop=Math.max(0,Math.min(i.scrollHeight-i.clientHeight,r.scrollTop+n)),r.scrollLeft=Math.max(0,Math.min(i.scrollWidth-i.clientWidth,r.scrollLeft+t))}function zn(e,t,n,r){var i=e.doc;n==null&&(n="add");if(n=="smart")if(!e.doc.mode.indent)n="prev";else var s=rt(e,t);var o=e.options.tabSize,u=ai(i,t),a=$i(u.text,null,o),f=u.text.match(/^\s*/)[0],l;if(n=="smart"){l=e.doc.mode.indent(s,u.text.slice(f.length),u.text);if(l==Xi){if(!r)return;n="prev"}}n=="prev"?t>i.first?l=$i(ai(i,t-1).text,null,o):l=0:n=="add"?l=a+e.options.indentUnit:n=="subtract"?l=a-e.options.indentUnit:typeof n=="number"&&(l=a+n),l=Math.max(0,l);var c="",h=0;if(e.options.indentWithTabs)for(var p=Math.floor(l/o);p;--p)h+=o,c+="	";h<l&&(c+=Ki(l-h)),c!=f&&xn(e.doc,c,Tn(t,0),Tn(t,f.length),"+input"),u.stateAfter=null}function Wn(e,t,n){var r=t,i=t,s=e.doc;return typeof t=="number"?i=ai(s,Ln(s,t)):r=hi(t),r==null?null:n(i,r)?(_t(e,r,r+1),i):null}function Xn(e,t,n,r,i){function l(){var t=s+n;return t<e.first||t>=e.first+e.size?f=!1:(s=t,a=ai(e,t))}function c(e){var t=(i?Ds:Ps)(a,o,n,!0);if(t==null){if(!!e||!l())return f=!1;i?o=(n<0?Cs:Ns)(a):o=n<0?a.text.length:0}else o=t;return!0}var s=t.line,o=t.ch,u=n,a=ai(e,s),f=!0;if(r=="char")c();else if(r=="column")c(!0);else if(r=="word"||r=="group"){var h=null,p=r=="group";for(var d=!0;;d=!1){if(n<0&&!c(!d))break;var v=a.text.charAt(o)||"\n",m=is(v)?"w":p?/\s/.test(v)?null:"p":null;if(h&&h!=m){n<0&&(n=1,c());break}m&&(h=m);if(n>0&&!c(!d))break}}var g=Bn(e,Tn(s,o),u,!0);return f||(g.hitSide=!0),g}function Vn(e,t,n,r){var i=e.doc,s=t.left,o;if(r=="page"){var u=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);o=t.top+n*(u-(n<0?1.5:.5)*Tt(e.display))}else r=="line"&&(o=n>0?t.bottom+3:t.top-3);for(;;){var a=Et(e,s,o);if(!a.outside)break;if(n<0?o<=0:o>=i.height){a.hitSide=!0;break}o+=n*5}return a}function $n(e,t){var n=t.ch,r=t.ch;if(e){(t.xRel<0||r==e.length)&&n?--n:++r;var i=e.charAt(n),s=is(i)?is:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!is(e)};while(n>0&&s(e.charAt(n-1)))--n;while(r<e.length&&s(e.charAt(r)))++r}return{from:Tn(t.line,n),to:Tn(t.line,r)}}function Jn(e,t){_n(e.doc,Tn(t,0),An(e.doc,Tn(t+1,0)))}function Gn(e,t,n,r){S.defaults[e]=t,n&&(Kn[e]=r?function(e,t,r){r!=Yn&&n(e,t,r)}:n)}function ir(e,t){if(t===!0)return t;if(e.copyState)return e.copyState(t);var n={};for(var r in t){var i=t[r];i instanceof Array&&(i=i.concat([])),n[r]=i}return n}function sr(e,t,n){return e.startState?e.startState(t,n):!0}function ar(e){return typeof e=="string"?ur[e]:e}function fr(e,t,n){function r(t){t=ar(t);var i=t[e];if(i===!1)return"stop";if(i!=null&&n(i))return!0;if(t.nofallthrough)return"stop";var s=t.fallthrough;if(s==null)return!1;if(Object.prototype.toString.call(s)!="[object Array]")return r(s);for(var o=0,u=s.length;o<u;++o){var a=r(s[o]);if(a)return a}return!1}for(var i=0;i<t.length;++i){var s=r(t[i]);if(s)return s!="stop"}}function lr(e){var t=Es[e.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"}function cr(e,t){if(u&&e.keyCode==34&&e["char"])return!1;var n=Es[e.keyCode];if(n==null||e.altGraphKey)return!1;e.altKey&&(n="Alt-"+n);if(y?e.metaKey:e.ctrlKey)n="Ctrl-"+n;if(y?e.ctrlKey:e.metaKey)n="Cmd-"+n;return!t&&e.shiftKey&&(n="Shift-"+n),n}function hr(e,t){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0}function pr(e,t){this.lines=[],this.type=t,this.doc=e}function dr(e,t,n,r,i){if(r&&r.shared)return mr(e,t,n,r,i);if(e.cm&&!e.cm.curOp)return At(e.cm,dr)(e,t,n,r,i);var s=new pr(e,i);if(i=="range"&&!Cn(t,n))return s;r&&es(r,s),s.replacedWith&&(s.collapsed=!0,s.replacedWith=us("span",[s.replacedWith],"CodeMirror-widget"),r.handleMouseEvents||(s.replacedWith.ignoreEvents=!0)),s.collapsed&&(E=!0),s.addToHistory&&bi(e,{from:t,to:n,origin:"markText"},{head:e.sel.head,anchor:e.sel.anchor},NaN);var o=t.line,u=0,a,f,l=e.cm,c;e.iter(o,n.line+1,function(r){l&&s.collapsed&&!l.options.lineWrapping&&Lr(e,r)==l.display.maxLine&&(c=!0);var i={from:null,to:null,marker:s};u+=r.text.length,o==t.line&&(i.from=t.ch,u-=t.ch),o==n.line&&(i.to=n.ch,u-=r.text.length-n.ch),s.collapsed&&(o==n.line&&(f=Nr(r,n.ch)),o==t.line?a=Nr(r,t.ch):ci(r,0)),br(r,i),++o}),s.collapsed&&e.iter(t.line,n.line+1,function(t){Ar(e,t)&&ci(t,0)}),s.clearOnEnter&&Pi(s,"beforeCursorEnter",function(){s.clear()}),s.readOnly&&(w=!0,(e.history.done.length||e.history.undone.length)&&e.clearHistory());if(s.collapsed){if(a!=f)throw new Error("Inserting collapsed marker overlapping an existing one");s.size=u,s.atomic=!0}return l&&(c&&(l.curOp.updateMaxLine=!0),(s.className||s.title||s.startStyle||s.endStyle||s.collapsed)&&_t(l,t.line,n.line+1),s.atomic&&Hn(l)),s}function vr(e,t){this.markers=e,this.primary=t;for(var n=0,r=this;n<e.length;++n)e[n].parent=this,Pi(e[n],"clear",function(){r.clear()})}function mr(e,t,n,r,i){r=es(r),r.shared=!1;var s=[dr(e,t,n,r,i)],o=s[0],u=r.replacedWith;return oi(e,function(e){u&&(r.replacedWith=u.cloneNode(!0)),s.push(dr(e,An(e,t),An(e,n),r,i));for(var a=0;a<e.linked.length;++a)if(e.linked[a].isParent)return;o=Qi(s)}),new vr(s,o)}function gr(e,t){if(e)for(var n=0;n<e.length;++n){var r=e[n];if(r.marker==t)return r}}function yr(e,t){for(var n,r=0;r<e.length;++r)e[r]!=t&&(n||(n=[])).push(e[r]);return n}function br(e,t){e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e)}function wr(e,t,n){if(e)for(var r=0,i;r<e.length;++r){var s=e[r],o=s.marker,u=s.from==null||(o.inclusiveLeft?s.from<=t:s.from<t);if(u||o.type=="bookmark"&&s.from==t&&(!n||!s.marker.insertLeft)){var a=s.to==null||(o.inclusiveRight?s.to>=t:s.to>t);(i||(i=[])).push({from:s.from,to:a?null:s.to,marker:o})}}return i}function Er(e,t,n){if(e)for(var r=0,i;r<e.length;++r){var s=e[r],o=s.marker,u=s.to==null||(o.inclusiveRight?s.to>=t:s.to>t);if(u||o.type=="bookmark"&&s.from==t&&(!n||s.marker.insertLeft)){var a=s.from==null||(o.inclusiveLeft?s.from<=t:s.from<t);(i||(i=[])).push({from:a?null:s.from-t,to:s.to==null?null:s.to-t,marker:o})}}return i}function Sr(e,t){var n=Mn(e,t.from.line)&&ai(e,t.from.line).markedSpans,r=Mn(e,t.to.line)&&ai(e,t.to.line).markedSpans;if(!n&&!r)return null;var i=t.from.ch,s=t.to.ch,o=Nn(t.from,t.to),u=wr(n,i,o),a=Er(r,s,o),f=t.text.length==1,l=Qi(t.text).length+(f?i:0);if(u)for(var c=0;c<u.length;++c){var h=u[c];if(h.to==null){var p=gr(a,h.marker);p?f&&(h.to=p.to==null?null:p.to+l):h.to=i}}if(a)for(var c=0;c<a.length;++c){var h=a[c];h.to!=null&&(h.to+=l);if(h.from==null){var p=gr(u,h.marker);p||(h.from=l,f&&(u||(u=[])).push(h))}else h.from+=l,f&&(u||(u=[])).push(h)}if(f&&u){for(var c=0;c<u.length;++c)u[c].from!=null&&u[c].from==u[c].to&&u[c].marker.type!="bookmark"&&u.splice(c--,1);u.length||(u=null)}var d=[u];if(!f){var v=t.text.length-2,m;if(v>0&&u)for(var c=0;c<u.length;++c)u[c].to==null&&(m||(m=[])).push({from:null,to:null,marker:u[c].marker});for(var c=0;c<v;++c)d.push(m);d.push(a)}return d}function xr(e,t){var n=Ei(e,t),r=Sr(e,t);if(!n)return r;if(!r)return n;for(var i=0;i<n.length;++i){var s=n[i],o=r[i];if(s&&o)e:for(var u=0;u<o.length;++u){var a=o[u];for(var f=0;f<s.length;++f)if(s[f].marker==a.marker)continue e;s.push(a)}else o&&(n[i]=o)}return n}function Tr(e,t,n){var r=null;e.iter(t.line,n.line+1,function(e){if(e.markedSpans)for(var t=0;t<e.markedSpans.length;++t){var n=e.markedSpans[t].marker;n.readOnly&&(!r||Yi(r,n)==-1)&&(r||(r=[])).push(n)}});if(!r)return null;var i=[{from:t,to:n}];for(var s=0;s<r.length;++s){var o=r[s],u=o.find();for(var a=0;a<i.length;++a){var f=i[a];if(Cn(f.to,u.from)||Cn(u.to,f.from))continue;var l=[a,1];(Cn(f.from,u.from)||!o.inclusiveLeft&&Nn(f.from,u.from))&&l.push({from:f.from,to:u.from}),(Cn(u.to,f.to)||!o.inclusiveRight&&Nn(f.to,u.to))&&l.push({from:u.to,to:f.to}),i.splice.apply(i,l),a+=l.length-1}}return i}function Nr(e,t){var n=E&&e.markedSpans,r;if(n)for(var i,s=0;s<n.length;++s){i=n[s];if(!i.marker.collapsed)continue;(i.from==null||i.from<t)&&(i.to==null||i.to>t)&&(!r||r.width<i.marker.width)&&(r=i.marker)}return r}function Cr(e){return Nr(e,-1)}function kr(e){return Nr(e,e.text.length+1)}function Lr(e,t){var n;while(n=Cr(t))t=ai(e,n.find().from.line);return t}function Ar(e,t){var n=E&&t.markedSpans;if(n)for(var r,i=0;i<n.length;++i){r=n[i];if(!r.marker.collapsed)continue;if(r.from==null)return!0;if(r.marker.replacedWith)continue;if(r.from==0&&r.marker.inclusiveLeft&&Or(e,t,r))return!0}}function Or(e,t,n){if(n.to==null){var r=n.marker.find().to,i=ai(e,r.line);return Or(e,i,gr(i.markedSpans,n.marker))}if(n.marker.inclusiveRight&&n.to==t.text.length)return!0;for(var s,o=0;o<t.markedSpans.length;++o){s=t.markedSpans[o];if(s.marker.collapsed&&!s.marker.replacedWith&&s.from==n.to&&(s.marker.inclusiveLeft||n.marker.inclusiveRight)&&Or(e,t,s))return!0}}function Mr(e){var t=e.markedSpans;if(!t)return;for(var n=0;n<t.length;++n)t[n].marker.detachLine(e);e.markedSpans=null}function _r(e,t){if(!t)return;for(var n=0;n<t.length;++n)t[n].marker.attachLine(e);e.markedSpans=t}function Pr(e){return function(){var t=!this.cm.curOp;t&&kt(this.cm);try{var n=e.apply(this,arguments)}finally{t&&Lt(this.cm)}return n}}function Hr(e){return e.height!=null?e.height:((!e.node.parentNode||e.node.parentNode.nodeType!=1)&&fs(e.cm.display.measure,us("div",[e.node],null,"position: relative")),e.height=e.node.offsetHeight)}function Br(e,t,n,r){var i=new Dr(e,n,r);return i.noHScroll&&(e.display.alignWidgets=!0),Wn(e,t,function(t){var n=t.widgets||(t.widgets=[]);i.insertAt==null?n.push(i):n.splice(Math.min(n.length-1,Math.max(0,i.insertAt)),0,i),i.line=t;if(!Ar(e.doc,t)||i.showIfHidden){var r=di(e,t)<e.doc.scrollTop;ci(t,t.height+Hr(i)),r&&Un(e,0,i.height)}return!0}),i}function Fr(e,t,n,r){e.text=t,e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null),e.order!=null&&(e.order=null),Mr(e),_r(e,n);var i=r?r(e):1;i!=e.height&&ci(e,i)}function Ir(e){e.parent=null,Mr(e)}function qr(e,t,n,r,i){var s=n.flattenSpans;s==null&&(s=e.options.flattenSpans);var o=0,u=null,a=new hr(t,e.options.tabSize),f;t==""&&n.blankLine&&n.blankLine(r);while(!a.eol()){a.pos>e.options.maxHighlightLength?(s=!1,a.pos=Math.min(t.length,a.start+5e4),f=null):f=n.token(a,r);if(!s||u!=f)o<a.start&&i(a.start,u),o=a.start,u=f;a.start=a.pos}o<a.pos&&i(a.pos,u)}function Rr(e,t,n){var r=[e.state.modeGen];qr(e,t.text,e.doc.mode,n,function(e,t){r.push(e,t)});for(var i=0;i<e.state.overlays.length;++i){var s=e.state.overlays[i],o=1,u=0;qr(e,t.text,s.mode,!0,function(e,t){var n=o;while(u<e){var i=r[o];i>e&&r.splice(o,1,e,r[o+1],i),o+=2,u=Math.min(e,i)}if(!t)return;if(s.opaque)r.splice(n,o-n,e,t),o=n+2;else for(;n<o;n+=2){var a=r[n+1];r[n+1]=a?a+" "+t:t}})}return r}function Ur(e,t){if(!t.styles||t.styles[0]!=e.state.modeGen)t.styles=Rr(e,t,t.stateAfter=rt(e,hi(t)));return t.styles}function zr(e,t,n){var r=e.doc.mode,i=new hr(t.text,e.options.tabSize);t.text==""&&r.blankLine&&r.blankLine(n);while(!i.eol()&&i.pos<=e.options.maxHighlightLength)r.token(i,n),i.start=i.pos}function Xr(e){return e?Wr[e]||(Wr[e]="cm-"+e.replace(/ +/g," cm-")):null}function Vr(e,n,r,s){var o,u=n,a=!0;while(o=Cr(u))u=ai(e.doc,o.find().from.line);var f={pre:us("pre"),col:0,pos:0,measure:null,measuredSomething:!1,cm:e,copyWidgets:s};u.textClass&&(f.pre.className=u.textClass);do{u.text&&(a=!1),f.measure=u==n&&r,f.pos=0,f.addToken=f.measure?Kr:Jr,(t||i)&&e.getOption("lineWrapping")&&(f.addToken=Qr(f.addToken));var l=Yr(u,f,Ur(e,u));r&&u==n&&!f.measuredSomething&&(r[0]=f.pre.appendChild(gs(e.display.measure)),f.measuredSomething=!0),l&&(u=ai(e.doc,l.to.line))}while(l);r&&!f.measuredSomething&&!r[0]&&(r[0]=f.pre.appendChild(a?us("span","Â "):gs(e.display.measure))),!f.pre.firstChild&&!Ar(e.doc,n)&&f.pre.appendChild(document.createTextNode("Â "));var c;if(r&&t&&(c=vi(u))){var h=c.length-1;c[h].from==c[h].to&&--h;var p=c[h],d=c[h-1];if(p.from+1==p.to&&d&&p.level<d.level){var v=r[f.pos-1];v&&v.parentNode.insertBefore(v.measureRight=gs(e.display.measure),v.nextSibling)}}return Bi(e,"renderLine",e,n,f.pre),f.pre}function Jr(e,t,n,r,i,s){if(!t)return;if(!$r.test(t)){e.col+=t.length;var o=document.createTextNode(t)}else{var o=document.createDocumentFragment(),u=0;for(;;){$r.lastIndex=u;var a=$r.exec(t),f=a?a.index-u:t.length-u;f&&(o.appendChild(document.createTextNode(t.slice(u,u+f))),e.col+=f);if(!a)break;u+=f+1;if(a[0]=="	"){var l=e.cm.options.tabSize,c=l-e.col%l;o.appendChild(us("span",Ki(c),"cm-tab")),e.col+=c}else{var h=us("span","â€¢","cm-invalidchar");h.title="\\u"+a[0]
.charCodeAt(0).toString(16),o.appendChild(h),e.col+=1}}}if(n||r||i||e.measure){var p=n||"";r&&(p+=r),i&&(p+=i);var h=us("span",[o],p);return s&&(h.title=s),e.pre.appendChild(h)}e.pre.appendChild(o)}function Kr(e,n,r,i,s){var o=e.cm.options.lineWrapping;for(var u=0;u<n.length;++u){var a=n.charAt(u),f=u==0;a>="í €"&&a<"í¯¿"&&u<n.length-1?(a=n.slice(u,u+2),++u):u&&o&&ps(n,u)&&e.pre.appendChild(us("wbr"));var l=e.measure[e.pos],c=e.measure[e.pos]=Jr(e,a,r,f&&i,u==n.length-1&&s);l&&(c.leftSide=l.leftSide||l),t&&o&&a==" "&&u&&!/\s/.test(n.charAt(u-1))&&u<n.length-1&&!/\s/.test(n.charAt(u+1))&&(c.style.whiteSpace="normal"),e.pos+=a.length}n.length&&(e.measuredSomething=!0)}function Qr(e){function t(e){var t=" ";for(var n=0;n<e.length-2;++n)t+=n%2?" ":"Â ";return t+=" ",t}return function(n,r,i,s,o,u){return e(n,r.replace(/ {3,}/,t),i,s,o,u)}}function Gr(e,t,n,r){var i=!r&&n.replacedWith;if(i){e.copyWidgets&&(i=i.cloneNode(!0)),e.pre.appendChild(i);if(e.measure){if(t)e.measure[e.pos]=i;else{var s=e.measure[e.pos]=gs(e.cm.display.measure);n.type!="bookmark"||n.insertLeft?e.pre.insertBefore(s,i):e.pre.appendChild(s)}e.measuredSomething=!0}}e.pos+=t}function Yr(e,t,n){var r=e.markedSpans,i=e.text,s=0;if(!r){for(var o=1;o<n.length;o+=2)t.addToken(t,i.slice(s,s=n[o]),Xr(n[o+1]));return}var u=i.length,a=0,o=1,f="",l,c=0,h,p,d,v,m;for(;;){if(c==a){h=p=d=v="",m=null,c=Infinity;var g=null;for(var y=0;y<r.length;++y){var b=r[y],w=b.marker;b.from<=a&&(b.to==null||b.to>a)?(b.to!=null&&c>b.to&&(c=b.to,p=""),w.className&&(h+=" "+w.className),w.startStyle&&b.from==a&&(d+=" "+w.startStyle),w.endStyle&&b.to==c&&(p+=" "+w.endStyle),w.title&&!v&&(v=w.title),w.collapsed&&(!m||m.marker.size<w.size)&&(m=b)):b.from>a&&c>b.from&&(c=b.from),w.type=="bookmark"&&b.from==a&&w.replacedWith&&(g=w)}if(m&&(m.from||0)==a){Gr(t,(m.to==null?u:m.to)-a,m.marker,m.from==null);if(m.to==null)return m.marker.find()}g&&!m&&Gr(t,0,g)}if(a>=u)break;var E=Math.min(u,c);for(;;){if(f){var S=a+f.length;if(!m){var x=S>E?f.slice(0,E-a):f;t.addToken(t,x,l?l+h:h,d,a+x.length==c?p:"",v)}if(S>=E){f=f.slice(E-a),a=E;break}a=S,d=""}f=i.slice(s,s=n[o++]),l=Xr(n[o++])}}}function Zr(e,t,n,r,i){function s(e){return n?n[e]:null}function o(e,n,r){Fr(e,n,r,i),Ii(e,"change",e,t)}var u=t.from,a=t.to,f=t.text,l=ai(e,u.line),c=ai(e,a.line),h=Qi(f),p=s(f.length-1),d=a.line-u.line;if(u.ch==0&&a.ch==0&&h==""){for(var v=0,m=f.length-1,g=[];v<m;++v)g.push(new jr(f[v],s(v),i));o(c,c.text,p),d&&e.remove(u.line,d),g.length&&e.insert(u.line,g)}else if(l==c)if(f.length==1)o(l,l.text.slice(0,u.ch)+h+l.text.slice(a.ch),p);else{for(var g=[],v=1,m=f.length-1;v<m;++v)g.push(new jr(f[v],s(v),i));g.push(new jr(h+l.text.slice(a.ch),p,i)),o(l,l.text.slice(0,u.ch)+f[0],s(0)),e.insert(u.line+1,g)}else if(f.length==1)o(l,l.text.slice(0,u.ch)+f[0]+c.text.slice(a.ch),s(0)),e.remove(u.line+1,d);else{o(l,l.text.slice(0,u.ch)+f[0],s(0)),o(c,h+c.text.slice(a.ch),p);for(var v=1,m=f.length-1,g=[];v<m;++v)g.push(new jr(f[v],s(v),i));d>1&&e.remove(u.line+1,d-1),e.insert(u.line+1,g)}Ii(e,"change",e,t),Pn(e,r.anchor,r.head,null,!0)}function ei(e){this.lines=e,this.parent=null;for(var t=0,n=e.length,r=0;t<n;++t)e[t].parent=this,r+=e[t].height;this.height=r}function ti(e){this.children=e;var t=0,n=0;for(var r=0,i=e.length;r<i;++r){var s=e[r];t+=s.chunkSize(),n+=s.height,s.parent=this}this.size=t,this.height=n,this.parent=null}function oi(e,t,n){function r(e,i,s){if(e.linked)for(var o=0;o<e.linked.length;++o){var u=e.linked[o];if(u.doc==i)continue;var a=s&&u.sharedHist;if(n&&!a)continue;t(u.doc,a),r(u.doc,e,a)}}r(e,null,!0)}function ui(e,t){if(t.cm)throw new Error("This document is already in use.");e.doc=t,t.cm=e,k(e),T(e),e.options.lineWrapping||D(e),e.options.mode=t.modeOption,_t(e)}function ai(e,t){t-=e.first;while(!e.lines)for(var n=0;;++n){var r=e.children[n],i=r.chunkSize();if(t<i){e=r;break}t-=i}return e.lines[t]}function fi(e,t,n){var r=[],i=t.line;return e.iter(t.line,n.line+1,function(e){var s=e.text;i==n.line&&(s=s.slice(0,n.ch)),i==t.line&&(s=s.slice(t.ch)),r.push(s),++i}),r}function li(e,t,n){var r=[];return e.iter(t,n,function(e){r.push(e.text)}),r}function ci(e,t){var n=t-e.height;for(var r=e;r;r=r.parent)r.height+=n}function hi(e){if(e.parent==null)return null;var t=e.parent,n=Yi(t.lines,e);for(var r=t.parent;r;t=r,r=r.parent)for(var i=0;;++i){if(r.children[i]==t)break;n+=r.children[i].chunkSize()}return n+t.first}function pi(e,t){var n=e.first;e:do{for(var r=0,i=e.children.length;r<i;++r){var s=e.children[r],o=s.height;if(t<o){e=s;continue e}t-=o,n+=s.chunkSize()}return n}while(!e.lines);for(var r=0,i=e.lines.length;r<i;++r){var u=e.lines[r],a=u.height;if(t<a)break;t-=a}return n+r}function di(e,t){t=Lr(e.doc,t);var n=0,r=t.parent;for(var i=0;i<r.lines.length;++i){var s=r.lines[i];if(s==t)break;n+=s.height}for(var o=r.parent;o;r=o,o=r.parent)for(var i=0;i<o.children.length;++i){var u=o.children[i];if(u==r)break;n+=u.height}return n}function vi(e){var t=e.order;return t==null&&(t=e.order=Hs(e.text)),t}function mi(e){return{done:[],undone:[],undoDepth:Infinity,lastTime:0,lastOp:null,lastOrigin:null,generation:e||1,maxGeneration:e||1}}function gi(e,t,n,r){var i=t["spans_"+e.id],s=0;e.iter(Math.max(e.first,n),Math.min(e.first+e.size,r),function(n){n.markedSpans&&((i||(i=t["spans_"+e.id]={}))[s]=n.markedSpans),++s})}function yi(e,t){var n={line:t.from.line,ch:t.from.ch},r={from:n,to:pn(t),text:fi(e,t.from,t.to)};return gi(e,r,t.from.line,t.to.line+1),oi(e,function(e){gi(e,r,t.from.line,t.to.line+1)},!0),r}function bi(e,t,n,r){var i=e.history;i.undone.length=0;var s=+(new Date),o=Qi(i.done);if(o&&(i.lastOp==r||i.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&e.cm&&i.lastTime>s-e.cm.options.historyEventDelay||t.origin.charAt(0)=="*"))){var u=Qi(o.changes);Nn(t.from,t.to)&&Nn(t.from,u.to)?u.to=pn(t):o.changes.push(yi(e,t)),o.anchorAfter=n.anchor,o.headAfter=n.head}else{o={changes:[yi(e,t)],generation:i.generation,anchorBefore:e.sel.anchor,headBefore:e.sel.head,anchorAfter:n.anchor,headAfter:n.head},i.done.push(o),i.generation=++i.maxGeneration;while(i.done.length>i.undoDepth)i.done.shift()}i.lastTime=s,i.lastOp=r,i.lastOrigin=t.origin}function wi(e){if(!e)return null;for(var t=0,n;t<e.length;++t)e[t].marker.explicitlyCleared?n||(n=e.slice(0,t)):n&&n.push(e[t]);return n?n.length?n:null:e}function Ei(e,t){var n=t["spans_"+e.id];if(!n)return null;for(var r=0,i=[];r<t.text.length;++r)i.push(wi(n[r]));return i}function Si(e,t){for(var n=0,r=[];n<e.length;++n){var i=e[n],s=i.changes,o=[];r.push({changes:o,anchorBefore:i.anchorBefore,headBefore:i.headBefore,anchorAfter:i.anchorAfter,headAfter:i.headAfter});for(var u=0;u<s.length;++u){var a=s[u],f;o.push({from:a.from,to:a.to,text:a.text});if(t)for(var l in a)(f=l.match(/^spans_(\d+)$/))&&Yi(t,Number(f[1]))>-1&&(Qi(o)[l]=a[l],delete a[l])}}return r}function xi(e,t,n,r){n<e.line?e.line+=r:t<e.line&&(e.line=t,e.ch=0)}function Ti(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i],o=!0;for(var u=0;u<s.changes.length;++u){var a=s.changes[u];s.copied||(a.from=kn(a.from),a.to=kn(a.to));if(n<a.from.line)a.from.line+=r,a.to.line+=r;else if(t<=a.to.line){o=!1;break}}s.copied||(s.anchorBefore=kn(s.anchorBefore),s.headBefore=kn(s.headBefore),s.anchorAfter=kn(s.anchorAfter),s.readAfter=kn(s.headAfter),s.copied=!0),o?(xi(s.anchorBefore),xi(s.headBefore),xi(s.anchorAfter),xi(s.headAfter)):(e.splice(0,i+1),i=0)}}function Ni(e,t){var n=t.from.line,r=t.to.line,i=t.text.length-(r-n)-1;Ti(e.done,n,r,i),Ti(e.undone,n,r,i)}function Ci(){Mi(this)}function ki(e){return e.stop||(e.stop=Ci),e}function Li(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function Ai(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function Oi(e){return e.defaultPrevented!=null?e.defaultPrevented:e.returnValue==0}function Mi(e){Li(e),Ai(e)}function _i(e){return e.target||e.srcElement}function Di(e){var t=e.which;return t==null&&(e.button&1?t=1:e.button&2?t=3:e.button&4&&(t=2)),v&&e.ctrlKey&&t==1&&(t=3),t}function Pi(e,t,n){if(e.addEventListener)e.addEventListener(t,n,!1);else if(e.attachEvent)e.attachEvent("on"+t,n);else{var r=e._handlers||(e._handlers={}),i=r[t]||(r[t]=[]);i.push(n)}}function Hi(e,t,n){if(e.removeEventListener)e.removeEventListener(t,n,!1);else if(e.detachEvent)e.detachEvent("on"+t,n);else{var r=e._handlers&&e._handlers[t];if(!r)return;for(var i=0;i<r.length;++i)if(r[i]==n){r.splice(i,1);break}}}function Bi(e,t){var n=e._handlers&&e._handlers[t];if(!n)return;var r=Array.prototype.slice.call(arguments,2);for(var i=0;i<n.length;++i)n[i].apply(null,r)}function Ii(e,t){function i(e){return function(){e.apply(null,r)}}var n=e._handlers&&e._handlers[t];if(!n)return;var r=Array.prototype.slice.call(arguments,2);ji||(++Fi,ji=[],setTimeout(Ri,0));for(var s=0;s<n.length;++s)ji.push(i(n[s]))}function qi(e,t,n){return Bi(e,n||t.type,e,t),Oi(t)||t.codemirrorIgnore}function Ri(){--Fi;var e=ji;ji=null;for(var t=0;t<e.length;++t)e[t]()}function Ui(e,t){var n=e._handlers&&e._handlers[t];return n&&n.length>0}function zi(e){e.prototype.on=function(e,t){Pi(this,e,t)},e.prototype.off=function(e,t){Hi(this,e,t)}}function Vi(){this.id=null}function $i(e,t,n,r,i){t==null&&(t=e.search(/[^\s\u00a0]/),t==-1&&(t=e.length));for(var s=r||0,o=i||0;s<t;++s)e.charAt(s)=="	"?o+=n-o%n:++o;return o}function Ki(e){while(Ji.length<=e)Ji.push(Qi(Ji)+" ");return Ji[e]}function Qi(e){return e[e.length-1]}function Gi(e){if(p)e.selectionStart=0,e.selectionEnd=e.value.length;else try{e.select()}catch(t){}}function Yi(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0,r=e.length;n<r;++n)if(e[n]==t)return n;return-1}function Zi(e,t){function n(){}n.prototype=e;var r=new n;return t&&es(t,r),r}function es(e,t){t||(t={});for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function ts(e){for(var t=[],n=0;n<e;++n)t.push(undefined);return t}function ns(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function is(e){return/\w/.test(e)||e>"Â€"&&(e.toUpperCase()!=e.toLowerCase()||rs.test(e))}function ss(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return!1;return!0}function us(e,t,n,r){var i=document.createElement(e);n&&(i.className=n),r&&(i.style.cssText=r);if(typeof t=="string")ls(i,t);else if(t)for(var s=0;s<t.length;++s)i.appendChild(t[s]);return i}function as(e){for(var t=e.childNodes.length;t>0;--t)e.removeChild(e.firstChild);return e}function fs(e,t){return as(e).appendChild(t)}function ls(e,t){r?(e.innerHTML="",e.appendChild(document.createTextNode(t))):e.textContent=t}function cs(e){return e.getBoundingClientRect()}function ps(){return!1}function vs(e){if(ds!=null)return ds;var t=us("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");return fs(e,t),t.offsetWidth&&(ds=t.offsetHeight-t.clientHeight),ds||0}function gs(e){if(ms==null){var t=us("span","â€‹");fs(e,us("span",[t,document.createTextNode("x")])),e.firstChild.offsetHeight!=0&&(ms=t.offsetWidth<=1&&t.offsetHeight>2&&!n)}return ms?us("span","â€‹"):us("span","Â ",null,"display: inline-block; width: 1px; margin-right: -1px")}function Ss(e,t,n,r){if(!e)return r(t,n,"ltr");var i=!1;for(var s=0;s<e.length;++s){var o=e[s];if(o.from<n&&o.to>t||t==n&&o.to==t)r(Math.max(o.from,t),Math.min(o.to,n),o.level==1?"rtl":"ltr"),i=!0}i||r(t,n,"ltr")}function xs(e){return e.level%2?e.to:e.from}function Ts(e){return e.level%2?e.from:e.to}function Ns(e){var t=vi(e);return t?xs(t[0]):0}function Cs(e){var t=vi(e);return t?Ts(Qi(t)):e.text.length}function ks(e,t){var n=ai(e.doc,t),r=Lr(e.doc,n);r!=n&&(t=hi(r));var i=vi(r),s=i?i[0].level%2?Cs(r):Ns(r):0;return Tn(t,s)}function Ls(e,t){var n,r;while(n=kr(r=ai(e.doc,t)))t=n.find().to.line;var i=vi(r),s=i?i[0].level%2?Ns(r):Cs(r):r.text.length;return Tn(t,s)}function As(e,t,n){var r=e[0].level;return t==r?!0:n==r?!1:t<n}function Ms(e,t){for(var n=0,r;n<e.length;++n){var i=e[n];if(i.from<t&&i.to>t)return Os=null,n;if(i.from==t||i.to==t){if(r!=null)return As(e,i.level,e[r].level)?(Os=r,n):(Os=n,r);r=n}}return Os=null,r}function _s(e,t,n,r){if(!r)return t+n;do t+=n;while(t>0&&os.test(e.text.charAt(t)));return t}function Ds(e,t,n,r){var i=vi(e);if(!i)return Ps(e,t,n,r);var s=Ms(i,t),o=i[s],u=_s(e,t,o.level%2?-n:n,r);for(;;){if(u>o.from&&u<o.to)return u;if(u==o.from||u==o.to)return Ms(i,u)==s?u:(o=i[s+=n],n>0==o.level%2?o.to:o.from);o=i[s+=n];if(!o)return null;n>0==o.level%2?u=_s(e,o.to,-1,r):u=_s(e,o.from,1,r)}}function Ps(e,t,n,r){var i=t+n;if(r)while(i>0&&os.test(e.text.charAt(i)))i+=n;return i<0||i>e.text.length?null:i}var e=/gecko\/\d/i.test(navigator.userAgent),t=/MSIE \d/.test(navigator.userAgent),n=t&&(document.documentMode==null||document.documentMode<8),r=t&&(document.documentMode==null||document.documentMode<9),i=/WebKit\//.test(navigator.userAgent),s=i&&/Qt\/\d+\.\d+/.test(navigator.userAgent),o=/Chrome\//.test(navigator.userAgent),u=/Opera\//.test(navigator.userAgent),a=/Apple Computer/.test(navigator.vendor),f=/KHTML\//.test(navigator.userAgent),l=/Mac OS X 1\d\D([7-9]|\d\d)\D/.test(navigator.userAgent),c=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent),h=/PhantomJS/.test(navigator.userAgent),p=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent),d=p||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent),v=p||/Mac/.test(navigator.platform),m=/windows/i.test(navigator.platform),g=u&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);g&&(g=Number(g[1])),g&&g>=15&&(u=!1,i=!0);var y=v&&(s||u&&(g==null||g<12.11)),b=e||t&&!r,w=!1,E=!1,xt,Ct=0,Ut,zt,Vt=0,Gt=0,Yt=null;t?Yt=-0.53:e?Yt=15:o?Yt=-0.7:a&&(Yt=-1/3);var nn,on=null,cn,pn=S.changeEnd=function(e){return e.text?Tn(e.from.line+e.text.length-1,Qi(e.text).length+(e.text.length==1?e.from.ch:0)):e.to};S.Pos=Tn,S.prototype={constructor:S,focus:function(){window.focus(),jt(this),fn(this),Pt(this)},setOption:function(e,t){var n=this.options,r=n[e];if(n[e]==t&&e!="mode")return;n[e]=t,Kn.hasOwnProperty(e)&&At(this,Kn[e])(this,t,r)},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](e)},removeKeyMap:function(e){var t=this.state.keyMaps;for(var n=0;n<t.length;++n)if(t[n]==e||typeof t[n]!="string"&&t[n].name==e)return t.splice(n,1),!0},addOverlay:At(null,function(e,t){var n=e.token?e:S.getMode(this.options,e);if(n.startState)throw new Error("Overlays may not be stateful.");this.state.overlays.push({mode:n,modeSpec:e,opaque:t&&t.opaque}),this.state.modeGen++,_t(this)}),removeOverlay:At(null,function(e){var t=this.state.overlays;for(var n=0;n<t.length;++n){var r=t[n].modeSpec;if(r==e||typeof e=="string"&&r.name==e){t.splice(n,1),this.state.modeGen++,_t(this);return}}}),indentLine:At(null,function(e,t,n){typeof t!="string"&&typeof t!="number"&&(t==null?t=this.options.smartIndent?"smart":"prev":t=t?"add":"subtract"),Mn(this.doc,e)&&zn(this,e,t,n)}),indentSelection:At(null,function(e){var t=this.doc.sel;if(Nn(t.from,t.to))return zn(this,t.from.line,e);var n=t.to.line-(t.to.ch?0:1);for(var r=t.from.line;r<=n;++r)zn(this,r,e)}),getTokenAt:function(e,t){var n=this.doc;e=An(n,e);var r=rt(this,e.line,t),i=this.doc.mode,s=ai(n,e.line),o=new hr(s.text,this.options.tabSize);while(o.pos<e.ch&&!o.eol()){o.start=o.pos;var u=i.token(o,r)}return{start:o.start,end:o.pos,string:o.current(),className:u||null,type:u||null,state:r}},getTokenTypeAt:function(e){e=An(this.doc,e);var t=Ur(this,ai(this.doc,e.line)),n=0,r=(t.length-1)/2,i=e.ch;if(i==0)return t[2];for(;;){var s=n+r>>1;if((s?t[s*2-1]:0)>=i)r=s;else{if(!(t[s*2+1]<i))return t[s*2+2];n=s+1}}},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?S.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){if(!rr.hasOwnProperty(t))return;var n=rr[t],r=this.getModeAt(e);return r[t]&&n[r[t]]||r.helperType&&n[r.helperType]||n[r.name]},getStateAfter:function(e,t){var n=this.doc;return e=Ln(n,e==null?n.first+n.size-1:e),rt(this,e+1,t)},cursorCoords:function(e,t){var n,r=this.doc.sel;return e==null?n=r.head:typeof e=="object"?n=An(this.doc,e):n=e?r.from:r.to,bt(this,n,t||"page")},charCoords:function(e,t){return yt(this,An(this.doc,e),t||"page")},coordsChar:function(e,t){return e=gt(this,e,t||"page"),Et(this,e.left,e.top)},lineAtHeight:function(e,t){return e=gt(this,{top:e,left:0},t||"page").top,pi(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t){var n=!1,r=this.doc.first+this.doc.size-1;e<this.doc.first?e=this.doc.first:e>r&&(e=r,n=!0);var i=ai(this.doc,e);return mt(this,ai(this.doc,e),{top:0,left:0},t||"page").top+(n?i.height:0)},defaultTextHeight:function(){return Tt(this.display)},defaultCharWidth:function(){return Nt(this.display)},setGutterMarker:At(null,function(e,t,n){return Wn(this,e,function(e){var r=e.gutterMarkers||(e.gutterMarkers={});return r[t]=n,!n&&ss(r)&&(e.gutterMarkers=null),!0})}),clearGutter:At(null,function(e){var t=this,n=t.doc,r=n.first;n.iter(function(n){n.gutterMarkers&&n.gutterMarkers[e]&&(n.gutterMarkers[e]=null,_t(t,r,r+1),ss(n.gutterMarkers)&&(n.gutterMarkers=null)),++r})}),addLineClass:At(null,function(e,t,n){return Wn(this,e,function(e){var r=t=="text"?"textClass":t=="background"?"bgClass":"wrapClass";if(!e[r])e[r]=n;else{if((new RegExp("(?:^|\\s)"+n+"(?:$|\\s)")).test(e[r]))return!1;e[r]+=" "+n}return!0})}),removeLineClass:At(null,function(e,t,n){return Wn(this,e,function(e){var r=t=="text"?"textClass":t=="background"?"bgClass":"wrapClass",i=e[r];if(!i)return!1;if(n==null)e[r]=null;else{var s=i.match(new RegExp("(?:^|\\s+)"+n+"(?:$|\\s+)"));if(!s)return!1;var o=s.index+s[0].length;e[r]=i.slice(0,s.index)+(!s.index||o==i.length?"":" ")+i.slice(o)||null}return!0})}),addLineWidget:At(null,function(e,t,n){return Br(this,e,t,n)}),removeLineWidget:function(e){e.clear()},lineInfo:function(e){if(typeof e=="number"){if(!Mn(this.doc,e))return null;var t=e;e=ai(this.doc,e);if(!e)return null}else{var t=hi(e);if(t==null)return null}return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},getViewport:function(){return{from:this.display.showingFrom,to:this.display.showingTo}},addWidget:function(e,t,n,r,i){var s=this.display;e=bt(this,An(this.doc,e));var o=e.bottom,u=e.left;t.style.position="absolute",s.sizer.appendChild(t);if(r=="over")o=e.top;else if(r=="above"||r=="near"){var a=Math.max(s.wrapper.clientHeight,this.doc.height),f=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth);(r=="above"||e.bottom+t.offsetHeight>a)&&e.top>t.offsetHeight?o=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=a&&(o=e.bottom),u+t.offsetWidth>f&&(u=f-t.offsetWidth)}t.style.top=o+"px",t.style.left=t.style.right="",i=="right"?(u=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):(i=="left"?u=0:i=="middle"&&(u=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=u+"px"),n&&In(this,u,o,u+t.offsetWidth,o+t.offsetHeight)},triggerOnKeyDown:At(null,un),execCommand:function(e){return or[e](this)},findPosH:function(e,t,n,r){var i=1;t<0&&(i=-1,t=-t);for(var s=0,o=An(this.doc,e);s<t;++s){o=Xn(this.doc,o,i,n,r);if(o.hitSide)break}return o},moveH:At(null,function(e,t){var n=this.doc.sel,r;n.shift||n.extend||Nn(n.from,n.to)?r=Xn(this.doc,n.head,e,t,this.options.rtlMoveVisually):r=e<0?n.from:n.to,_n(this.doc,r,r,e)}),deleteH:At(null,function(e,t){var n=this.doc.sel;Nn(n.from,n.to)?xn(this.doc,"",n.from,Xn(this.doc,n.head,e,t,!1),"+delete"):xn(this.doc,"",n.from,n.to,"+delete"),this.curOp.userSelChange=!0}),findPosV:function(e,t,n,r){var i=1,s=r;t<0&&(i=-1,t=-t);for(var o=0,u=An(this.doc,e);o<t;++o){var a=bt(this,u,"div");s==null?s=a.left:a.left=s,u=Vn(this,a,i,n);if(u.hitSide)break}return u},moveV:At(null,function(e,t){var n=this.doc.sel,r=bt(this,n.head,"div");n.goalColumn!=null&&(r.left=n.goalColumn);var i=Vn(this,r,e,t);t=="page"&&Un(this,0,yt(this,i,"div").top-r.top),_n(this.doc,i,i,e),n.goalColumn=r.left}),toggleOverwrite:function(e){if(e!=null&&e==this.state.overwrite)return;(this.state.overwrite=!this.state.overwrite)?this.display.cursor.className+=" CodeMirror-overwrite":this.display.cursor.className=this.display.cursor.className.replace(" CodeMirror-overwrite","")},hasFocus:function(){return this.state.focused},scrollTo:At(null,function(e,t){Rn(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller,t=Wi;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-t,width:e.scrollWidth-t,clientHeight:e.clientHeight-t,clientWidth:e.clientWidth-t}},scrollIntoView:At(null,function(e,t){typeof e=="number"&&(e=Tn(e,0)),t||(t=0);var n=e;if(!e||e.line!=null)this.curOp.scrollToPos=e?An(this.doc,e):this.doc.sel.head,this.curOp.scrollToPosMargin=t,n=bt(this,this.curOp.scrollToPos);var r=qn(this,n.left,n.top-t,n.right,n.bottom+t);Rn(this,r.scrollLeft,r.scrollTop)}),setSize:At(null,function(e,t){function n(e){return typeof e=="number"||/^\d+$/.test(String(e))?e+"px":e}e!=null&&(this.display.wrapper.style.width=n(e)),t!=null&&(this.display.wrapper.style.height=n(t)),this.options.lineWrapping&&(this.display.measureLineCache.length=this.display.measureLineCachePos=0),this.curOp.forceUpdate=!0}),operation:function(e){return Mt(this,e)},refresh:At(null,function(){pt(this),Rn(this,this.doc.scrollLeft,this.doc.scrollTop),_t(this)}),swapDoc:At(null,function(e){var t=this.doc;return t.cm=null,ui(this,e),pt(this),Bt(this,!0),Rn(this,e.scrollLeft,e.scrollTop),t}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},zi(S);var Kn=S.optionHandlers={},Qn=S.defaults={},Yn=S.Init={toString:function(){return"CodeMirror.Init"}};Gn("value","",function(e,t){e.setValue(t)},!0),Gn("mode",null,function(e,t){e.doc.modeOption=t,T(e)},!0),Gn("indentUnit",2,T,!0),Gn("indentWithTabs",!1),Gn("smartIndent",!0),Gn("tabSize",4,function(e){T(e),pt(e),_t(e)},!0),Gn("electricChars",!0),Gn("rtlMoveVisually",!m),Gn("theme","default",function(e){A(e),O(e)},!0),Gn("keyMap","default",L),Gn("extraKeys",null),Gn("onKeyEvent",null),Gn("onDragEvent",null),Gn("lineWrapping",!1,N,!0),Gn("gutters",[],function(e){P(e.options),O(e)},!0),Gn("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?q(e.display)+"px":"0",e.refresh()},!0),Gn("coverGutterNextToScrollbar",!1,H,!0),Gn("lineNumbers",!1,function(e){P(e.options),O(e)},!0),Gn("firstLineNumber",1,O,!0),Gn("lineNumberFormatter",function(e){return e},O,!0),Gn("showCursorWhenSelecting",!1,Q,!0),Gn("readOnly",!1,function(e,t){t=="nocursor"?(ln(e),e.display.input.blur()):t||Bt(e,!0)}),Gn("dragDrop",!0),Gn("cursorBlinkRate",530),Gn("cursorScrollMargin",0),Gn("cursorHeight",1),Gn("workTime",100),Gn("workDelay",100),Gn("flattenSpans",!0),Gn("pollInterval",100),Gn("undoDepth",40,function(e,t){e.doc.history.undoDepth=t}),Gn("historyEventDelay",500),Gn("viewportMargin",10,function(e){e.refresh()},!0),Gn("maxHighlightLength",1e4,function(e){T(e),e.refresh()},!0),Gn("moveInputWithCursor",!0,function(e,t){t||(e.display.inputDiv.style.top=e.display.inputDiv.style.left=0)}),Gn("tabindex",null,function(e,t){e.display.input.tabIndex=t||""}),Gn("autofocus",null);var Zn=S.modes={},er=S.mimeModes={};S.defineMode=function(e,t){!S.defaults.mode&&e!="null"&&(S.defaults.mode=e);if(arguments.length>2){t.dependencies=[];for(var n=2;n<arguments.length;++n)t.dependencies.push(arguments[n])}Zn[e]=t},S.defineMIME=function(e,t){er[e]=t},S.resolveMode=function(e){if(typeof e=="string"&&er.hasOwnProperty(e))e=er[e];else if(e&&typeof e.name=="string"&&er.hasOwnProperty(e.name)){var t=er[e.name];e=Zi(t,e),e.name=t.name}else if(typeof e=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return S.resolveMode("application/xml");return typeof e=="string"?{name:e}:e||{name:"null"}},S.getMode=function(e,t){var t=S.resolveMode(t),n=Zn[t.name];if(!n)return S.getMode(e,"text/plain");var r=n(e,t);if(tr.hasOwnProperty(t.name)){var i=tr[t.name];for(var s in i){if(!i.hasOwnProperty(s))continue;r.hasOwnProperty(s)&&(r["_"+s]=r[s]),r[s]=i[s]}}return r.name=t.name,r},S.defineMode("null",function(){return{token:function(e){e.skipToEnd()}}}),S.defineMIME("text/plain","null");var tr=S.modeExtensions={};S.extendMode=function(e,t){var n=tr.hasOwnProperty(e)?tr[e]:tr[e]={};es(t,n)},S.defineExtension=function(e,t){S.prototype[e]=t},S.defineDocExtension=function(e,t){ri.prototype[e]=t},S.defineOption=Gn;var nr=[];S.defineInitHook=function(e){nr.push(e)};var rr=S.helpers={};S.registerHelper=function(e,t,n){rr.hasOwnProperty(e)||(rr[e]=S[e]={}),rr[e][t]=n},S.isWordChar=is,S.copyState=ir,S.startState=sr,S.innerMode=function(e,t){while(e.innerMode){var n=e.innerMode(t);if(!n||n.mode==e)break;t=n.state,e=n.mode}return n||{mode:e,state:t}};var or=S.commands={selectAll:function(e){e.setSelection(Tn(e.firstLine(),0),Tn(e.lastLine()))},killLine:function(e){var t=e.getCursor(!0),n=e.getCursor(!1),r=!Nn(t,n);!r&&e.getLine(t.line).length==t.ch?e.replaceRange("",t,Tn(t.line+1,0),"+delete"):e.replaceRange("",t,r?n:Tn(t.line),"+delete")},deleteLine:function(e){var t=e.getCursor().line;e.replaceRange("",Tn(t,0),Tn(t),"+delete")},delLineLeft:function(e){var t=e.getCursor();e.replaceRange("",Tn(t.line,0),t,"+delete")},undo:function(e){e.undo()},redo:function(e){e.redo()},goDocStart:function(e){e.extendSelection(Tn(e.firstLine(),0))},goDocEnd:function(e){e.extendSelection(Tn(e.lastLine()))},goLineStart:function(e){e.extendSelection(ks(e,e.getCursor().line))},goLineStartSmart:function(e){var t=e.getCursor(),n=ks(e,t.line),r=e.getLineHandle(n.line),i=vi(r);if(!i||i[0].level==0){var s=Math.max(0,r.text.search(/\S/)),o=t.line==n.line&&t.ch<=s&&t.ch;e.extendSelection(Tn(n.line,o?0:s))}else e.extendSelection(n)},goLineEnd:function(e){e.extendSelection(Ls(e,e.getCursor().line))},goLineRight:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:e.display.lineDiv.offsetWidth+100,top:t},"div"))},goLineLeft:function(e){var t=e.charCoords(e.getCursor(),"div").top+5;e.extendSelection(e.coordsChar({left:0,top:t},"div"))},goLineUp:function(e){e.moveV(-1,"line")},goLineDown:function(e){e.moveV(1,"line")},goPageUp:function(e){e.moveV(-1,"page")},goPageDown:function(e){e.moveV(1,"page")},goCharLeft:function(e){e.moveH(-1,"char")},goCharRight:function(e){e.moveH(1,"char")},goColumnLeft:function(e){e.moveH(-1,"column")},goColumnRight:function(e){e.moveH(1,"column")},goWordLeft:function(e){e.moveH(-1,"word")},goGroupRight:function(e){e.moveH(1,"group")},goGroupLeft:function(e){e.moveH(-1,"group")},goWordRight:function(e){e.moveH(1,"word")},delCharBefore:function(e){e.deleteH(-1,"char")},delCharAfter:function(e){e.deleteH(1,"char")},delWordBefore:function(e){e.deleteH(-1,"word")},delWordAfter:function(e){e.deleteH(1,"word")},delGroupBefore:function(e){e.deleteH(-1,"group")},delGroupAfter:function(e){e.deleteH(1,"group")},indentAuto:function(e){e.indentSelection("smart")},indentMore:function(e){e.indentSelection("add")},indentLess:function(e){e.indentSelection("subtract")},insertTab:function(e){e.replaceSelection("	","end","+input")},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection("	","end","+input")},transposeChars:function(e){var t=e.getCursor(),n=e.getLine(t.line);t.ch>0&&t.ch<n.length-1&&e.replaceRange(n.charAt(t.ch)+n.charAt(t.ch-1),Tn(t.line,t.ch-1),Tn(t.line,t.ch+1))},newlineAndIndent:function(e){At(e,function(){e.replaceSelection("\n","end","+input"),e.indentLine(e.getCursor().line,null,!0)})()},toggleOverwrite:function(e){e.toggleOverwrite()}},ur=S.keyMap={};ur.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite"},ur.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Alt-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore",fallthrough:"basic"},ur.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft",fallthrough:["basic","emacsy"]},ur["default"]=v?ur.macDefault:ur.pcDefault,ur.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"},S.lookupKey=fr,S.isModifierKey=lr,S.keyName=cr,S.fromTextArea=function(e,t){function i(){e.value=a.getValue()}t||(t={}),t.value=e.value,!t.tabindex&&e.tabindex&&(t.tabindex=e.tabindex),!t.placeholder&&e.placeholder&&(t.placeholder=e.placeholder);if(t.autofocus==null){var n=document.body;try{n=document.activeElement}catch(r){}t.autofocus=n==e||e.getAttribute("autofocus")!=null&&n==document.body}if(e.form){Pi(e.form,"submit",i);if(!t.leaveSubmitMethodAlone){var s=e.form,o=s.submit;try{var u=s.submit=function(){i(),s.submit=o,s.submit(),s.submit=u}}catch(r){}}}e.style.display="none";var a=S(function(t){e.parentNode.insertBefore(t,e.nextSibling)},t);return a.save=i,a.getTextArea=function(){return e},a.toTextArea=function(){i(),e.parentNode.removeChild(a.getWrapperElement()),e.style.display="",e.form&&(Hi(e.form,"submit",i),typeof e.form.submit=="function"&&(e.form.submit=o))},a},hr.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==0},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},eat:function(e){var t=this.string.charAt(this.pos);if(typeof e=="string")var n=t==e;else var n=t&&(e.test?e.test(t):e(t));if(n)return++this.pos,t},eatWhile:function(e){var t=this.pos;while(this.eat(e));return this.pos>t},eatSpace:function(){var e=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos)))++this.pos;return this.pos>e},skipToEnd:function(){this.pos=this.string.length},skipTo:function(e){var t=this.string.indexOf(e,this.pos);if(t>-1)return this.pos=t,!0},backUp:function(e){this.pos-=e},column:function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=$i(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue},indentation:function(){return $i(this.string,null,this.tabSize)},match:function(e,t,n){if(typeof e!="string"){var s=this.string.slice(this.pos).match(e);return s&&s.index>0?null:(s&&t!==!1&&(this.pos+=s[0].length),s)}var r=function(e){return n?e.toLowerCase():e},i=this.string.substr(this.pos,e.length);if(r(i)==r(e))return t!==!1&&(this.pos+=e.length),!0},current:function(){return this.string.slice(this.start,this.pos)}},S.StringStream=hr,S.TextMarker=pr,zi(pr),pr.prototype.clear=function(){if(this.explicitlyCleared)return;var e=this.doc.cm,t=e&&!e.curOp;t&&kt(e);if(Ui(this,"clear")){var n=this.find();n&&Ii(this,"clear",n.from,n.to)}var r=null,i=null;for(var s=0;s<this.lines.length;++s){var o=this.lines[s],u=gr(o.markedSpans,this);u.to!=null&&(i=hi(o)),o.markedSpans=yr(o.markedSpans,u),u.from!=null?r=hi(o):this.collapsed&&!Ar(this.doc,o)&&e&&ci(o,Tt(e.display))}if(e&&this.collapsed&&!e.options.lineWrapping)for(var s=0;s<this.lines.length;++s){var a=Lr(e.doc,this.lines[s]),f=_(e.doc,a);f>e.display.maxLineLength&&(e.display.maxLine=a,e.display.maxLineLength=f,e.display.maxLineChanged=!0)}r!=null&&e&&_t(e,r,i+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e&&Hn(e)),t&&Lt(e)},pr.prototype.find=function(){var e,t;for(var n=0;n<this.lines.length;++n){var r=this.lines[n],i=gr(r.markedSpans,this);if(i.from!=null||i.to!=null){var s=hi(r);i.from!=null&&(e=Tn(s,i.from)),i.to!=null&&(t=Tn(s,i.to))}}return this.type=="bookmark"?e:e&&{
from:e,to:t}},pr.prototype.changed=function(){var e=this.find(),t=this.doc.cm;if(!e||!t)return;var n=ai(this.doc,e.from.line);ft(t,n);if(e.from.line>=t.display.showingFrom&&e.from.line<t.display.showingTo){for(var r=t.display.lineDiv.firstChild;r;r=r.nextSibling)if(r.lineObj==n){r.offsetHeight!=n.height&&ci(n,r.offsetHeight);break}Mt(t,function(){t.curOp.selectionChanged=t.curOp.forceUpdate=t.curOp.updateMaxLine=!0})}},pr.prototype.attachLine=function(e){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(!t.maybeHiddenMarkers||Yi(t.maybeHiddenMarkers,this)==-1)&&(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(e)},pr.prototype.detachLine=function(e){this.lines.splice(Yi(this.lines,e),1);if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},S.SharedTextMarker=vr,zi(vr),vr.prototype.clear=function(){if(this.explicitlyCleared)return;this.explicitlyCleared=!0;for(var e=0;e<this.markers.length;++e)this.markers[e].clear();Ii(this,"clear")},vr.prototype.find=function(){return this.primary.find()};var Dr=S.LineWidget=function(e,t,n){if(n)for(var r in n)n.hasOwnProperty(r)&&(this[r]=n[r]);this.cm=e,this.node=t};zi(Dr),Dr.prototype.clear=Pr(function(){var e=this.line.widgets,t=hi(this.line);if(t==null||!e)return;for(var n=0;n<e.length;++n)e[n]==this&&e.splice(n--,1);e.length||(this.line.widgets=null);var r=di(this.cm,this.line)<this.cm.doc.scrollTop;ci(this.line,Math.max(0,this.line.height-Hr(this))),r&&Un(this.cm,0,-this.height),_t(this.cm,t,t+1)}),Dr.prototype.changed=Pr(function(){var e=this.height;this.height=null;var t=Hr(this)-e;if(!t)return;ci(this.line,this.line.height+t);var n=hi(this.line);_t(this.cm,n,n+1)});var jr=S.Line=function(e,t,n){this.text=e,_r(this,t),this.height=n?n(this):1};zi(jr);var Wr={},$r=/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\uFEFF]/g;ei.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var n=e,r=e+t;n<r;++n){var i=this.lines[n];this.height-=i.height,Ir(i),Ii(i,"delete")}this.lines.splice(e,t)},collapse:function(e){e.splice.apply(e,[e.length,0].concat(this.lines))},insertInner:function(e,t,n){this.height+=n,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e));for(var r=0,i=t.length;r<i;++r)t[r].parent=this},iterN:function(e,t,n){for(var r=e+t;e<r;++e)if(n(this.lines[e]))return!0}},ti.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){this.size-=t;for(var n=0;n<this.children.length;++n){var r=this.children[n],i=r.chunkSize();if(e<i){var s=Math.min(t,i-e),o=r.height;r.removeInner(e,s),this.height-=o-r.height,i==s&&(this.children.splice(n--,1),r.parent=null);if((t-=s)==0)break;e=0}else e-=i}if(this.size-t<25){var u=[];this.collapse(u),this.children=[new ei(u)],this.children[0].parent=this}},collapse:function(e){for(var t=0,n=this.children.length;t<n;++t)this.children[t].collapse(e)},insertInner:function(e,t,n){this.size+=t.length,this.height+=n;for(var r=0,i=this.children.length;r<i;++r){var s=this.children[r],o=s.chunkSize();if(e<=o){s.insertInner(e,t,n);if(s.lines&&s.lines.length>50){while(s.lines.length>50){var u=s.lines.splice(s.lines.length-25,25),a=new ei(u);s.height-=a.height,this.children.splice(r+1,0,a),a.parent=this}this.maybeSpill()}break}e-=o}},maybeSpill:function(){if(this.children.length<=10)return;var e=this;do{var t=e.children.splice(e.children.length-5,5),n=new ti(t);if(!e.parent){var r=new ti(e.children);r.parent=e,e.children=[r,n],e=r}else{e.size-=n.size,e.height-=n.height;var i=Yi(e.parent.children,e);e.parent.children.splice(i+1,0,n)}n.parent=e.parent}while(e.children.length>10);e.parent.maybeSpill()},iterN:function(e,t,n){for(var r=0,i=this.children.length;r<i;++r){var s=this.children[r],o=s.chunkSize();if(e<o){var u=Math.min(t,o-e);if(s.iterN(e,u,n))return!0;if((t-=u)==0)break;e=0}else e-=o}}};var ni=0,ri=S.Doc=function(e,t,n){if(!(this instanceof ri))return new ri(e,t,n);n==null&&(n=0),ti.call(this,[new ei([new jr("",null)])]),this.first=n,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.history=mi(),this.cleanGeneration=1,this.frontier=n;var r=Tn(n,0);this.sel={from:r,to:r,head:r,anchor:r,shift:!1,extend:!1,goalColumn:null},this.id=++ni,this.modeOption=t,typeof e=="string"&&(e=ys(e)),Zr(this,{from:r,to:r,text:e},null,{head:r,anchor:r})};ri.prototype=Zi(ti.prototype,{constructor:ri,iter:function(e,t,n){n?this.iterN(e-this.first,t-e,n):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){var n=0;for(var r=0,i=t.length;r<i;++r)n+=t[r].height;this.insertInner(e-this.first,t,n)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=li(this,this.first,this.first+this.size);return e===!1?t:t.join(e||"\n")},setValue:function(e){var t=Tn(this.first,0),n=this.first+this.size-1;gn(this,{from:t,to:Tn(n,ai(this,n).text.length),text:ys(e),origin:"setValue"},{head:t,anchor:t},!0)},replaceRange:function(e,t,n,r){t=An(this,t),n=n?An(this,n):t,xn(this,e,t,n,r)},getRange:function(e,t,n){var r=fi(this,An(this,e),An(this,t));return n===!1?r:r.join(n||"\n")},getLine:function(e){var t=this.getLineHandle(e);return t&&t.text},setLine:function(e,t){Mn(this,e)&&xn(this,t,Tn(e,0),An(this,Tn(e)))},removeLine:function(e){e?xn(this,"",An(this,Tn(e-1)),An(this,Tn(e))):xn(this,"",Tn(0,0),An(this,Tn(1,0)))},getLineHandle:function(e){if(Mn(this,e))return ai(this,e)},getLineNumber:function(e){return hi(e)},getLineHandleVisualStart:function(e){return typeof e=="number"&&(e=ai(this,e)),Lr(this,e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return An(this,e)},getCursor:function(e){var t=this.sel,n;return e==null||e=="head"?n=t.head:e=="anchor"?n=t.anchor:e=="end"||e===!1?n=t.to:n=t.from,kn(n)},somethingSelected:function(){return!Nn(this.sel.head,this.sel.anchor)},setCursor:Ot(function(e,t,n){var r=An(this,typeof e=="number"?Tn(e,t||0):e);n?_n(this,r):Pn(this,r,r)}),setSelection:Ot(function(e,t){Pn(this,An(this,e),An(this,t||e))}),extendSelection:Ot(function(e,t){_n(this,An(this,e),t&&An(this,t))}),getSelection:function(e){return this.getRange(this.sel.from,this.sel.to,e)},replaceSelection:function(e,t,n){gn(this,{from:this.sel.from,to:this.sel.to,text:ys(e),origin:n},t||"around")},undo:Ot(function(){bn(this,"undo")}),redo:Ot(function(){bn(this,"redo")}),setExtending:function(e){this.sel.extend=e},historySize:function(){var e=this.history;return{undo:e.done.length,redo:e.undone.length}},clearHistory:function(){this.history=mi(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration()},changeGeneration:function(){return this.history.lastOp=this.history.lastOrigin=null,this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:Si(this.history.done),undone:Si(this.history.undone)}},setHistory:function(e){var t=this.history=mi(this.history.maxGeneration);t.done=e.done.slice(0),t.undone=e.undone.slice(0)},markText:function(e,t,n){return dr(this,An(this,e),An(this,t),n,"range")},setBookmark:function(e,t){var n={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft};return e=An(this,e),dr(this,e,e,n,"bookmark")},findMarksAt:function(e){e=An(this,e);var t=[],n=ai(this,e.line).markedSpans;if(n)for(var r=0;r<n.length;++r){var i=n[r];(i.from==null||i.from<=e.ch)&&(i.to==null||i.to>=e.ch)&&t.push(i.marker.parent||i.marker)}return t},getAllMarks:function(){var e=[];return this.iter(function(t){var n=t.markedSpans;if(n)for(var r=0;r<n.length;++r)n[r].from!=null&&e.push(n[r].marker)}),e},posFromIndex:function(e){var t,n=this.first;return this.iter(function(r){var i=r.text.length+1;if(i>e)return t=e,!0;e-=i,++n}),An(this,Tn(n,t))},indexFromPos:function(e){e=An(this,e);var t=e.ch;return e.line<this.first||e.ch<0?0:(this.iter(this.first,e.line,function(e){t+=e.text.length+1}),t)},copy:function(e){var t=new ri(li(this,this.first,this.first+this.size),this.modeOption,this.first);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel={from:this.sel.from,to:this.sel.to,head:this.sel.head,anchor:this.sel.anchor,shift:this.sel.shift,extend:!1,goalColumn:this.sel.goalColumn},e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){e||(e={});var t=this.first,n=this.first+this.size;e.from!=null&&e.from>t&&(t=e.from),e.to!=null&&e.to<n&&(n=e.to);var r=new ri(li(this,t,n),e.mode||this.modeOption,t);return e.sharedHist&&(r.history=this.history),(this.linked||(this.linked=[])).push({doc:r,sharedHist:e.sharedHist}),r.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}],r},unlinkDoc:function(e){e instanceof S&&(e=e.doc);if(this.linked)for(var t=0;t<this.linked.length;++t){var n=this.linked[t];if(n.doc!=e)continue;this.linked.splice(t,1),e.unlinkDoc(this);break}if(e.history==this.history){var r=[e.id];oi(e,function(e){r.push(e.id)},!0),e.history=mi(),e.history.done=Si(this.history.done,r),e.history.undone=Si(this.history.undone,r)}},iterLinkedDocs:function(e){oi(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm}}),ri.prototype.eachLine=ri.prototype.iter;var ii="iter insert remove copy getEditor".split(" ");for(var si in ri.prototype)ri.prototype.hasOwnProperty(si)&&Yi(ii,si)<0&&(S.prototype[si]=function(e){return function(){return e.apply(this.doc,arguments)}}(ri.prototype[si]));zi(ri),S.e_stop=Mi,S.e_preventDefault=Li,S.e_stopPropagation=Ai;var ji,Fi=0;S.on=Pi,S.off=Hi,S.signal=Bi;var Wi=30,Xi=S.Pass={toString:function(){return"CodeMirror.Pass"}};Vi.prototype={set:function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)}},S.countColumn=$i;var Ji=[""],rs=/[\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,os=/[\u0300-\u036F\u0483-\u0487\u0488-\u0489\u0591-\u05BD\u05BF\u05C1-\u05C2\u05C4-\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7-\u06E8\u06EA-\u06ED\uA66F\uA670-\uA672\uA674-\uA67D\uA69F\udc00-\udfff]/;S.replaceGetRect=function(e){cs=e};var hs=function(){if(r)return!1;var e=us("div");return"draggable"in e||"dragDrop"in e}();e?ps=function(e,t){return e.charCodeAt(t-1)==36&&e.charCodeAt(t)==39}:a&&!/Version\/([6-9]|\d\d)\b/.test(navigator.userAgent)?ps=function(e,t){return/\-[^ \-?]|\?[^ !\'\"\),.\-\/:;\?\]\}]/.test(e.slice(t-1,t+1))}:i&&!/Chrome\/(?:29|[3-9]\d|\d\d\d)\./.test(navigator.userAgent)&&(ps=function(e,t){if(t>1&&e.charCodeAt(t-1)==45){if(/\w/.test(e.charAt(t-2))&&/[^\-?\.]/.test(e.charAt(t)))return!0;if(t>2&&/[\d\.,]/.test(e.charAt(t-2))&&/[\d\.,]/.test(e.charAt(t)))return!1}return/[~!#%&*)=+}\]|\"\.>,:;][({[<]|-[^\-?\.\u2010-\u201f\u2026]|\?[\w~`@#$%\^&*(_=+{[|><]|â€¦[\w~`@#$%\^&*(_=+{[><]/.test(e.slice(t-1,t+1))});var ds,ms,ys="\n\nb".split(/\n/).length!=3?function(e){var t=0,n=[],r=e.length;while(t<=r){var i=e.indexOf("\n",t);i==-1&&(i=e.length);var s=e.slice(t,e.charAt(i-1)=="\r"?i-1:i),o=s.indexOf("\r");o!=-1?(n.push(s.slice(0,o)),t+=o+1):(n.push(s),t=i+1)}return n}:function(e){return e.split(/\r\n?|\n/)};S.splitLines=ys;var bs=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(t){return!1}}:function(e){try{var t=e.ownerDocument.selection.createRange()}catch(n){}return!t||t.parentElement()!=e?!1:t.compareEndPoints("StartToEnd",t)!=0},ws=function(){var e=us("div");return"oncopy"in e?!0:(e.setAttribute("oncopy","return;"),typeof e.oncopy=="function")}(),Es={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",91:"Mod",92:"Mod",93:"Mod",109:"-",107:"=",127:"Delete",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63276:"PageUp",63277:"PageDown",63275:"End",63273:"Home",63234:"Left",63232:"Up",63235:"Right",63233:"Down",63302:"Insert",63272:"Delete"};S.keyNames=Es,function(){for(var e=0;e<10;e++)Es[e+48]=String(e);for(var e=65;e<=90;e++)Es[e]=String.fromCharCode(e);for(var e=1;e<=12;e++)Es[e+111]=Es[e+63235]="F"+e}();var Os,Hs=function(){function n(n){return n<=255?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1791?t.charAt(n-1536):1792<=n&&n<=2220?"r":"L"}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLL",t="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmmrrrrrrrrrrrrrrrrrr",r=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,i=/[stwN]/,s=/[LRr]/,o=/[Lb1n]/,u=/[1n]/,a="L";return function(e){if(!r.test(e))return!1;var t=e.length,f=[];for(var l=0,c;l<t;++l)f.push(c=n(e.charCodeAt(l)));for(var l=0,h=a;l<t;++l){var c=f[l];c=="m"?f[l]=h:h=c}for(var l=0,p=a;l<t;++l){var c=f[l];c=="1"&&p=="r"?f[l]="n":s.test(c)&&(p=c,c=="r"&&(f[l]="R"))}for(var l=1,h=f[0];l<t-1;++l){var c=f[l];c=="+"&&h=="1"&&f[l+1]=="1"?f[l]="1":c==","&&h==f[l+1]&&(h=="1"||h=="n")&&(f[l]=h),h=c}for(var l=0;l<t;++l){var c=f[l];if(c==",")f[l]="N";else if(c=="%"){for(var d=l+1;d<t&&f[d]=="%";++d);var v=l&&f[l-1]=="!"||d<t-1&&f[d]=="1"?"1":"N";for(var m=l;m<d;++m)f[m]=v;l=d-1}}for(var l=0,p=a;l<t;++l){var c=f[l];p=="L"&&c=="1"?f[l]="L":s.test(c)&&(p=c)}for(var l=0;l<t;++l)if(i.test(f[l])){for(var d=l+1;d<t&&i.test(f[d]);++d);var g=(l?f[l-1]:a)=="L",y=(d<t-1?f[d]:a)=="L",v=g||y?"L":"R";for(var m=l;m<d;++m)f[m]=v;l=d-1}var b=[],w;for(var l=0;l<t;)if(o.test(f[l])){var E=l;for(++l;l<t&&o.test(f[l]);++l);b.push({from:E,to:l,level:0})}else{var S=l,x=b.length;for(++l;l<t&&f[l]!="L";++l);for(var m=S;m<l;)if(u.test(f[m])){S<m&&b.splice(x,0,{from:S,to:m,level:1});var T=m;for(++m;m<l&&u.test(f[m]);++m);b.splice(x,0,{from:T,to:m,level:2}),S=m}else++m;S<l&&b.splice(x,0,{from:S,to:l,level:1})}return b[0].level==1&&(w=e.match(/^\s+/))&&(b[0].from=w[0].length,b.unshift({from:0,to:w[0].length,level:0})),Qi(b).level==1&&(w=e.match(/\s+$/))&&(Qi(b).to-=w[0].length,b.push({from:t-w[0].length,to:t,level:0})),b[0].level!=Qi(b).level&&b.push({from:t,to:t,level:b[0].level}),b}}();return S.version="3.15.0",S}();(function(){"use strict";var e=/^(\s*)([*+-]|(\d+)\.)(\s*)/,n="*+-";t.commands.newlineAndIndentContinueMarkdownList=function(t){var r=t.getCursor(),i=t.getStateAfter(r.line).list,s;if(!i||!(s=t.getLine(r.line).match(e))){t.execCommand("newlineAndIndent");return}var o=s[1],u=s[4],a=n.indexOf(s[2])>=0?s[2]:parseInt(s[3],10)+1+".";t.replaceSelection("\n"+o+a+u,"end")}})(),t.defineMode("xml",function(e,t){function f(e,t){function n(n){return t.tokenize=n,n(e,t)}var r=e.next();if(r=="<"){if(e.eat("!"))return e.eat("[")?e.match("CDATA[")?n(h("atom","]]>")):null:e.match("--")?n(h("comment","-->")):e.match("DOCTYPE",!0,!0)?(e.eatWhile(/[\w\._\-]/),n(p(1))):null;if(e.eat("?"))return e.eatWhile(/[\w\._\-]/),t.tokenize=h("meta","?>"),"meta";var i=e.eat("/");u="";var s;while(s=e.eat(/[^\s\u00a0=<>\"\'\/?]/))u+=s;return u?(a=i?"closeTag":"openTag",t.tokenize=l,"tag"):"error"}if(r=="&"){var o;return e.eat("#")?e.eat("x")?o=e.eatWhile(/[a-fA-F\d]/)&&e.eat(";"):o=e.eatWhile(/[\d]/)&&e.eat(";"):o=e.eatWhile(/[\w\.\-:]/)&&e.eat(";"),o?"atom":"error"}return e.eatWhile(/[^&<]/),null}function l(e,t){var n=e.next();return n==">"||n=="/"&&e.eat(">")?(t.tokenize=f,a=n==">"?"endTag":"selfcloseTag","tag"):n=="="?(a="equals",null):n=="<"?"error":/[\'\"]/.test(n)?(t.tokenize=c(n),t.stringStartCol=e.column(),t.tokenize(e,t)):(e.eatWhile(/[^\s\u00a0=<>\"\']/),"word")}function c(e){var t=function(t,n){while(!t.eol())if(t.next()==e){n.tokenize=l;break}return"string"};return t.isInAttribute=!0,t}function h(e,t){return function(n,r){while(!n.eol()){if(n.match(t)){r.tokenize=f;break}n.next()}return e}}function p(e){return function(t,n){var r;while((r=t.next())!=null){if(r=="<")return n.tokenize=p(e+1),n.tokenize(t,n);if(r==">"){if(e==1){n.tokenize=f;break}return n.tokenize=p(e-1),n.tokenize(t,n)}}return"meta"}}function g(){for(var e=arguments.length-1;e>=0;e--)d.cc.push(arguments[e])}function y(){return g.apply(null,arguments),!0}function b(e,t){var n=s.doNotIndent.hasOwnProperty(e)||d.context&&d.context.noIndent;d.context={prev:d.context,tagName:e,indent:d.indented,startOfLine:t,noIndent:n}}function w(){d.context&&(d.context=d.context.prev)}function E(e){if(e=="openTag")return d.tagName=u,d.tagStart=v.column(),y(N,S(d.startOfLine));if(e=="closeTag"){var t=!1;return d.context?d.context.tagName!=u&&(s.implicitlyClosed.hasOwnProperty(d.context.tagName.toLowerCase())&&w(),t=!d.context||d.context.tagName!=u):t=!0,t&&(m="error"),y(x(t))}return y()}function S(e){return function(t){var n=d.tagName;return d.tagName=d.tagStart=null,t=="selfcloseTag"||t=="endTag"&&s.autoSelfClosers.hasOwnProperty(n.toLowerCase())?(T(n.toLowerCase()),y()):t=="endTag"?(T(n.toLowerCase()),b(n,e),y()):y()}}function x(e){return function(t){return e&&(m="error"),t=="endTag"?(w(),y()):(m="error",y(arguments.callee))}}function T(e){var t;for(;;){if(!d.context)return;t=d.context.tagName.toLowerCase();if(!s.contextGrabbers.hasOwnProperty(t)||!s.contextGrabbers[t].hasOwnProperty(e))return;w()}}function N(e){return e=="word"?(m="attribute",y(C,N)):e=="endTag"||e=="selfcloseTag"?g():(m="error",y(N))}function C(e){return e=="equals"?y(k,N):(s.allowMissing?e=="word"&&(m="attribute"):m="error",e=="endTag"||e=="selfcloseTag"?g():y())}function k(e){return e=="string"?y(L):e=="word"&&s.allowUnquoted?(m="string",y()):(m="error",e=="endTag"||e=="selfCloseTag"?g():y())}function L(e){return e=="string"?y(L):g()}var n=e.indentUnit,r=t.multilineTagIndentFactor||1,i=t.multilineTagIndentPastTag||!0,s=t.htmlMode?{autoSelfClosers:{area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,frame:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},implicitlyClosed:{dd:!0,li:!0,optgroup:!0,option:!0,p:!0,rp:!0,rt:!0,tbody:!0,td:!0,tfoot:!0,th:!0,tr:!0},contextGrabbers:{dd:{dd:!0,dt:!0},dt:{dd:!0,dt:!0},li:{li:!0},option:{option:!0,optgroup:!0},optgroup:{optgroup:!0},p:{address:!0,article:!0,aside:!0,blockquote:!0,dir:!0,div:!0,dl:!0,fieldset:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,menu:!0,nav:!0,ol:!0,p:!0,pre:!0,section:!0,table:!0,ul:!0},rp:{rp:!0,rt:!0},rt:{rp:!0,rt:!0},tbody:{tbody:!0,tfoot:!0},td:{td:!0,th:!0},tfoot:{tbody:!0},th:{td:!0,th:!0},thead:{tbody:!0,tfoot:!0},tr:{tr:!0}},doNotIndent:{pre:!0},allowUnquoted:!0,allowMissing:!0}:{autoSelfClosers:{},implicitlyClosed:{},contextGrabbers:{},doNotIndent:{},allowUnquoted:!1,allowMissing:!1},o=t.alignCDATA,u,a,d,v,m;return{startState:function(){return{tokenize:f,cc:[],indented:0,startOfLine:!0,tagName:null,tagStart:null,context:null}},token:function(e,t){!t.tagName&&e.sol()&&(t.startOfLine=!0,t.indented=e.indentation());if(e.eatSpace())return null;m=a=u=null;var n=t.tokenize(e,t);t.type=a;if((n||a)&&n!="comment"){d=t,v=e;for(;;){var r=t.cc.pop()||E;if(r(a||n))break}}return t.startOfLine=!1,m||n},indent:function(e,t,s){var u=e.context;if(e.tokenize.isInAttribute)return e.stringStartCol+1;if(e.tokenize!=l&&e.tokenize!=f||u&&u.noIndent)return s?s.match(/^(\s*)/)[0].length:0;if(e.tagName)return i?e.tagStart+e.tagName.length+2:e.tagStart+n*r;if(o&&/<!\[CDATA\[/.test(t))return 0;u&&/^<\//.test(t)&&(u=u.prev);while(u&&!u.startOfLine)u=u.prev;return u?u.indent+n:0},electricChars:"/",blockCommentStart:"<!--",blockCommentEnd:"-->",configuration:t.htmlMode?"html":"xml",helperType:t.htmlMode?"html":"xml"}}),t.defineMIME("text/xml","xml"),t.defineMIME("application/xml","xml"),t.mimeModes.hasOwnProperty("text/html")||t.defineMIME("text/html",{name:"xml",htmlMode:!0}),t.defineMode("markdown",function(e,n){function A(e,t,n){return t.f=t.inline=n,n(e,t)}function O(e,t,n){return t.f=t.block=n,n(e,t)}function M(e){return e.linkTitle=!1,e.em=!1,e.strong=!1,e.quote=0,!r&&e.f==D&&(e.f=j,e.block=_),e.trailingSpace=0,e.trailingSpaceNewLine=!1,e.thisLineHasContent=!1,null}function _(e,t){var r=t.list!==!1;t.list!==!1&&t.indentationDiff>=0?(t.indentationDiff<4&&(t.indentation-=t.indentationDiff),t.list=null):t.list!==!1&&t.indentation>0?(t.list=null,t.listDepth=Math.floor(t.indentation/4)):t.list!==!1&&(t.list=!1,t.listDepth=0);if(t.indentationDiff>=4)return t.indentation-=4,e.skipToEnd(),f;if(e.eatSpace())return null;if(e.peek()==="#"||t.prevLineHasContent&&e.match(k))t.header=!0;else if(e.eat(">")){t.indentation++,t.quote=1,e.eatSpace();while(e.eat(">"))e.eatSpace(),t.quote++}else{if(e.peek()==="[")return A(e,t,I);if(e.match(x,!0))return v;if((!t.prevLineHasContent||r)&&(e.match(T,!0)||e.match(N,!0)))t.indentation+=4,t.list=!0,t.listDepth++,n.taskLists&&e.match(C,!1)&&(t.taskList=!0);else if(n.fencedCodeBlocks&&e.match(/^```([\w+#]*)/,!0))return t.localMode=o(RegExp.$1),t.localMode&&(t.localState=t.localMode.startState()),O(e,t,P),f}return A(e,t,t.inline)}function D(e,t){var n=i.token(e,t.htmlState);return r&&n==="tag"&&t.htmlState.type!=="openTag"&&!t.htmlState.context&&(t.f=j,t.block=_),t.md_inside&&e.current().indexOf(">")!=-1&&(t.f=j,t.block=_,t.htmlState.context=undefined),n}function P(e,t){return e.sol()&&e.match(/^```/,!0)?(t.localMode=t.localState=null,t.f=j,t.block=_,f):t.localMode?t.localMode.token(e,t.localState):(e.skipToEnd(),f)}function H(e){var t=[];if(e.taskOpen)return"meta";if(e.taskClosed)return"property";e.strong&&t.push(S),e.em&&t.push(E),e.linkText&&t.push(b),e.code&&t.push(f),e.header&&t.push(a),e.quote&&t.push(e.quote%2?l:c);if(e.list!==!1){var n=(e.listDepth-1)%3;n?n===1?t.push(p):t.push(d):t.push(h)}return e.trailingSpaceNewLine?t.push("trailing-space-new-line"):e.trailingSpace&&t.push("trailing-space-"+(e.trailingSpace%2?"a":"b")),t.length?t.join(" "):null}function B(e,t){return e.match(L,!0)?H(t):undefined}function j(e,t){var r=t.text(e,t);if(typeof r!="undefined")return r;if(t.list)return t.list=null,H(t);if(t.taskList){var i=e.match(C,!0)[1]!=="x";return i?t.taskOpen=!0:t.taskClosed=!0,t.taskList=!1,H(t)}t.taskOpen=!1,t.taskClosed=!1;var s=e.next();if(s==="\\")return e.next(),H(t);if(t.linkTitle){t.linkTitle=!1;var o=s;s==="("&&(o=")"),o=(o+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1");var a="^\\s*(?:[^"+o+"\\\\]+|\\\\\\\\|\\\\.)"+o;if(e.match(new RegExp(a),!0))return w}if(s==="`"){var f=H(t),l=e.pos;e.eatWhile("`");var c=1+e.pos-l;return t.code?c===u?(t.code=!1,f):H(t):(u=c,t.code=!0,H(t))}if(t.code)return H(t);if(s==="!"&&e.match(/\[[^\]]*\] ?(?:\(|\[)/,!1))return e.match(/\[[^\]]*\]/),t.inline=t.f=F,m;if(s==="["&&e.match(/.*\](\(| ?\[)/,!1))return t.linkText=!0,H(t);if(s==="]"&&t.linkText){var h=H(t);return t.linkText=!1,t.inline=t.f=F,h}if(s==="<"&&e.match(/^(https?|ftps?):\/\/(?:[^\\>]|\\.)+>/,!1))return A(e,t,z(g,">"));if(s==="<"&&e.match(/^[^> \\]+@(?:[^\\>]|\\.)+>/,!1))return A(e,t,z(y,">"));if(s==="<"&&e.match(/^\w/,!1)){if(e.string.indexOf(">")!=-1){var p=e.string.substring(1,e.string.indexOf(">"));/markdown\s*=\s*('|"){0,1}1('|"){0,1}/.test(p)&&(t.md_inside=!0)}return e.backUp(1),O(e,t,D)}if(s==="<"&&e.match(/^\/\w*?>/))return t.md_inside=!1,"tag";var d=!1;if(!n.underscoresBreakWords&&s==="_"&&e.peek()!=="_"&&e.match(/(\w)/,!1)){var v=e.pos-2;if(v>=0){var b=e.string.charAt(v);b!=="_"&&b.match(/(\w)/,!1)&&(d=!0)}}var f=H(t);if(s==="*"||s==="_"&&!d){if(t.strong===s&&e.eat(s))return t.strong=!1,f;if(!t.strong&&e.eat(s))return t.strong=s,H(t);if(t.em===s)return t.em=!1,f;if(!t.em)return t.em=s,H(t)}else if(s===" ")if(e.eat("*")||e.eat("_")){if(e.peek()===" ")return H(t);e.backUp(1)}return s===" "&&(e.match(/ +$/,!1)?t.trailingSpace++:t.trailingSpace&&(t.trailingSpaceNewLine=!0)),H(t)}function F(e,t){if(e.eatSpace())return null;var n=e.next();return n==="("||n==="["?A(e,t,z(w,n==="("?")":"]")):"error"}function I(e,t){return e.match(/^[^\]]*\]:/,!0)?(t.f=q,b):A(e,t,j)}function q(e,t){return e.eatSpace()?null:(e.match(/^[^\s]+/,!0),e.peek()===undefined?t.linkTitle=!0:e.match(/^(?:\s+(?:"(?:[^"\\]|\\\\|\\.)+"|'(?:[^'\\]|\\\\|\\.)+'|\((?:[^)\\]|\\\\|\\.)+\)))?/,!0),t.f=t.inline=j,w)}function U(e){return R[e]||(e=(e+"").replace(/([.?*+^$[\]\\(){}|-])/g,"\\$1"),R[e]=new RegExp("^(?:[^\\\\]|\\\\.)*?("+e+")")),R[e]}function z(e,t,n){return n=n||j,function(r,i){return r.match(U(t)),i.inline=i.f=n,e}}var r=t.modes.hasOwnProperty("xml"),i=t.getMode(e,r?{name:"xml",htmlMode:!0}:"text/plain"),s={html:"htmlmixed",js:"javascript",json:"application/json",c:"text/x-csrc","c++":"text/x-c++src",java:"text/x-java",csharp:"text/x-csharp","c#":"text/x-csharp",scala:"text/x-scala"},o=function(){var n,r={},i={},o,u=[];for(var a in t.modes)t.modes.propertyIsEnumerable(a)&&u.push(a);for(n=0;n<u.length;n++)r[u[n]]=u[n];var f=[];for(var a in t.mimeModes)t.mimeModes.propertyIsEnumerable(a)&&f.push({mime:a,mode:t.mimeModes[a]});for(n=0;n<f.length;n++)o=f[n].mime,i[o]=f[n].mime;for(var l in s)if(s[l]in r||s[l]in i)r[l]=s[l];return function(n){return r[n]?t.getMode(e,r[n]):null}}();n.underscoresBreakWords===undefined&&(n.underscoresBreakWords=!0),n.fencedCodeBlocks===undefined&&(n.fencedCodeBlocks=!1),n.taskLists===undefined&&(n.taskLists=!1);var u=0,a="header",f="comment",l="atom",c="number",h="variable-2",p="variable-3",d="keyword",v="hr",m="tag",g="link",y="link",b="link",w="string",E="em",S="strong",x=/^([*\-=_])(?:\s*\1){2,}\s*$/,T=/^[*\-+]\s+/,N=/^[0-9]+\.\s+/,C=/^\[(x| )\](?=\s)/,k=/^(?:\={1,}|-{1,})$/,L=/^[^!\[\]*_\\<>` "'(]+/,R=[];return{startState:function(){return{f:_,prevLineHasContent:!1,thisLineHasContent:!1,block:_,htmlState:t.startState(i),indentation:0,inline:j,text:B,linkText:!1,linkTitle:!1,em:!1,strong:!1,header:!1,taskList:!1,list:!1,listDepth:0,quote:0,trailingSpace:0,trailingSpaceNewLine:!1}},copyState:function(e){return{f:e.f,prevLineHasContent:e.prevLineHasContent,thisLineHasContent:e.thisLineHasContent,block:e.block,htmlState:t.copyState(i,e.htmlState),indentation:e.indentation,localMode:e.localMode,localState:e.localMode?t.copyState(e.localMode,e.localState):null,inline:e.inline,text:e.text,linkTitle:e.linkTitle,em:e.em,strong:e.strong,header:e.header,taskList:e.taskList,list:e.list,listDepth:e.listDepth,quote:e.quote,trailingSpace:e.trailingSpace,trailingSpaceNewLine:e.trailingSpaceNewLine,md_inside:e.md_inside}},token:function(e,t){if(e.sol()){if(e.match(/^\s*$/,!0))return t.prevLineHasContent=!1,M(t);t.prevLineHasContent=t.thisLineHasContent,t.thisLineHasContent=!0,t.header=!1,t.taskList=!1,t.code=!1,t.trailingSpace=0,t.trailingSpaceNewLine=!1,t.f=t.block;var n=e.match(/^\s*/,!0)[0].replace(/\t/g,"    ").length,r=Math.floor((n-t.indentation)/4)*4;r>4&&(r=4);var i=t.indentation+r;t.indentationDiff=i-t.indentation,t.indentation=i;if(n>0)return null}return t.f(e,t)},blankLine:M,getType:H}},"xml"),t.defineMIME("text/x-markdown","markdown");var n=/Mac/.test(navigator.platform),r={"Cmd-B":f,"Cmd-I":l,"Cmd-K":d,"Cmd-Alt-I":v,"Cmd-'":c,"Cmd-Alt-L":p,"Cmd-L":h},S=[{name:"bold",action:f},{name:"italic",action:l},"|",{name:"quote",action:c},{name:"unordered-list",action:h},{name:"ordered-list",action:p},"|",{name:"link",action:d},{name:"image",action:v},"|",{name:"info",action:"http://lab.lepture.com/editor/markdown"},{name:"preview",action:y},{name:"fullscreen",action:a}];x.toolbar=S,x.markdown=function(e){if(window.marked)return marked(e)},x.prototype.render=function(e){this.element=e||this.element||document.getElementsByTagName("textarea")[0];if(this._rendered&&this._rendered===this.element)return;this.createCodeMirror(this.element),this.options.toolbar!==!1&&this.createToolbar(),this.options.status!==!1&&this.createStatusbar(),this._rendered=this.element},x.prototype.createCodeMirror=function(e){var n=this,s={},o;for(var u in r)(function(e){s[i(e)]=function(t){r[e](n)}})(u);s.Enter="newlineAndIndentContinueMarkdownList",o={mode:"markdown",theme:"paper",indentWithTabs:!0,lineNumbers:!1,extraKeys:s},codeMirrorOptions=this.options.codeMirror||{};for(var u in o)codeMirrorOptions[u]=codeMirrorOptions[u]||o[u];this.codemirror=t.fromTextArea(e,codeMirrorOptions)},x.prototype.createToolbar=function(e){e=e||this.options.toolbar;if(!e||e.length===0)return;var t=document.createElement("div");t.className="editor-toolbar";var n=this,r;n.toolbar={};for(var i=0;i<e.length;i++)(function(e){var r;e.name?r=s(e.name,e):e==="|"?r=o():r=s(e),e.action&&(typeof e.action=="function"?r.onclick=function(t){e.action(n)}:typeof e.action=="string"&&(r.href=e.action,r.target="_blank")),n.toolbar[e.name||e]=r,t.appendChild(r)})(e[i]);var a=this.codemirror;a.on("cursorActivity",function(){var e=u(a);for(var t in n.toolbar)(function(t){var r=n.toolbar[t];e[t]?r.className+=" active":r.className=r.className.replace(/\s*active\s*/g,"")})(t)});var f=a.getWrapperElement();return f.parentNode.insertBefore(t,f),t},x.prototype.createStatusbar=function(e){e=e||this.options.status;if(!e||e.length===0)return;var t=document.createElement("div");t.className="editor-statusbar";var n,r=this.codemirror;for(var i=0;i<e.length;i++)(function(e){var i=document.createElement("span");i.className=e,e==="words"?(i.innerHTML="0",r.on("update",function(){i.innerHTML=E(r.getValue())})):e==="lines"?(i.innerHTML="0",r.on("update",function(){i.innerHTML=r.lineCount()})):e==="cursor"&&(i.innerHTML="0:0",r.on("cursorActivity",function(){n=r.getCursor(),i.innerHTML=n.line+":"+n.ch})),t.appendChild(i)})(e[i]);var s=this.codemirror.getWrapperElement();return s.parentNode.insertBefore(t,s.nextSibling),t},x.toggleBold=f,x.toggleItalic=l,x.toggleBlockquote=c,x.toggleUnOrderedList=h,x.toggleOrderedList=p,x.drawLink=d,x.drawImage=v,x.undo=m,x.redo=g,x.toggleFullScreen=a,x.prototype.toggleBold=function(){f(this)},x.prototype.toggleItalic=function(){l(this)},x.prototype.toggleBlockquote=function(){c(this)},x.prototype.toggleUnOrderedList=function(){h(this)},x.prototype.toggleOrderedList=function(){p(this)},x.prototype.drawLink=function(){d(this)},x.prototype.drawImage=function(){v(this)},x.prototype.undo=function(){m(this)},x.prototype.redo=function(){g(this)},x.prototype.toggleFullScreen=function(){a(this)},e.Editor=x}(this),function(){var e=function(e,t){return function(){return e.apply(t,arguments)}};this.CommunityEditor=function(){function t(t,n){n==null&&(n={}),this._render=e(this._render,this),this.textarea=$(t),this.options=n,this.editor=null,this._render()}return t.prototype.content=function(){return jQuery.trim(this.editor.codemirror.doc.getValue()).replace(/^x[\s]*/,"").replace("<pre>","```").replace("</pre>","```")},t.prototype._toggleHeading=function(e,t){var n,r,i,s,o,u,a,f;t==null&&(t=1),n=e.codemirror,s=n.getCursor("start"),r=n.getCursor("end");for(i=u=a=s.line,f=r.line;a<=f?u<=f:u>=f;i=a<=f?++u:--u)o=n.getLine(i),o.match(RegExp("^\\#{"+t+"}[^#]"))?o=o.replace(/^#+\s*/,""):(o=o.replace(/^#+\s*/,""),o=Array(t+1).join("#")+" "+o),n.setLine(i,o);return n.focus()},t.prototype._render=function(){var e,t=this;if(this.textarea[0]==null)return;return e=[{name:"bold",action:Editor.toggleBold},{name:"italic",action:Editor.toggleItalic},"|",{name:"quote",action:Editor.toggleBlockquote},{name:"unordered-list",action:Editor.toggleUnOrderedList},{name:"ordered-list",action:Editor.toggleOrderedList},"|",{name:"link",action:Editor.drawLink},{name:"image",action:Editor.drawImage},"|",{name:"markdown-mark",action:"/community/markdown"}],this.options.headings&&(e=[{name:"heading-2",action:function(){return t._toggleHeading(editor,2)}},{name:"heading-3",action:function(){return t._toggleHeading(editor,3)}},{name:"heading-4",action:function(){return t._toggleHeading(editor,4)}},"|"].concat(e)),this.editor=new Editor({element:this.textarea[0],toolbar:e,status:!1,codeMirror:{lineWrapping:!0}})},t}()}.call(this);